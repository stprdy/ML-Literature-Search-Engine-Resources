model diversity analysis antigen receptor repertoire grzegorz micha l leszek february 24 2010 abstract modern molecular biology one common way studying vertebrate immune system statistically compare count sequenced antigen receptor clone either immunoglobulin receptor derived various tissue diﬀerent experimental clinical condition problem diﬃcult doe not ﬁt readily standard statistical framework contingency table primarily due serious receptor population caused one hand extreme diversity antigen receptor repertoire maintained immune system high cost labor intensity receptor data collection process recent immunological literature diﬀerences across antigen receptor population examined via statistical measure specie overlap diversity borrowed ecological study approach robust wide range situation seems provide little insight underlying clonal size distribution overall mechanism diﬀerentiating receptor population possible alternative current paper present parametric method adjusts data well provides unifying approach simultaneous comparison multiple receptor group mean modern statistical tool unsupervised learning parametric model based ﬂexible multivariate distribution seen natural generalization univariate model used ecological study biodiversity pattern procedure evaluating model ﬁt described along public domain software developed perform necessary diagnostics analysis seen compare favorably vi vi traditional method applied data receptor transgenic mouse population keywords antigen receptor computational immunology specie diversity estimation poisson abundance model lognormal distribution dissimilarity measure dendrogram mutual information 2010 subject classiﬁcation author department biostatistics cancer center medical college georgia augusta ga grempala wydzia l matematyki universytet odzki odz poland msewery department medicine center biotechnology genomic medicine medical college georgia towicz 1 4 mar 2010 1 introduction major feature adaptive immune system capacity generate clone b able recognize neutralize speciﬁc antigen cell type recognize antigen special class surface molecule called receptor methodology developed paper apply type receptor sake clarity simplicity describe background overall problem term receptor general introduction molecular biology immune system refer interested reader janeway 2005 single receptor tcr composed two chain α β formed cell diﬀerentiation chain formed rearrangement genetic segment vα jα tcrα chain vβ dβ jβ tcrβ chain since number segment type genomic dna great number diﬀerent α β chain generated chain diversity increased recombination process individual nucleotide might added deleted junctional site region containing highly variable junction third three region cdrs seen crystallographically contact antigen source tcr diversity thus naturally broken hierarchically gene segment family library segment within family length nucleotide diversity combinatorial insertional result huge tcr repertoire ensuring immune system ha potential recognize large number antigen instance estimated mouse number diﬀerent tcrs formed exceeds 1015 davis bjorkman 1988 casrouge et 2000 human estimated 1018 diﬀerent tcrs produced number diﬀerent tcr specie tcr richness human any given time ha estimated exceed 107 arstila et 1999 naylor et 2005 clonal diversity tcr population make particularly challenging object analyze statistically follows concerned statistical analysis diversity tcr repertoire sample obtained various subset count diﬀerent tcr clone subset generally deﬁned based expression cell surface marker leading diﬀerent function immune response example naive deﬁned cell not encounter antigen lifetime memory cell previously responded antigenic stimulation underwent clonal expansion frequency individual clone normal individual low however naive expressing appropriate tcr encounter antigen becomes activated expands forming multiple clone cell thus analysis tcr repertoire clonal size distribution ha become crucial element many study aimed better understanding evolution immune response vaccinated individual patient suﬀering autoimmune disease cancer butz bevan 1998 clonal size estimate ha recently applied quantify diﬀerences tcr repertoire normal infected individual help determine clone persisted memory et al 1999 sebzda et al 1999 busch pamer 1999 savage et al 1999 comparison diversity tcr repertoire ha also used determine origin study heterogeneity memory sallusto et al 1999 2004 purpose current paper term clonal diversity understand tcrs clonal size distribution abundance pattern well richness number diﬀerent tcrs several statistical approach ass diversity based tcr clone count instance approach simpson diversity shannon entropy index applied measure diversity collected sample ferreira et 2009 venturi et 2008 however index typically summary statistic due frequent data provide only limited information true diversity population another approach seen 2 immunological study relies modeling diversity parametrically assuming clonotypes equally represented repertoire barth et al 1985 behlke et al 1985 advantage homogenous model computational conceptual simplicity contributes wide use analyzing tcr data casrouge et al 2000 hsieh et al 2004 2006 pacholczyk et al 2007 2006 however simple model called question empirical evidence see naumov et al 2003 pewe et al 2004 suggesting heavy right tail clonal size distribution account heterogeneity homogenous model ha expanded variety mixture model typically assumption tcr clone poisson abundance mixture model chao 2006 assume tcr variant clone family sampled according poisson distribution speciﬁc sampling rate varying according prescribed parametric mixing distribution exponential gamma lognormal ord whitmore 1986 ulveda et al 2009 bulmer 1974 recent detailed comparative study ulveda et al 2009 identiﬁed one model mixture pln particularly well suited modeling clonal diversity special appeal pln may naturally extended multivariate setting allowing therefore simultaneous analysis abundance pattern several repertoire engen et 2002 particular bivariate extension pln model may used derive class pairwise dissimilarity measure repertoire construct hierarchy relating various tcr repertoire purpose article describe new general approach analyzing comparing type data arriving multiple repertoire approach develop relies tcr toires dissimilarity analysis appropriate measure derived simple easily testable interpretable model clonal abundance based parametric bivariate lognormal distribution bpln mean example derived real tcr data argue bpln parametric measure dissimilarity yield consistent biologically meaningful result paper organized follows next section section 2 give brief overview poisson abundance model univariate multivariate bivariate setting section 3 discus one popular method deriving dissimilarity measure particularly relevant tcr data study provide formal deﬁnitions four diﬀerent measure considered paper section 4 present application method tcr data obtained population naive regulatory receptor healthy mouse data set wa described detail analyzed diﬀerent method pacholczyk et al 2006 using clustering algorithm derived bpln model compare result section 5 provide concise summary ﬁndings oﬀer some concluding remark some elementary derivation related entropy function provided reader convenience appendix 2 poisson model abundance poisson abundance model arrive naturally biodiversity study assume see chao 2006 specie sampling done continuous type eﬀort data recorded arriving mixture poisson process time interval 0 follows take 1 type model approach traced back fisher corbet williams fisher et 1943 consider specie labeled 1 individual specie arrive sample according poisson process discovery rate λi detectability individual assumed equal across specie typically case tcr repertoire analysis rate interpreted 3 specie abundance nayak 1991 sampling scheme sample size n number individual observed experiment random variable since conditional frequency follow multinomial distribution class total n class probability given relative frequency pm λk many estimator shared poisson model multinomial model n assumed constant note case antigen receptor data constant n sometimes known dna sequencing data sometimes not known spectratype data see kepler et al 2005 latter case prior distributional form n typically assumed posterior model investigated based bayesian tool see rodrigues et al 2001 lewins joanes 1984 barger bunge 2008 solow 1994 since present paper motivated dna sequencing data assuming throughout n known extension model unknown n along line rodrigues et al 2001 reasonably straightforward not pursued univariate mixture model since ha generally accepted antigen receptor clonal size distribution heavy right tail adjust specie rate λm typically modeled random sample mixing distribution density f λ θ θ vector parameter following famous paper fisher colleague fisher et 1943 many researcher adopted gamma density mixing model parametric model include among others bulmer 1974 ord whitmore 1986 generalized sichel 1997 distribution well many others ulveda et 2009 obvious advantage parametric model inference problem reduces estimating only relatively parameter traditional estimation procedure typically applied any mixture density f λ θ deﬁne pθ k k 0 1 probability any tcr specie observed k time sample pθ k z 0 f λ θ dλ k 0 1 denoting fk k 1 2 n number receptor specie observed exactly sample e fk mpθ k setting p k fk likelihood function θ written l fk q fk pθ 0 pθ k fk unconditional mles θ asymptotic variance obtained based likelihood see depends data only observed value fk likelihood factored l fk lb lc fk lb likelihood respect binomial 0 variable lc fk conditional multinomial likelihood respect fk k cell total cell probability pθ k 1 0 k lc fk q fk pθ k 1 0 4 mle obtained likelihood regarded conditional empirical bayes estimator think mixing distribution prior distribution unknown parameter must estimated see rodrigues et al 2001 reference extension bivariate model shall see next section interest also consider multivariate model abundance purpose discussion focus bivariate model modiﬁcations higher dimension rather straightforward simplicity assume specie population direct analogy notation previous section deﬁne pθ k l probability any tcr specie tcr clone present k time sample ﬁrst population repertoire l time sample second one let fk l empirical count set p k fk l assuming 0 let f θ bivariate mixture distribution likelihood formula previous section extends bivariate case l fk l q k fk l pθ 0 0 k pθ k l fk l pθ k l z 0 λk k l f θ k l 0 1 note e fk l mpθ k l likelihood function θ factored l fk l lb lc fk l obvious analogy lb likelihood respect binomial variable parameter 1 0 0 lc fk l conditional multinomial likelihood respect fk l k l 0 cell total bivariate cell probability pθ k l 1 0 0 k l k l 0 lc fk l q k fk l pθ k l 1 0 0 l 3 diversity analysis clustering studying evolution tcr specie interest compare diversity mean herein cf section 1 clonal size distribution pθ k specie number repertoire diversity comparison great interest instance clinical study quantity interest divergence multiple observed tcr repertoire some control asymptotic one individual repertoire antigen receptor characterized term divergence control chen et 2003 komatsu et 2009 pacholczyk et 2007 2006 deﬁnition tcr repertoire diversity completely determined parameter θ agrees original concept specie diversity known ﬁeld ecology term relates number specie richness apportionment within sequence evenness equitability see sheldon 1969 sensible method comparing diversity multiple repertoire simultaneously based concept pairwise diversity dissimilarity measure hierarchical 5 clustering induced hierarchical clustering discus detail one many modern method analyzing pattern data ground unsupervised statistical learning theory hastie et al 2001 dynamically developing area modern statistic diversity dissimilarity measure assume overall similarity pair tcr repertoire respective clonal abundance distribution p q quantiﬁed some function q p q referred similarity index similarity measure since typically sample joined distribution frequency abundance not available data collected tcr repertoire some crude similarity index based simply joined tcr specie data number tcr specie shared two sample number specie unique see discussion legendre legendre 1998 example index classical jaccard index closely related sørensen index two oldest widely used similarity index ecological biodiversity study magurran 2005 one advantage poisson mixture model described previous section allows deﬁning meaningful index incorporating pairwise comparison tcr specie based joined distribution abundance representative example index consider horn index dmh magurran 2005 mutual information criterion dmi special case divergence see koski 2001 overlap index dov introduced smith et al 1996 index give rise corresponding measure dissimilarity concentrated unit interval perfect correlation complete overlap frequency distribution yielding value zero indeed seen special case following general construction any bivariate probability distribution pθ corresponding marginal distribution p 1 θ p 2 θ consider similarity index q p 1 θ p 2 θ satisfying 0 p 1 θ p 2 θ p 1 θ p 1 θ q p 2 θ p 2 θ 2 right bound attained p 1 θ p 2 θ corresponding normalized measure dissimilarity pair p 1 θ p 2 θ may deﬁned p 1 θ p 2 θ 1 2 q p 1 θ p 2 θ q p 1 θ p 1 θ q p 2 θ p 2 θ obtain dissimilarity index dmh take q qmh qmh p 1 θ p 2 θ x k k l pθ k l obviously satisﬁes any random variable closely related dissimilarity index dρ obtained take q qρ qρ p 1 θ p 2 θ x k l pθ k l k l mi si respectively mean standard deviation p θ 1 case inequality simply asserts 0 6 popular dissimilarity measure shall denote dov obtained averaging ditional probability individual receptor specie presence sample given presence one measure wa introduced smith et al 1996 quantify overlap repertoire obtained taking following similarity index qov p 1 θ p 2 θ p k l 0 pθ k l 2 1 p k 0 p 1 θ k 1 p l 0 p 2 θ l trivially satisﬁes finally order obtain mutual information dissimilarity index dmi take q qmi qmi p 1 θ p 2 θ x k pθ k l log pθ k l p 1 θ k p 2 θ l fact function satisﬁes shown appendix note similarity index qmh qρ qov qmi thus also corresponding dissimilarity measure depend underlying mixing distribution parameter θ not explicitly specie number desirable since quantity typically unknown diﬃcult estimate due often severe undersampling tcr repertoire ulveda et al 2009 parametric setting considered needed value may estimated either estimate ˆ 1 0 0 ˆ x k 0 fk k l whose close numerical agreement usually indicates robust ﬁt bivariate parametric mixture model note ˆ simply parametric version estimator horvitz thompson 1952 hierarchical clustering given pairwise dissimilarity measure tcr repertoire standard unsupervised tical learning approach simultaneously compare n repertoire term mean building hierarchical cluster graphically represented dendrogarms tree diagram erarchical clustering procedure tcr data not partitioned particular cluster single step instead name suggests hierarchical structure produced cluster level hierarchy created merging cluster next lower level main advantage hierarchical clustering approach lie fact no cluster number need speciﬁed advance hierarchical clustering performed via either agglomerative method proceed series fusion n object group divisive method separate object successively ﬁner ings agglomerative technique commonly used method consider tcr repertoire general introduction clustering unsupervised learning interested reader referred chapter 14 popular monograph hastie et al 2001 model whereas many possible model parametric bivariate mixture recent study engen et al 2002 ulveda et al 2009 seem indicate lognormal mixing distribution may 7 often appropriate choice tcr repertoire modeling spirit consider herein bivariate model based variate assumption random sampling number individual sampled given receptor specie abundance λ poisson distributed mean assume ln λ normally distributed mean µ variance among specie vector individual sampled specie constitutes sample poisson lognormal distribution parameter θ µ µ mean variance log abundance corresponding mass function general form may written p k µ z gk µ σ u φ u du φ standard normal density function gk µ σ u exp uσk µk k k poisson distribution similarly consider pair count individual receptor two diﬀerent repertoire may think random sample size bivariate distribution bpln probability mass function given assume log abundance among specie binormal distribution parameter ρ general detailed description multivariate poisson distribution see son ho 1989 let φ u v ρ denote normal bivariate density correlation coeﬃcient ρ zero mean unite variance distribution bpln given term bivariate probability mass function pθ k l p k l 1 2 ρ k l p k l 1 2 ρ z z gk u gl v φ u v ρ du dv formula follows particular marginals bpln univariate lognormal distribution respective parameter µi 1 2 since usually unknown ﬁtting model only consider number individual observed receptor specie thus distribution number observed individual receptor follows bpln distribution probability mass function p k l 1 2 ρ 1 0 0 1 2 ρ estimator mles parameter distribution discussed bulmer 1974 recently karlis 2003 engen et al 2002 latter approach conveniently implemented freely available r package poilog r development core team 2009 used current paper perform necessary parameter ﬁtting setting model parameter calculated multinomial conditional likelihood function truncated probability quantity pθ k l 1 0 0 given assumed bpln model measure dissimilarity may computed either directly approximation denoting mean bpln marginals αi exp µi 1 2 dissimilarity measure dmh dρ given 8 dmh 1 exp 1 exp 1 1 exp 2 dρ 1 exp p 1 exp 1 p 1 exp 2 quantity αi 1 αi exp 1 2 seen marginal variance bpln distribution formula provide convenient way estimating dissimilarity dmh dρ data simply replacing unknown distribution parameter sample estimate calculated via maximum likelihood instance using numerical algorithm implemented poilog unfortunately due fact mass function not available closed form no similar formula index dmi dov index typically approximated bootstrap procedure also used derive conﬁdence interval standard error parameter estimate model general justiﬁcation derivation provided gill et al 2009 rempala szatzschneider 2004 reader referred efron tibshirani 1997 general introduction theory practice statistical bootstrap computational technique rely upon heavily modeling approach data analysis described 4 application tcr repertoire data section illustrate parametric inference receptor data based bpln model associated pairwise dissimilarity measure analyzing diversity repertoire receptor derived two type mouse wild type genetically restricted tcr repertoire unaltered repertoire self antigen bound class ii mhc ep mouse addition restricted tcr repertoire also express only single covalently linked mhc ep peptide pacholczyk et 2006 data description processing description transgenic tcrmini mouse modiﬁcations wa already detailed recent work pacholczyk et al 2007 herein mention only brieﬂy tcrmini mouse new generation tcr transgenic mouse express one tcrβ chain speciﬁcally chain unique tcrα allows only restricted rearrangement single segment one two jα segment mouse no locus encode tcrα chain therefore entire diversity tcrs derived artiﬁcially introduced tcrα mini locus resulting greatly altered tcrs abundance purpose testing statistical model two subpopulation expressing surface marker collected representing respectively regulatory tr naive tn tr cell deﬁned expressing additional marker addition two subpopulation isolated either 1 peripheral lymph node 2 thymus giving u total eight tcr population diﬀering animal type 9 ep wt ˆ µ lo ˆ lo table 1 maximum likelihood estimate mean variance ep wt mouse repertoire along bias corrected 95 conﬁdence bound generated via parametric bootstrap type tissue location thymus gross undergo development lymph node retained unless activated speciﬁc antigen therefore two markedly diﬀerent pattern clonal abundance organ generally expected additionally ep mouse express only single class ii complex diversity region tcrα chain drastically reduced comparison wild mouse reason dataset uniquely suitable testing bpln model tcr data type mouse wa collected follows detail similar data harvesting procedure see also warren et al 2009 freeman et al 2009 using speciﬁc ﬂuorescent reagent population diﬀerent organ separated individual well plate ampliﬁed unique region tcrα chain using pcr see kuczma et al 2009 following ampliﬁcation region sequenced analyzed providing distribution region native subpopulation type procedure ha widely considered one reliable method harvest repertoire luczynski et 2007 single separated cell suspension isolated tissue section β α chain ampliﬁed sequenced provide unambiguous identiﬁcation clone method avoids problem skewed pcr ampliﬁcation varying tcr mrna expression diﬀerent cell obvious drawback issue alluded already section 1 large number cell need analyzed ensure detection rare clone provide global representation repertoire note availability next generation sequencing technology wong et 2007 large number single cell could replaced high throughput pcr heterogeneous population however current stage technology not yet recommended repertoire analysis due diﬃculties matching speciﬁc tcrα tcrβ chain ampliﬁed simultaneously addition also high risk count bias due skewed ampliﬁcation process high throughput data tends dominant dna sequence even remove rare one analysis bpln model order ass usefulness proposed parametric method tcr data modeling ﬁrst generated bpln estimate dissimilarity matrix eight tcr repertoire using separately four dissimilarity measure general form described section 3 10 dissimilarity dmh dρ used explicit formula whereas remaining two measure dov dmi directly approximated quantity p k l 1 2 ρ given subsequently used parametric bootstrap procedure produce empirical approximation dissimilarity case bpln distribution parameter estimated maximum likelihood estimator mles computed maximizing conditional multinomial likelihood function based probability principle one could use conditional likelihood multivariate distribution directly estimate parameter simultaneously however due complicated form resulting mixture probability deemed approach unreliable numerically hand iterative bivariate model ﬁtting ﬁtting one bpln model time conditionally remaining repertoire iterating convergence wa seen reasonable fast numerically stable procedure yielding set estimate consistent marginally parameter regardless order conditioning wa performed result conditional mle procedure partially summarized table 1 estimate µ parameter abundance distribution eight repertoire reported along corresponding conﬁdence interval obtained via parametric bootstrap corrected percentile method see rempala szatzschneider 2004 detail interval estimation note parameter µ related marginal estimate mean variance variate formula respectively order conserve space estimate bpln correlation coeﬃcients not shown similar relative value dissimilarity summarized figure note marginal value parameter type repertoire ep found similar magnitude estimated value µ parameter parameter 2 overall numerical value parameter indicated smaller mean mouse compared additionally naive repertoire generally seemed smaller mean larger variance mixing distribution regulatory repertoire goodness ﬁt statistic calculated bivariate marginal ﬁt via bootstrap bution conditional likelihood statistic case diﬀerences bivariate data ﬁtted model measured bootstrap test indicating reasonable good ﬁt parametric distribution abundance data addition testing also performed qualitative comparison bpln model versus data via smoothed plot anderes et 2009 one example comparison provided figure 1 smoothed illustrates true bivariate abundance distribution receptor repertoire naive tcrs lymph node regulatory tcrs thymus wt wt one major advantage parametric bpln model many practical situation interest produce across number commonly used dissimilarity index form hierarchical clustering model consistent term ﬁnal cluster composition unlike analysis many tcr datasets choice dissimilarity measure largely irrelevant modeling repertoire bpln model not surprising since interpretation dissimilarity measure account diﬀerences diversity θ pair repertoire condition often satisﬁed see table 1 one may show bpln model dissimilarity monotone function parameter ρ hence measure correlation repertoire indeed case index discussed section 3 11 result hierarchical clustering analysis eight mouse tcr repertoire dmh dmi presented figure ﬁgure left panel top bottom show dendrograms obtained agglomerative hierarchical clustering complete link function using dmh top dmi tom dissimilarity measure dendrograms indicate good relative agreement cluster hierarchical structure correct ﬁnal classiﬁcation eight repertoire term experimental condition restricted v well repertoire type naive regulatory tissue type thymus v lymph node almost identical dendrograms not shown also produced applying remaining two measure discussed namely dρ dov central panel figure 2 illustrate bootstrap approximation distribution frobenius distance see golub van loan 1996 matrix distance dissimilarity matrix dmh j top dmi j bottom 1 j 95 conﬁdence bound marked vertical line right panel show dendrograms corresponding dissimilarity matrix upper bound corresponding 95 conﬁdence interval right vertical line central panel fact left right dendrograms top bottom panel identical relative hierarchy indicates strong robustness hierarchical clustering ﬂuctuations dmh dmi similar robustness wa also true dρ dov agreement dissimilarity matrix entry generated bpln model using four diﬀerent dissimilarity measure dmh dρ dmi dov illustrated figure 3 pairwise loess regression cleveland devlin 1988 entry dissimilarity measure presented indicating monotone relationship almost linear one ﬁrst three measure already indicated agreement expected data closely follows bpln model ﬁnal analysis bpln model also computed specie richness estimate pair repertoire total 28 comparison averaged result obtain pooled estimator ratio wa found 95 conﬁdence interval value suggest much severe tcr population traditional estimator good 1953 given computed pooled repertoire data analysis model order examine result parametric hierarchical clustering analysis tcr repertoire also performed traditional hierarchical clustering analysis repertoire estimated value two dissimilarity measure dmh dmi estimate based directly sample data note dmh particularly convenient analyze only requires relative estimate mixed marginal moment order two may calculated directly observed joined abundance reason parametric measure dmh may directly compared hand measure dmi may estimated mean recently popularized estimator chao shen 2003 manner similar ace estimate see chao 2006 attempt adjust explicitly fact only observing truncated joined distribution result direct comparison pairwise estimated dmh value bpln model presented scatter plot ﬁtted loess figure plot follows linear trend indicative close agreement parametric dmh value tcr data apparent almost linear relationship dissimilarity estimated two measure also conﬁrmed dendrogram computed 12 dmh top panel figure 5 give stable set hierarchical cluster almost identical obtained bpln model top panel figure 2 contrast parametric case found analogue mutual formation mi dissimilarity based coverage adjusted entropy estimator vu et 2007 not agree mh dissimilarity consequently yielded diﬀerent biologically uninterpretable tcr clustering lacked separation ep mouse diﬀerences mh mi measure may clearly seen two top panel figure 5 also lack stability clearly manifested large diﬀerence dendrograms within 95 conﬁdence bound induced frobenius norm matrix note not case mh dissimilarity appears quite stable lowest third panel figure 5 illustrates diﬀerent dissimilarity analysis performed based coverage adjusted estimated value shannon entropy function eight repertoire see vu et al 2007 formula appendix pairwise dissimilarity computed absolute diﬀerences estimated entropy value linear comparison diversity measure across repertoire often appropriate repertoire assumed similar abundance pattern see ulveda et al 2009 however may see plot datasets clustering turned only partially satisfactory entropy measure wa only able clearly separate two repertoire derived regulatory cell not remaining one overall appears dataset entropy based clustering via mi shannon entropy performed poorly whereas mh clustering wa satisfactory comparable fact almost identical parametric result large diﬀerences seems least partially due fact unlike mh dissimilarity estimate entropy estimate adjusting observed distribution adjustment particular dataset seem ﬂuctuate widely repertoire repertoire 5 summary discussion presented simple parametric model ﬁtting analyzing tcr repertoire data may regarded natural multivariate extension poisson abundance model lognormal mixing distribution ha applied tcr modeling perviously seen example analyzing tcr naive regulatory repertoire ep mouse model provides robust consistent ﬁt tcr data allowing detailed yet relatively simple comparison multiple repertoire instance mean dissimilarity analysis hierarchical clustering show tcr dataset parametric model four popular dissimilarity index ii correlation index iii mutual information iv overlap dissimilarity monotone function leading therefore biologically meaningful clustering repertoire contrast applying data estimate dissimilarity clustering seen behave erratically highly dependent particular choice measure some mutual information yielding biologically implausible clustering parametric analysis suggests typical experiment based harvesting sequence tcrs overall tcr population much higher scopic biodiversity study many statistical tool specie abundance comparison originally developed apparent lack agreement dissimilarity 13 measure applied relatively simple dataset seem indicate many commonly used biodiversity statistic may perform poorly applied severely tcr repertoire advantage parametric approach particular model proposed even severe data allows proper adjustment missing abundance information estimation full set repertoire feature statistical package poilog available cran archive make ﬁtting model particularly venient providing numerical algorithm parameter estimation via maximum likelihood study larger number tcr datasets sequence needed order comprehensively evaluate bpln model test ability discriminate tcr repertoire biologically meaningful way appendix mutual information bound fact bound hold dissimilarity index follows general property shannon entropy function deﬁned see koski 2001 any discrete random vector x probability distribution p x h x x x p x log p x summation taken x value p x extending deﬁnition index any pair discrete real random variable x joined distribution p x marginals p x p deﬁne mutual information mi x x x p x log p x p x p x x p x log p x x p log p x x p x log p x h x h x due elementary inequality log x valid any x 0 x x x p x log x p p x x x p x x p p x x x p x p 1 0 therefore mi x note mi x x h x therefore due symmetry argue upper bound suﬃces show h x x follows easily since h x x x x p x log p x x x p x log p x x x p x log x p x bound mi x follow measure course special case mi x 14 reference aitchison ho 1989 multivariate normal distribution biometrika 76 4 anderes stein minin brien seregin marron tablar fujita sato kojima et al 2009 local likelihood estimation local parameter nonstationary random ﬁelds arxiv preprint arstila casrouge baron even kanellopoulos kourilsky 1999 direct estimate human alphabeta cell receptor diversity science 286 5441 barger bunge j 2008 bayesian estimation number specie using noninformative prior biometrical journal 50 6 barth kim lan hunkapiller sobieck winoto gershenfeld okada hansburg weissman 1985 murine receptor us limited repertoire expressed v beta gene segment nature 316 6028 behlke spinella chou sha hartl loh 1985 receptor expression dependence relatively variable region gene science 229 4713 bulmer 1974 ﬁtting poisson lognormal distribution specie abundance data biometrics busch pamer 1999 cell aﬃnity maturation selective expansion infection j exp med 189 4 butz bevan j 1998 massive expansion cell acute virus infection immunity 8 2 casrouge beaudoing dalle pannetier kanellopoulos kourilsky 2000 size estimate alpha beta tcr repertoire naive mouse splenocytes j immunol 164 11 chao 2006 specie richness estimation balakrishnan read vidakovic editor encyclopedia statistical science wiley new york chao shen 2003 nonparametric estimation shannon index diversity unseen specie sample environmental ecological statistic 10 4 chen jin hardegen lei li marino mcgrady wahl 2003 conversion peripheral naive cell regulatory cell induction transcription factor j exp med 198 12 cleveland devlin 1988 locally weighted regression approach regression analysis local ﬁtting journal american statistical association 83 403 davis bjorkman j 1988 antigen receptor gene recognition nature 334 6181 efron tibshirani 1997 introduction bootstrap chapman hall 15 engen lande walla devries 2002 analyzing spatial structure community using poisson lognormal specie abundance model american naturalist 160 1 ferreira singh furmanski wong garden dyson j 2009 diabetic mouse select repertoire natural regulatory cell proc natl acad sci u 106 20 fisher corbet williams b 1943 relation number specie number individual random sample animal population journal animal ecology freeman warren webb nelson holt 2009 proﬁling receptor repertoire massively parallel sequencing genome gill rempala czajkowski 2009 conﬁdence estimation via parametric bootstrap logistic joinpoint regression journal statistical planning inference golub van loan 1996 matrix computation john hopkins univ pr good 1953 population frequency specie estimation population parameter biometrika 40 3 hastie tibshirani friedman j 2001 element statistical learning data ing inference prediction new york horvitz thompson 1952 generalization sampling without replacement ﬁnite universe journal american statistical association 47 260 hsieh liang tyznik self liggitt rudensky 2004 recognition peripheral self naturally arising cell receptor immunity 21 2 hsieh zheng liang fontenot rudensky 2006 intersection regulatory nonregulatory cell receptor repertoire nat immunol 7 4 janeway 2005 immunobiology immune system health disease garland science new york edition karlis 2003 em algorithm multivariate poisson distribution related model journal applied statistic 30 1 kepler tomfohr devlin sarzotti markert 2005 statistical analysis antigen receptor spectratype data bioinformatics 21 16 komatsu wang malissen waldmann hori 2009 heterogeneity natural cell committed regulatory lineage uncommitted minor population retaining plasticity proc natl acad sci u 106 6 koski 2001 hidden markov model bioinformatics springer 16 kuczma pawlikowska kopij podolsky rempala kraj 2009 tcr repertoire expression deﬁne functionally distinct subset regulatory cell j immunol 183 5 legendre legendre 1998 numerical ecology volume 20 development environmental modelling elsevier science amsterdam english edition translated revised second french 1984 edition lewins joanes 1984 number specie biometrics 40 2 luczynski piszcz ilendo kowalczuk 2007 chronic lymphocytic dendritic cell stimulate allogeneic response express chemokines involved migration neoplasma 54 6 magurran 2005 biological diversity current biology 15 4 panus mikszta 1999 tion cell receptor vivo preimmune selection preferred region 3 motif j exp med 189 11 naumov naumova hogan selin gorski j 2003 fractal clonotype distribution memory cell repertoire could optimize potential immune response j immunol 170 8 nayak 1991 estimating number component process superimposed process biometrika 78 1 naylor li vallejo lee koetz bryl witkowski fulbright weyand goronzy j 2005 inﬂuence age cell generation tcr diversity j immunol 174 11 ord whitmore 1986 gaussian distribution model specie abundance commun method pacholczyk ignatowicz kraj ignatowicz 2006 origin cell receptor diversity cell immunity 25 2 pacholczyk kern singh iwashima kraj ignatowicz 2007 cognate speciﬁcities regulatory cell immunity 27 3 pewe netland heard perlman 2004 diverse cell clonotypic response virus infection j immunol 172 5 r development core team 2009 r language environment statistical computing r foundation statistical computing vienna austria rempala szatzschneider 2004 bootstrapping parametric model mortality scand actuar 1 17 rodrigues milan leite j 2001 hierarchical bayesian estimation number specie biometrical journal 43 6 sallusto geginat lanzavecchia 2004 central memory eﬀector memory cell subset function generation maintenance annu rev immunol sallusto lenig orster lipp lanzavecchia 1999 two subset memory lymphocyte distinct homing potential eﬀector function nature 401 6754 savage boniface davis 1999 kinetic basis cell receptor repertoire selection immune response immunity 10 4 sebzda mariathasan ohteki jones bachmann ohashi 1999 selection cell repertoire annu rev immunol ulveda paulino carneiro j 2009 estimation repertoire diversity clonal size distribution poisson abundance model j immunol method sheldon 1969 equitability index dependence specie count ecology 50 3 sichel 1997 modelling frequency function generalized inverse distribution south african statistical journal 31 1 smith solow preston 1996 estimator specie overlap using modiﬁed binomial model biometrics 52 4 solow 1994 number specie community ecology 75 7 venturi kedzierska tanaka turner doherty davenport 2008 method assessing similarity subset cell receptor repertoire j immunol method 329 vu yu ka 2007 entropy estimation statistic medicine 26 21 warren nelson holt 2009 proﬁling model metagenomes short read sequence analysis proﬁling model metagenomes short read 25 4 wong mathis benoist 2007 lineage tracing no evidence conversion conventional regulatory cell response natural pancreatic islet j exp med 204 9 18 figure 1 model generated v observed pair frequency data left panel smoothed heatmap joined frequency data lymph node naive thymus regulatory tcr repertoire wild mouse right panel heatmap sample simulated distribution bpln random variable ﬁtted data increased brightness indicates higher frequency 19 0 2 4 6 8 figure 2 repertoire dendrograms conﬁdence bound obtained bpln model dendrograms hierarchical clustering corresponding conﬁdence interval obtained using glomerative clustering complete link eight repertoire naive regulatory tcrs derived 1 lymph node 2 thymus wild type tcr mini panel left ing using dissimilarity measure dmh given middle bootstrap estimate 95 conﬁdence interval phrobenius norm dmh dissimilarity matrix right dendrogram corresponding upper bound 95 ci dmh dissimilarity matrix bottom panel hierarchical clustering according parametric mutual information dissimilarity measure dmi given 20 figure 3 pairwise comparison dissimilarity bpln model lower triangular panel pairwise dissimilarity plot obtained bpln model ﬁtted mouse data four diﬀerent measure discussed section local loess regression curve added plot better readability upper triangular panel value corresponding linear regression 21 figure 4 dmh dissimilarity parametric model scatter plot along local loess regression curve pairwise dissimilarity eight repertoire computed parametric model using index given case joined probability pθ k l estimated corresponding joined frequency 22 0 1 2 3 4 5 6 0 1 2 3 4 figure 5 repertoire dendrograms conﬁdence bound sures dissimilarity dendrograms various dissimilarity measure obtained parametric analogue model using agglomerative clustering complete link three panel row left dendrograms obtained using point estimate dissimilarity matrix calculated data whereas right one obtained using upper 95 conﬁdence bound frobenius norm distribution dissimilarity matrix corresponding bootstrap timate entire norm distribution provided middle plot density estimator 95 bound marked vertical line top panel hierarchical cluster based nonparametric version dissimilarity index middle panel cluster based version mutual information dissimilarity bottom panel cluster based value shannon entropy function no direct pairwise comparison 23