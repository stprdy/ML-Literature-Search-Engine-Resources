astronomy astrophysics manuscript no c 2021 september 8 2021 soft clustering analysis galaxy morphology worked example sd e peter matthias 1 ur astronomie onigstuhl 17 69117 heidelberg germany andrae 2 institut ur theoretische astrophysik zentrum ur astronomie 2 69120 heidelberg germany submitted feb 01 2010 abstract context huge still rapidly growing amount galaxy modern sky survey raise need automated objective classiﬁcation method unsupervised learning algorithm particular interest since discover class automatically aim brieﬂy discus pitfall oversimpliﬁed classiﬁcation method outline alternative approach called clustering analysis method categorise diﬀerent classiﬁcation method according capability based categorisation present probabilistic classiﬁcation algorithm automatically detects optimal class preferred data explore reliability algorithm systematic test using small sample bright galaxy sd demonstrate performance algorithm practice able disentangle problem classiﬁcation parametrisation galaxy morphology case result give physical argument probabilistic classiﬁcation scheme necessary algorithm present produce reasonable morphological class assignment without any prior assumption conclusion sophisticated automated classiﬁcation algorithm meet necessary requirement lot work still needed interpretation result key word galaxy survey method data analysis statistical introduction classiﬁcation object typically ﬁrst step towards scientiﬁc understanding since brings order ously unorganised set observational data provides standardised term describe object standardised term usually qualitative also tative make accessible mathematical ysis famous example successful classiﬁcation ﬁeld astrophysics diagram star exhibit distinct group diagram represent diﬀerent evolutionary stage reason galaxy classiﬁcation important conceptual step towards understanding physical property formation evolution scenario galaxy advent modern sky survey containing lion sd cosmos panstarrs gama even billion lsst galaxy classiﬁcation galaxy becoming problematic vast amount data excludes hitherto common practice visual classiﬁcation clearly call automated siﬁcation scheme eﬃcient objective work present algorithm automated probabilistic classiﬁcation class discovered automatically however intention work not come yet another morphological cation scheme rather demonstrate could done alternatively standard practice tion astrophysics besides unable present full solution problem morphological galaxy tion since still no accepted method ing arbitrary galaxy morphology cf andrae et al addition lack convincing classiﬁcation scheme many expert sceptical subject classifying galaxy morphology whole parametrisation galaxy spectrum reliable tral classiﬁcations become accepted remaining part introduction ﬁrst give overview modern automated classiﬁcation od work categorisation method describe parametrisation galaxy morphology using shapelets egier 2003 sect sect 3 present algorithm using ha introduced fore yu et al 2005 ﬁeld pattern recognition extensively investigate reliability tion algorithm sect study ha not taken yu et al 2005 sect 5 present worked ample small sample bright galaxy sd object sample selected no practical problem parametrisation arise want disentangle problem classiﬁcation sation much possible aim worked example not science resulting class class assignment demonstrate rithm indeed produce reasonable result conclude sect 3 feb 2010 2 e andrae et al 2010 soft clustering analysis galaxy morphology type classiﬁcation clustering hard nearest neighbour fisher linear spectral clustering discriminant analysis kernel pca soft ıve bayes gaussian mixture model discriminant analysis neural network table overview diﬀerent classiﬁcation clustering algorithm example soft probabilistic algorithm always whereas hard algorithm not necessarily soft rithms always turned hard algorithm not list example algorithm not complete overview classiﬁcation method table 1 give overview diﬀerent classiﬁcation method some example algorithm two criterion categorisation assignment probabilistic soft not hard class speciﬁed priori classiﬁcation covered automatically clustering not algorithm ﬁt categorisation namely not directly assign class object organising map algorithm going present soft rithm assignment probabilistic cf next section reason case galaxy phologies obvious class not clearly separable rather expect galaxy le homogeneously distributed some parameter space class appearing local overdensities exhibiting potentially strong overlap demonstrate sect hard algorithm break case producing biased classiﬁcation result physical reason expect overlapping class first random inclination entation angle line sight induce ous transition apparent axis ratio apparent steepness radial light proﬁles ratio light coming bulge disk component second observation show indeed transitional object diﬀerent morphological type instance sitional object galaxy green valley colour bimodality strateva et al 2001 baldry et al 2004 also reproduced ulations croton et al 2006 hence draw conclusion hard algorithm generically ate analysing galaxy morphology conclusion backed practical experience since even various cialists usually not agree hard visual classiﬁcations bamford et al 2009 fact outcome person visual classiﬁcations becomes probability tion automatically furthermore algorithm clustering algorithm not specify morphological class priori let algorithm discover approach called unsupervised learning method choice uncertain type object ﬁnd given data sample context clustering analysis class referred cluster adopt nology article probabilistic assignment let denote object x parametrisation furthermore let ck denote single class k 1 k possible class prob denotes probability class ck given object represented tional probability prob called class posterior computed using bayes theorem prob prob ck prob prob x 1 marginal probability prob ck called class prior prob called class likelihood denominator prob x act normalisation factor class prior likelihood obtained generative model sect prior posterior satisfy following obvious sation constraint k x prob ck 1 k x prob 1 2 ensure object deﬁnitely assigned some class case hard assignment rior prob likelihood prob replaced kronecker symbol parametrising galaxy morphology shapelets basis function expansion parametrise galaxy morphology term shapelets egier 2003 shapelets scaled version dimensional polynomial form set complete basis function orthonormal val given galaxy image x decomposed linear superposition basis function bm n x x cm nbm n 3 cm n denote expansion coeﬃcients tain morphological information β 0 denotes scaling radius practice number basis function use limited pixel noise summation eq 3 stop certain maximum order nmax depends object ratio olution mean eq 3 approximation only x nmax x cm nbm n 4 use algorithm melchior et al 2007 estimate nmax scale radius linear coeﬃcients wa shown faster accurate idl algorithm massey egier 2005 e andrae et al 2010 soft clustering analysis galaxy morphology 3 problem shapelet modelling wa shown melchior et al limitation number basis function eq 4 lead severe modelling failure misestimation galaxy shape case object low ratio ﬁed two origin bias first gaussian proﬁle shapelets doe not match true proﬁles galaxy typically much steeper second shapelet basis tions intrinsically spherical problem modelling highly eccentric object however stration consider only galaxy high ratio use many basis function impact bias negligible demonstrate fig 1 show shapelet reconstruction disk disk elliptical galaxy drawn sample presented sect reconstruction disk galaxy top row excellent leaving sentially uncorrelated noise residual however reconstruction disk galaxy centre row elliptical galaxy bottom row exhibit artefact originate steep light proﬁles cal disk along minor axis elling failure appear systematically not introduce additional scatter result similar galaxy aﬀected similar way however since shapelet model not capture steep strongly elliptical galaxy well aware algorithm ha le tory power galaxy kind distance shapelet space coeﬃcients form vector space denote vector approximation coeﬃcient vector independent size object wa encoded scale radius moreover also make x invariant image ﬂux since eq 3 ply constant scalar α 0 transformation x change image ﬂux factor therefore demand x x 1 diﬀering image ﬂuxes no impact shapelet coeﬃcients implies morphology direction shapelet cient space corresponding coeﬃcient vector lie surface hypersphere unit radius thus measure distance morphology surface via angle spanned normalised coeﬃcient vector arccos 5 employing polar representation shapelets massey egier 2005 apply rotation parity ﬂips shapelet model estimate object orientation angle second moment light distribution melchior et al 2007 use estimate align model ensures invariance coeﬃcients random orientation additionally break generacy morphology applying parity ﬂips distance two object minimised transformation model space not suﬀer pixellation error increase local density similar object shapelet space soft clustering algorithm present soft clustering algorithm yu et al 2005 explain detail want give brief outline general method basic idea assign similarity pair object ﬁrst explain measure similarity galaxy morphology similarity matrix pairwise similarity interpreted probabilistic model provides generative model also present algorithm ﬁts model similarity matrix estimating similarity instead analysing data shapelet space compute similarity matrix assigning similarity any two data point approach alternative working directly sparsely populated shapelet space employing method dimensionality reduction n data point xn similarity matrix n n symmetric matrix similarity matrix going apply soft clustering analysis based pairwise distance shapelet coeﬃcient space eq 5 estimate pairwise similarity constant factor wmn xm xn α 6 dmax denotes maximum distance any two object given data sample exponent α 0 1 free parameter tune ilarity measure explain choose α sect deﬁnition ensures 0 wmn maximum similarity xm xm note similarity measure ant change size ﬂux orientation parity galaxy morphology similarity matrix weighted undirected graph square symmetric similarity matrix itive interpretation represent weighted undirected graph figure 2 show sketch graph data point xn represented symbolically node xn position node usually arbitrary neither necessary helpful arrange according true location data point parameter space any two data node xm xn connected edge assigned weight wmn obviously weight wmn form n n matrix w matrix symmetric wmn wnm edge no preferred direction case weighted graph undirected graph ory matrix weight w called adjacency matrix interpret similarity matrix adjacency matrix weighted undirected graph inspecting fig 2 introduce some important concept first note also edge necting edge weighted similarity wnn usually taken account order satisfy normalisation constraint cf eq 8 second 4 e andrae et al 2010 soft clustering analysis galaxy morphology figure example shapelet model three galaxy sd g band shown original image left column shapelet model centre column residual right column disk galaxy top row disk galaxy centre row elliptical galaxy bottom row note diﬀerent plot range residual map shapelet decomposition used nmax 16 153 basis function deﬁne degree dn data node xn sum weight edge connected xn dn n x wmn 7 interpret degree dn measure connectivity data node xn graph instance detect outlier object low degree since similar object third note rescale similarity constant scalar factor c 0 without changing pairwise relation hence acquire normalisation constraint n x wmn n x dn 1 8 constraint ensures normalisation tic model going set soft clustering analysis similarity matrix e andrae et al 2010 soft clustering analysis galaxy morphology 5 figure sketch weighted undirected graph data node xn connected edge sake visibility only edge connecting shown edge undirected weighted similarity two connected node xn ck figure sketch bipartite graph bipartite graph contains two set node x xn c ck edge connect node diﬀerent set only weighted adjacency matrix not edge shown model need probabilistic model similarity matrix w interpreted term soft clustering ysis model wa proposed yu et al 2005 similarity matrix closely related graph model motivated graph theory basic idea model similarity two data point xm xn induced object member ters basic hypothesis any classiﬁcation proach object class similar object diﬀerent class detail model weighted undirected graph fig 2 similarity matrix bipartite graph fig 3 bipartite graph graph whose node divided two disjoint set x xn data node c ck cluster node edge graph only connect node diﬀerent set edge weighted undirected weight bnk form n k rectangular matrix b graph adjacency matrix model similarity matrix read ˆ wmn k x bnkbmk λk 9 cluster prior λk pn bnk detailed tion given following section model induces pairwise similarity via transition x x cf yu et al 2005 numerator account strength connection data node certain cluster impact denominator mon membership cluster small degree considered decisive obviously model deﬁned eq 9 symmetric similarity matrix tion constraint w given eq 8 translates via model k x n x bnk k x λk 1 10 constraint need respected ﬁt algorithm ﬁtted model given data similarity matrix compute cluster posterior bilities prob prob xn ck prob xn bnk pk bnl 11 desired soft ments obviously k cluster posterior assigned data node xn normalisation constraint pk prob 1 satisﬁed mathematical derivation give derivation model eq 9 detailed yu et al 2005 ansatz identify similarity ˆ wmn joint ability ˆ wmn prob xm xn 12 interprets ˆ wmn probability ﬁnd xm xn cluster eq 8 ensures normalisation pn prob xm xn not know ticular cluster induces similarity marginalise cluster node fig 3 prob xm xn k x prob xm xn ck 13 marginalisation switched weighted undirected graph model applying bayes theorem yield prob xm xn k x prob prob xm ck 14 used prob ck prob 15 6 e andrae et al 2010 soft clustering analysis galaxy morphology since xm xn not directly connected tite graph statistically independent only assumption derivation implies statistical dependence induced cluster using bayes theorem yield prob xm xn k x prob xn ck prob xm ck prob ck 16 identify adjacency matrix ogy eq 12 bnk prob xn ck 17 marginalisation λk prob ck n x prob xn ck n x bnk 18 marginalised probability λk cluster prior cluster node ck bipartite graph moreover λk degree node fitting similarity matrix order ﬁt model deﬁned eq 9 given similarity matrix perform some ﬁcations first note rewrite eq 9 using matrix notation ˆ w b bt 19 b n adjacency matrix λ diag λk diagonal matrix cluster degree notation enables u employ fast cient algorithm linear algebra change variable b h λ 20 h n k matrix element h interpreted cluster likelihood since hnk bnk λk prob xn ck prob ck prob using new variable h λ model ˆ w data similarity matrix w given ˆ w h λ ht 21 eliminated matrix inversion reduced nonlinearity some extent normalisation straints eq 10 translate h n x hnk n x prob 1 1 k 22 normalisation constraint h λ pled treat matrix independent h n k matrix λ k k diagonal matrix k n 1 model parameter ison number 1 n 1 independent element data similarity matrix due symmetry hence reasonable ﬁt situation requires 1 order constrain model parameter data similarity matrix w ﬁtted maximising logarithmic likelihood function log l graph model yu et al 2005 give derivation tion based theory random walk graph result log l n x wmn log prob xm 23 θ hnk λk denotes set k n 1 model parameter prob xm pk hmkλkhnk ˆ wmn model ber wmn prob xm xn see log l cross entropy true probability tion wmn prob xm xn modelled distribution ˆ wmn prob xm consequently maximising log l maximises information model contains data similarity matrix directly maximising log l hard since ﬁt rameters subject constraint given eq 10 22 use alternative approach make use em algorithm iterative ﬁt routine given initial guess model parameter em algorithm provides set algebraic update equation compute improved estimate optimal parameter automatically respect malisation update equation bilmes 1997 yu et al 2005 λnew k λk n x wmn h λ ht mn hmkhnk 24 hnew nk n x wmn h λ ht mn hmk 25 hnew nk normalised hand whereas λnew k already normalised iteration step update model parameter ha time complexity k n 2 k cluster n data node initialise cluster degree k 1 k whereby trivially satisfy normalisation condition simultaneously ensure no cluster initialised virtually absent nk initialised randomly normalised hand want brieﬂy discus convergence tie em algorithm ha shown redner walker 1984 em algorithm guaranteed verge local maximum log l mild condition indeed wa shown em algorithm ically converging iteration step guaranteed increase log therefore iteration step check much log l wa increased compared previous step log l changed le factor consider em algorithm converged gence criterion wa chosen based systematic test like discussed sect finally note ﬁt sults not unique since ordering cluster purely random estimating optimal number cluster section demonstrate estimate optimal number cluster given data set crucial e andrae et al 2010 soft clustering analysis galaxy morphology 7 figure estimating optimal number cluster data sample shown fig 6 ssr k function number k cluster b mean angular change k ten ﬁts part any clustering analysis essential estimate optimal number cluster due caution problem assessing nonlinear model no theoretically justiﬁed method only heuristic proaches common heuristic bayesian information criterion bic log l p log n 26 akaike information criterion aic log l 27 p n denote number model parameter number data point respectively seen sect model involves k n 1 model parameter consequently bic aic not applicable since log l not able compensate large impact penalty term inability log l likely originate sparse data population parameter space another tool model assessment computationally infeasible case explain compare model diﬀerent complexity heuristically estimate optimal number cluster heuristic employ sum squared residual ssr k n x x wmn hmkλkhnk wmn 2 28 deﬁnition put equal emphasis element left denominator eq 28 ssr would phasise deviation element large value whereas element small value would neglected however large small value pairwise similarity cisive estimate optimal k via position kink function ssr k cf fig 4 kink arises adding cluster doe not lead signiﬁcant provement reconstruction demonstrate procedure fig 4 using toy example fig 6 7 composed six nicely separable cluster ﬁt model similarity matrix shown fig 7 k ranging 1 resulting ssr value shown panel fig fact ssr k exhibit two prominent kink k 3 k 6 rather single one obviously k 3 clustering algorithm group four nearby cluster together thus resulting three cluster k 6 able resolve group subclusters construct quantitative measure puting angular change k log ssr k k k arctan log ssr k ssr k log ssr k ssr k 1 29 k integer log ssr k polygonal chain thus angular change well deﬁned large positive angular change indicates presence kink ssr k however even better ﬁtting similarity matrix several time k averaging angular change result ﬁts diﬀer slightly since model parameter randomly initialised time mean angular change shown panel b fig 4 averaged 20 ﬁts first large k mean angular change consistent zero domain increasing k decrease ssr k doe not improve ﬁt systematically second k 3 k 6 mean angular change deviate signiﬁcantly zero k 2 k 4 mean angular change negative corresponds opposite kink ssr spectrum due k 3 good grouping data large k detection may le deﬁnite due ﬂattening ssr k therefore may systematically underestimate optimal number cluster moreover toy example also demonstrates may single advantageous grouping data may disadvantageous grouping multiple detection advantageous grouping may diﬃcult judge grouping best worst case even may not ﬁnd any signal advantageous grouping would either imply given sample composed object type data doe not contain enough information grouping unfortunately scheme estimating optimal number cluster tremely ineﬃcient computational point view severe disadvantage large data set moreover though heuristic working well signiﬁcance mean angular change likely strongly inﬂuenced variance caused algorithm initialisation 1 not possible compute angular change k 1 case not reasonable grouping anyway assumption object diﬀerent type given data sample 8 e andrae et al 2010 soft clustering analysis galaxy morphology comparison previous work work kelly mckay 2004 2005 close work want discus some detail work diﬀerences author applied soft clustering analysis ﬁrst data release sd kelly mckay 2004 decomposed image galaxy shapelets using idl shapelet code massey egier 2005 kelly mckay 2005 extended scheme ﬁve photometric band u g r z sd thereby also taking account colour information afterwards used principal component analysis pca reduce dimensionality rameter space kelly mckay 2004 reduction wa 91 9 dimension kelly mckay 2005 455 2 dimension ﬁtted gaussians model bilmes 1997 compressed data gaussian component represents cluster able show resulting cluster exhibited reasonable correlation traditional hubble class reducing parameter space pca also using model problematic point view first pca relies assumption direction parameter space carry desired information also carry large fraction total sample variance neither guaranteed tested practice second galaxy morphology not expected normally distributed therefore using model likely misestimate data distribution nonetheless work kelly mckay 2004 2005 wa landmark concerning usage probabilistic algorithm conceptually applying clustering analysis ﬁrst data release sd contrast kelly mckay 2004 2005 not reduce dimensionality parameter space apply clustering algorithm reduced data also not try model data distribution parameter space would virtually impossible due high dimensionality curse dimensionality cf bellman 1961 rather use similarity matrix ha two major advantage first not rely any compression nique pca second not make any mistake choosing potentially wrong model data bution since model similarity matrix two source potential error method estimation pairwise similarity eq 6 hampered lack knowledge metric morphological space some sense ilar mismodelling modelling similarity matrix model only assumption derivation model eq 15 happens only signiﬁcant part pairwise similarity not induced cluster rather observational eﬀects however any classiﬁcation method mated not problem situation systematic test section conduct systematic test using artiﬁcial data sample speciﬁcally designed investigate impact certain eﬀects first demonstrate hard classiﬁcation scheme cause problem subsequent parameter estimation furthermore investigate pact similarity measure ration noise cluster cardinality clustering sults overview start describing artiﬁcial data set going use furthermore describe diagnostics ass performance clustering rithm data set always composed two cluster number example object drawn ter may diﬀerent cluster always designed gaussian distribution prob σ exp h 2 x x p p det σ 30 µ σ denote mean vector covariance matrix respectively knowing true analytic form underlying ability distribution able ass probabilistic assignment proposed clustering gorithm two cluster b true assignment some data point x cluster k b given cluster posterior prob prob σk prob σa prob σb 31 numerator prob σk cluster likelihood cluster prior prob prob b 1 2 ﬂat cancel given data set n object true cluster posterior compared clustering result using expectation value loss function 1 n n x 0 probﬁt 1 else 32 loss function 1 n n x 33 cn denotes correct cluster label object xn false label loss function classiﬁcation rate whereas loss function sensitive misestimation cluster posterior not lead misclassiﬁcations two cluster ally well separated following test true maximum cluster posterior close 100 therefore misestimation mean underestimation maximum teriors quantiﬁed p impact hard cut parameter estimation ﬁrst test want demonstrate hard cut automatically introduced using hard cation clustering algorithm lead systematic estimation parameter bias general ment order support claim hard assignment generically inappropriate overlapping e andrae et al 2010 soft clustering analysis galaxy morphology 9 figure hard classiﬁcations case overlapping cluster deviation ˆ µa estimated true mean separation class hard estimator red line soft estimator blue line predicted bias hard estimator dashed line realisation data sample estimated errorbars shown small visible class not yet concerned algorithm use two gaussians mean µa µb variable separation constant variance gaussian cluster draw n object resulting data sample estimate mean ˆ µk two gaussians compare true mean µk result aged realisation data sample figure 5 show deviation estimated true mean using hard cut x 0 red line weighted mean blue line hard cut x 0 assigns data point x 0 class x 0 class b reasonable hard classiﬁcation simple example complete sample divided two subsamples class b estimate usual arithmetic mean ˆ µhard k 1 nk nk x xk n 34 fig 5 show estimator strongly biased case overlapping cluster limit 0 predict bias analytically expectation value z 0 dx x 35 integration only one half parameter space factor 2 arises gaussians tributing bias shown dashed line fig 5 0 also employ true posterior deﬁned eq 31 weight use ˆ µsoft k pn prob xn pn prob 36 figure artiﬁcial data sample six cluster top matrix pairwise euclidean distance bottom cluster ha underlying bivariate gaussian distribution covariance matrix σ diag 1 1 sampled 50 data point cluster get unbiased estimate despite overlap evident fig comparison demonstrates hard algorithm case overlapping cluster impact similarity measure explain optimise similarity measure deﬁned eq 6 optimal mean given n n symmetric matrix pairwise distance xm xn tune similarity measure adjusting two parameter α tuning similarity measure ha done care since two undesired case first α resulting similarity matrix approach constant wmn 1 n 2 element since xm xn dmax case prefers k 1 cluster independent any grouping data second α similarity matrix approach step matrix deﬁned smn 1 n 1 n 37 normalised pn smn case prefers k n cluster optimal similarity measure diﬀerent possible two worst case 10 e andrae et al 2010 soft clustering analysis galaxy morphology figure estimating optimal similarity measure example data fig top panel modiﬁed manhattan distance c eq 38 cyan line blue line red line α matrix becomes step matrix constant level depend scale parameter bottom panel resulting similarity matrix choose α modiﬁed manhattan tance constant matrix c n x x wmn n 2 38 large figure 7 demonstrates tune similarity measure using artiﬁcial data set toy ple fig basis n n symmetric distance matrix shown bottom panel fig three ferent value top panel show c function obviously c α exhibit maximum thus used choose red curve maximum lowest distance constant matrix exhibit maximum deviation constant matrix choice downweights term w according eq 37 thus also prefer not close 1 blue curve compromise three scale parameter shown fig note choice not optimisation heuristic although artiﬁcial data set fig 6 distance matrix special experienced c α shown fig 7 representative general case resulting similarity matrix shown right panel fig 7 exhibit structure since ordered data point set sake visualisation doe not aﬀect clustering sults clearly recognise six block along diagonal cause similarity always larger similarity furthermore recognise large block four cluster bottom right corner quite similar whereas remaining two cluster le equally dissimilar ters consequently similarity matrix indeed represents feature data set shown fig demonstrate ﬁrst optimal similarity measure indeed capture crucial information data happens not use optimal ity measure use artiﬁcial data set composed two gaussian cluster unit variance separation sample 100 ample object cluster compute matrix pairwise distance using euclidean distance measure data set distance matrix remain unchanged constant parameter vary exponent α similarity measure deﬁned eq 6 value α ﬁt model k 1 2 3 resulting similarity matrix averaging result 15 ﬁts time result test shown fig panel show modiﬁed manhattan distance c constant matrix curve similar fig prominent peak α indicating optimal similarity measure similarity measure ilarity matrix close constant step matrix poorly constrains model case expect observe overﬁtting eﬀects low uals reconstruction result high variance computation time longer since nonlinear model parameter exhibit degeneracy thereby slowing convergence counterintuitively seek large value ssr test since similarity matrix capture well information content data harder ﬁt indeed ssr value shown panel c fig 8 signiﬁcantly lower α peak near optimal expected mean computation time shown panel b minimal optimal similarity measure panel show evidence two ters near optimal α also evidence two cluster show local maximum misclassiﬁcation rate shown panel e insensitive α broad range approach rate 50 rather abruptly extremely optimal similarity measure loss shown panel f sensitive exhibit minimum optimal α grows monotonically value important conclusion draw test method choosing α similarity sure deﬁned sect indeed optimal sense minimises misclassiﬁcation rate loss additionally see using mal similarity measure also reduce computation time order magnitude 2 reason need ﬁt model using k 1 2 3 order compute angular change ssr k k e andrae et al 2010 soft clustering analysis galaxy morphology 11 figure impact similarity measure clustering result modiﬁed manhattan distance c eq 38 b mean computation time per ﬁt without errorbars c mean ssr k value resulting ﬁts k 2 mean angular change ssr k k 2 e mean misclassiﬁcation rate solid line 50 misclassiﬁcation rate dashed line f mean loss maximum cluster posterior impact overlap expect overlapping cluster context galaxy morphology investigate impact overlap clustering result data set used always composed 100 example object drawn two gaussian cluster unit variance separation varied 1 data set compute matrix wise euclidean distance automatically compute optimal similarity matrix optimising α using stant described sect similarity matrix ﬁt model k 1 2 3 cluster furthermore ﬁt algorithm k 1 2 3 data set order compare sults clustering algorithm conﬁguration result averaged 50 ﬁts result test summarised fig panel show mean evidence two cluster based gular change ssr k model scatter algorithm decreasing separation increasing overlap dence two cluster decrease algorithm panel b reveals misclassiﬁcation rate model agreement theoretically expected tion rate expected ideal case black curve two 3 note two curve not compared directly agreement 20 coincidence gaussians mean 2 cal misclassiﬁcation rate given 01 z 0 dx prob x µ 2 σ 39 measure overlap gaussians limit 0 yield 01 1 explanation excellent performance model case cluster equal nalities spherical nevertheless result biased due hard ment panel c fig 9 show mean loss first general trend loss increase decreasing cluster separation due growing amount overlap confusing model second loss decrease signiﬁcantly eﬀect explained follows small tions overlap strong even true cluster posterior close 50 therefore ﬁtted ter posterior scatter around 50 thereby reducing squared error third squared error establishes stant value large separation case true maximum cluster posterior essentially 100 corresponds systematic underestimation maximum posterior p due 4 not compare since hard algorithm loss no reasonable score function case 12 e andrae et al 2010 soft clustering analysis galaxy morphology figure impact overlap clustering sults algorithm model mean angular change ssr k model scatter k 2 b mean classiﬁcation rate model see text compared theoretical prediction curve coincide c mean loss model large separation bias doe not lead classiﬁcations evident panel b fig bias originates fact any two object ﬁnite distance thus similarity test demonstrates model yield convincing result evident misclassiﬁcation rate excellent agreement theoretical prediction best possible score impact noise observational data subject noise gate response clustering result noise similarity matrix simulate noise adding ond dimension data two cluster bivariate gaussian distribution x 1 separation 10 vary size variance ranging 10000 thereby introducing noise translates via euclidean distance similarity matrix cluster 100 example object drawn ﬁt model using k 1 2 result averaged 50 ﬁts value figure impact noise variance clustering result algorithm model mean angular change ssr k model scatter k 2 b mean classiﬁcation rate model c mean loss model result test shown fig evidence two cluster panel rapidly degrades increasing variance model well mean algorithm expected inspecting classiﬁcation rate panel b reveals algorithm insensitive critical variance reached misclassiﬁcation rate increase abruptly algorithm break happens whereas model break amount σy setup evidence two cluster panel rise larger variance though algorithm already broken geometric eﬀect increasing two ters become extended becomes favourable split data along x 0 rather also explains misclassiﬁcation rate 50 regime consequently abrupt nates setup test sampling object cluster might prevented eﬀect would increased computational eﬀort drastically moreover also demonstrates isotropic distance measure problematic using diﬀusion distance richards et al 2009 may solve problem break le abrupt mean loss e andrae et al 2010 soft clustering analysis galaxy morphology 13 panel c since also sensitive posterior timation not lead misclassiﬁcations conclude model fairly insensitive noise kind broad range setup test break impact cluster cardinality typically diﬀerent type galaxy morphology ferent abundancies given data sample instance bamford et al 2009 observe diﬀerent type fraction spiral galaxy galaxy zoo project therefore investigate many object tain kind needed order detect cluster concept number object member tain cluster poorly deﬁned context soft ing generalise concept deﬁning cardinality cluster ck card k n x prob 40 deﬁnition satisﬁes pk card k n since ter posterior normalised case hard clustering eq 40 reduced simple number count ter posterior become kronecker symbol use two ters gaussians unit variance ﬁxed separation vary number object drawn cluster resulting data set always contains 200 object data set compute two diﬀerent similarity matrix first compute similarity matrix using optimal α constant according recipe given sect similarity measure adapted every data set adaptive similarity measure second compute similarity matrix using α optimal similarity measure data set composed equal part object cluster similarity measure data set constant similarity measure two similarity matrix ﬁt model using k 2 average result 50 ﬁts result summarised fig panel show dependence misclassiﬁcation rate nality cluster adaptive similarity measure model break one cluster contributes le 10 data set stant similarity measure break one cluster contributes le 3 behaviour evident loss panel b problem caused larger group data set dominating statistic modiﬁed manhattan distance c deﬁned eq 38 failure similarity measure not model constant similarity measure stay focussed diﬀerence two cluster 3 signal limit cluster detectable model panel c fig 11 show correlation sured cluster cardinality true cluster cardinality constant similarity measure quantity correlate well contrast adaptive similarity measure two quantity not correlate tive similarity measure dominated larger group figure impact cardinality clustering result mean misclassiﬁcation rate b mean loss c correlation estimated true cluster cardinality similarity large small group systematically high lead systematic derestimation maximum cluster posterior cf panel b since separation 10 true posterior essentially 100 shown fig also aﬀects cluster cardinality deﬁned eq 40 cluster overlap stronger bias likely lead misclassiﬁcations conclude optimal similarity measure deﬁned sect fails discover group contribute 10 le complete data sample diﬀerent similarity measure may solve problem optimal similarity measure ha advantage minimising cation rate loss discovered group worked example sd galaxy section present worked example sd galaxy first describe sample galaxy yse applying model whole sample apply small subsample visually siﬁed galaxy prove working not only ple simulated data also real galaxy morphology emphasise meant tion parametrisation sample selection idealised 14 e andrae et al 2010 soft clustering analysis galaxy morphology data sample fukugita et al 2007 fukugita et al 2007 derived catalogue bright galaxy petrosian magnitude r band brighter rp 16 third data release sd abazajian et al 2005 analyse only imaging sample sensitive hii region spiral arm structure expect object bright r also bright neighbouring therefore object high ratio shapelet decomposition employ maximum order suﬃciently large reduce possible modelling problem apart imaging data also retrieved morphological information sd database namely petrosian radius containing 50 90 petrosian ﬂux ratio isophotal semi major semi minor axis logarithmic likelihood ﬁtting de vaucouleurs proﬁles given petrosian radius containing 50 90 petrosian ﬂux deﬁne concentration index analogy conselice 2003 c 5 log 41 compact object elliptical galaxy centration index large whereas smaller extended object slowly decreasing light proﬁles disk galaxy reduce data sample three step first sort peculiar object object deﬁnitely not galaxy blended object object cut mosaic object no viable galaxy phologies wa done visual inspection object second decompose image shapelets using maximum order nmax 12 91 expansion cients object shapelet code performs several internal data processing step namely estimating ground noise subtracting potentially noise mean image segmentation masking multiple object estimating object centroid position cf melchior et al 2007 third sort object shapelet reconstruction doe not provide reasonable model done discarding object whose best ﬁts duced not interval lower limit chosen close unity since shapelets tendency creep background noise ﬁt object setting bright galaxy fukugita et al 2007 data processing leaf u object acceptable check phological information contained original data set reduced data set doe not diﬀer systematically comparing sample distribution petrosian radius axis ratio concentration indeces logarithmic likelihood devaucouleur proﬁles object large compared tion psf sd psf deconvolution scribed melchior et al not necessary mean analyse apparent instead intrinsic gy approximately demonstration three cluster section apply soft clustering algorithm yu et al 2005 ﬁrst time real galaxy use figure mean angular change k graph model data set composed disk disk ellipticals small data set 84 galaxy visually ﬁed disk disk ellipticals 28 object per type 84 galaxy large bright decomposed anew using maximum der nmax 16 resulting 153 shapelet coeﬃcients per object figure 1 show one example object shapelet reconstruction type data set exhibit strong grouping demonstrate graph model indeed discovers disk disk ellipticals automatically without any sumptions estimation number cluster shown fig mean angular change ssr k averaged 20 ﬁts indeed reveal only one signiﬁcant kink k lowest value ssr k 3 ssr corresponds rms residual cf eq 28 ssr 1 n 1 42 denominator 1 n number independent element symmetric similarity matrix conclude fig 12 model indeed favour three cluster however still prove similarity matrix contains suﬃcient mation data model cover correct class k 3 cluster posterior populate plane subject normalisation constraint plane shown fig indeed distribution cluster posterior exhibit excellent grouping ellipticals disk disk three cluster well separated apart two object labelled disk assigned cluster ellipticals second visual inspection two liers revealed initially misclassiﬁed disk excellent result particularly sive remember analysed 84 data point tributed parameter space moreover encouraging soft clustering analysis indeed recover ellipticals disk tomatically order get impression good result actually compare cluster posterior plane e andrae et al 2010 soft clustering analysis galaxy morphology 15 figure cluster posterior space model disk disk ellipticals triangle deﬁnes subspace allowed normalisation constraint posterior corner triangle mark point 100 posterior probability indicates point three posterior equal colour encode priori classiﬁcations unknown algorithm figure comparing fig 13 result pca disk disk ellipticals parameter space spanned ﬁrst two principal component ﬁrst principal component carry second total variance colour encode cation unknown pca algorithm sults obtained pca therefore estimate variance matrix σ data sample space diagonalise only ﬁrst 83 eigenvalue σ since 84 data object poorly constrain covariance matrix ﬁrst two principal nents carry total sample variance fig 14 display parameter space spanned obviously pca performs well reducing parameter space 153 dimension two since ellipticals disk exhibit good however model provides much compact group due degeneracy broken computed minimal spherical 5 pca only reduces parameter space doe not assign class object figure estimating number cluster data set fukugita et al 2007 mean angular change k averaged 15 fit tances described sect case pca eracies unbroken introduce additional scatter fig 13 14 notice group tical signiﬁcantly compact group disk caused three eﬀects first discussed sect 2 parametrisation elliptical galaxy problematic thereby introducing common fact object type common feature picked algorithm ironically problem parametrisation help discriminate type case second described sect 2 make morphological distance measure invariant various random quantity namely image size image ﬂux orientation angle handedness however distance measure thereby similarity measure not ant inclination angle line sight introduces additional scatter clustering sults expect impact random eﬀect smaller ellipticals disk galaxy third disk galaxy usually exhibit complex substructure spiral arm region whereas elliptical galaxy not consequently intrinsic morphological scatter disk galaxy larger ellipticals analysing data set fukugita et al 2007 present result analysing bright galaxy reduced data set fukugita et al 2007 chosen similarity sure corresponding optimal α according sect shape curve ﬁed manhattan distance c α generic form fit result similarity matrix k ing 1 20 shown table 2 fig signiﬁcant deviation mean angular change zero k 3 k signal k 2 ignored since ssr value high cf table 2 first investigate clustering result k 3 ssr 146 cf table 2 corresponding rms residual cf eq 42 matrix reconstruction fig 16 show top ﬁve ple object three cluster together togram distribution cluster posterior inspecting 16 e andrae et al 2010 soft clustering analysis galaxy morphology k minimal ssr mean angular change degree 1 39 220 2 12 313 3 6 146 4 4 965 5 3 868 6 3 155 7 2 676 8 2 254 9 2 093 10 1 931 11 1 790 12 1 661 13 1 593 14 1 532 15 1 476 16 1 430 17 1 405 18 1 383 19 1 365 20 1 348 table fitting similarity matrix object present minimal ssr value 15 ﬁts mean angular change averaged 15 ﬁts example image clearly see ﬁrst cluster obviously composed disk galaxy whereas second cluster contains ellipticals third cluster cluster disk galaxy disk high tion angle however blended object ha ﬁed cluster still some blended jects left failed remove since sorting blended object visually inspected image reduced resolution cluster posterior k 3 mative first notice object cluster 1 typically low posterior cluster 2 intermediate posterior cluster 3 disk similar disk ellipticals second object cluster 2 low posterior cluster third object cluster 3 tend similar object cluster 2 disk similar ellipticals probably due higher light concentration steep light proﬁles result demonstrate clustering si indeed yield reasonable result realistic data set furthermore result three cluster similar clustering scheme sect however three ters not enough describe data faithfully evident much larger ssr value k 3 pared k 8 fig 17 show sulting cluster posterior space k large part available posterior space remain empty whereas central region crowded behaviour due lack plexity model strongly suggests cluster necessary k 8 ssr 254 cf table 2 corresponds rms residual reconstruction show ten top example object cluster fig first notice resulting grouping excellent however diﬃcult understand diﬀerences some cluster cluster 1 5 obviously object high ellipticity disk diﬀerence bulge dominance much weaker cluster 1 5 figure top example object k 3 cluster row corresponds cluster also show distribution cluster posterior beneath object cluster 1 seems contain disk cluster 2 compact object cluster 3 disk figure cluster posterior space k projected cluster posterior displayed 10 translucent density becomes visible see fig 13 explanation topology plot cluster diﬀer radial light proﬁles diﬀerence cluster 2 7 disk particular interest cluster 3 8 seem contain roundish compact object however posterior histogram reveal highly metric relation object cluster 3 also prefer cluster 8 cluster nevertheless top example cluster 8 extremely low posterior ter 3 association cluster 3 highly disfavoured although not explain result without vestigation interesting algorithm picked distinctive signal access isophotal axis ratio concentration index cf eq 41 object e andrae et al 2010 soft clustering analysis galaxy morphology 17 figure top example object k 8 cluster row corresponds cluster object also show histogram distribution cluster posterior beneath object aligned shapelet space not real space 18 e andrae et al 2010 soft clustering analysis galaxy morphology figure mean axis ratio concentration index cluster fig weighted mean computed top 100 example jects cluster show contour take account possible correlation tigate distribution cluster figure 19 show mean axis ratio mean concentration index eight cluster averaged 100 top example cluster highest mean axis ratio cluster 1 cluster disk galaxy cluster est concentration index cluster 7 cluster disk galaxy exhibit extended smooth light proﬁles cluster 3 4 5 8 largest tion index evident fig 18 cluster indeed composed rather compact object seem elliptical galaxy however no decisive distinction fig not necessarily ﬂaw clustering result rather likely caused concentration axis ratio insuﬃcient parametrisation scheme cf andrae et al seems like resulting classiﬁcation scheme tially disk disk elliptical increase number cluster get diversiﬁcation may caused bulge dominance inclination angle emphasise primary goal strate method discovers morphological class provides assignment reasonable conclusion brieﬂy summarise important argument result galaxy evolution process observation experience previous classiﬁcation attempt strongly suggest probabilistic soft classiﬁcation hard classiﬁcations appear generically priate two algorithm applied galaxy morphology far gaussian mixture model kelly mckay 2004 2005 model yu et al 2005 presented work weak point gaussian mixture model dimensionality reduction assumption gaussianity weakness model deﬁnition ity measure shapelet formalism similarity measure model produce reasonable cluster assignment real galaxy tomated discovery class corresponding disk disk elliptical galaxy without any prior assumption impressive demonstrates great potential clustering analysis moreover tomatically discovered class qualitatively ferent meaning compared class since represent grouping preferred given data sample random eﬀects orientation angle inclination major obstacle since introduce additional scatter parametrisation galaxy morphology data set containing n galaxy computation time scale n 2 nevertheless experienced clustering analysis feasible data set containing n 10 000 galaxy without employing computer conclude clustering analysis data set one million galaxy possible using computer possible enhance method setting classiﬁer based class found clustering analysis thereby improving time plexity n 2 n method presented paper not limited galaxy morphology only instance could sibly applied automated classiﬁcation agn detection bottom line paper automatic ery morphological class assignment clustering analysis doe work le prejudiced visual classiﬁcations though terpretation result still open issue especially analysing new data sample ﬁrst time tering algorithm objective using class visual classiﬁcations advantage sophisticated statistical algorithm justify considerable complexity acknowledgement ra thanks coryn comment particularly useful improve work furthermore ra thanks knud jahnke eric bell helpful discussion cially interpretation result ra funded tschira scholarship pm supported dfg priority programme reference abazajian ueros et al 2005 aj 129 1755 andrae melchior jahnke prep baldry glazebrook brinkmann et al 2004 apj 600 681 bamford nichol baldry et al 2009 mnras 393 1324 bellman 1961 adaptive control process guided tour princeton university press bilmes 1997 international computer science institute cal report conselice j 2003 relationship stellar light distribution galaxy formation history croton springel white et al 2006 mnras 365 11 fukugita nakamura okamura et al 2007 aj 134 579 kelly mckay 2004 aj 127 625 kelly mckay 2005 aj 129 1287 massey egier 2005 mnras 363 197 e andrae et al 2010 soft clustering analysis galaxy morphology 19 melchior andrae maturi bartelmann 493 727 melchior boehnert lombardi bartelmann arxiv melchior meneghetti bartelmann 2007 463 1215 redner walker 1984 siam review 26 195 egier 2003 mnras 338 35 richards freeman lee schafer 2009 apj 691 32 strateva c ˇ knapp et al 2001 aj 122 1861 yu yu tresp 2005 advance neural information processing system