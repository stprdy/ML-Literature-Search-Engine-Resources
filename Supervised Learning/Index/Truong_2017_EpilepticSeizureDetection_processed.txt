supervised learning automatic channel selection epileptic seizure detection nhan truong levin kuhlmann mohammad reza bonyadi jiawei yang andrew faulks omid kavehei abstract detecting seizure using brain neuroactivations recorded intracranial electroencephalogram ieeg ha widely used monitoring diagnosing therapy epileptic patient however computational efﬁciency gain needed method implemented implanted device present novel method automatic seizure detection based ieeg data outperforms current seizure detection method term computational efﬁciency maintaining accuracy proposed algorithm incorporates automatic channel selection ac engine stage seizure detection procedure ac engine consists supervised classiﬁers aim ﬁnd ieeg channel contribute seizure seizure detection stage involves feature extraction classiﬁcation feature extraction performed frequency time domain spectral power correlation channel pair calculated random forest used classiﬁcation interictal ictal early ictal period ieeg signal seizure detection paper retrospective ieeg data accessed via kaggle provided international epilepsy portal dataset includes training set hour interictal data 41 minin ictal data test set hour compared dataset achieve increase computational efﬁciency 400 min better average detection delay proposed model able detect seizure onset sensitivity speciﬁcity mean detection delay area curve auc comparable current auc keywords seizure detection ieeg random forest automatic channel selection introduction epileptic seizure affect nearly 1 global population only two third treated medicine approximately 7 cured surgery litt echauz 2002 therefore seizure onset detection subsequent seizure suppression becomes important patient not cured neither drug surgery early detection allow early electrical stimulation suppress seizure echauz et 2007 paper focus effectively reliably detect seizure onset based ieeg pattern cause treatment seizure beyond scope paper eeg ha commonly used interface thanks convenient reading high temporal resolution eeg signal zeng song 2015 zhang et 2013 recent year eeg ha provided promising possibility detect even predict epileptic seizure tieng et 2016 fatichah et 2014 parvez paul 2015 saab gotman 2005 osorio frei 2009 kuhlmann et 2009 seizure detection fatichah et al 2014 used combination principle component analysis pca neural network fuzzy membership function achieve accuracy rate tieng et al 2016 combined wavelet adapted continuous wavelet transform algorithm able achieve sensitivity speciﬁcity eeg data mouse another remarkable method transform eeg signal image leverage image processing technique parvez paul 2015 approach wa able obtain sensitivity speciﬁcity zabihi et al 2016 reconstructed eeg phase space using embedding method poincare section phase space reduced pca fed linear discriminant analysis lda naive bayesian classiﬁers approach achieved sensitivity speciﬁcity seizure detection shoeb 2009 deployed 8 ﬁlters spanning frequency range hz eeg epoch channel concatenated 3 epoch form feature set fed svm classiﬁer approach wa tested eeg dataset wa able detect 96 163 test seizure mean detection delay second using dataset eeg signal wa transformed image representation using projection patient electrode magnitude 3 different frequency band spanning range hz 1 block eeg signal thodoroff et 2016 recurrent convolutional neural network took 30 consecutive block input perform feature extraction classiﬁcation detector method comparable performance compared proposed method shoeb 2009 prominent feature extraction technique consider characteristic frequency time domain efﬁcient tool analysis ﬁlters used extract ratio seizure preprint submitted expert system application june 22 2021 31 jan 2017 table 1 summary existing seizure detection method reference eeg type no patient no seizure data duration patient split data training testing sensitivity mean detection delay ictal interictal saab gotman 2005 scalp 44 195 1012 no 64 76 kuhlmann et al 2009 scalp 21 88 525 no 70 81 wang et al 2016 scalp 10 44 72 min 121 h yes 80 zabihi et al 2016 scalp 24 161 h 169 h yes 25 fatichah et al 2014 min h 90 hill 2014 intracranial 12 48 41 min h yes 50 parvez paul 2015 intracranial 21 87 58 h 490 h 80 100 97 detection rate fdr speciﬁcity duration ictal interictal not provided separately intracranial eeg seizure class intracranial extracranial class content short foreground comparison background saab gotman 2005 osorio frei 2009 saab gotman 2005 applied bayes formula extracted feature estimate probability seizure eeg signal method achieved impressively short onset detection delay 76 sensitivity false positive rate kuhlmann et al 2009 extended saab gotman method combining extra feature ﬁnd superior detector method wa able achieve sensitivity 81 false positive rate median detection delay dataset 525 h scalp eeg data current seizure detection method proposed hill 2014 dataset considered implemented extended paper dataset derived kaggle seizure detection competition hill 2014 scored auc announced winner description dataset provided section paper signiﬁcantly enhanced computational efﬁciency hill method employing automatic channel selection algorithm enabled u process data accurately reduced number channel table 1 summarizes existing seizure detection method recent year remainder paper organized follows section 2 describing dataset propose automatic channel selection engine help reduce number channel processed section also present feature extraction random forest classiﬁer used seizure detection section 3 evaluates performance proposed model comparison method dataset section 4 concludes achievement paper proposed method intracranial eeg data wa recorded multiple subject varying number channel sampling rate propose automatic channel selection engine ﬁlter channel le relevant seizure engine accepts raw ieeg data corresponding label number channel selected determines index channel relevant seizure detection index channel stored engine only need executed one time beginning subject feature extraction wa performed frequency time domain selected channel information extracted frequency time domain wa concatenated fed random forest classiﬁer fig 1 present ﬂowchart proposed method dataset dataset analyzed paper obtained kaggle 2014 intracranial eeg signal recorded 4 dog 8 patient epileptic seizure recording sampled 400 hz 16 electrode dog sampled 500 hz 5 khz varying number electrode ranging 16 72 human data wa 1 ieeg epoch annotated ictal seizure state interictal state interictal data wa captured not le one hour seizure onset randomly chosen recorded data ictal segment also came time second seizure onset ﬁrst data point segment training dataset consisted 41 min ictal data hour interictal data summary training dataset presented table note early ictal state paper ictal state occurring within ﬁrst 15 seizure onset proposed method wa tested hidden dataset provided kaggle dataset consists hour unlabeled ieeg data kaggle 2014 table 2 summary dataset subject no electrode ictal data length interictal data length unlabeled data length ratio 16 178 418 3181 16 172 1148 2997 16 480 4760 4450 16 257 2790 3013 68 70 104 2050 16 151 2990 3894 55 327 714 1281 72 20 190 543 64 135 2610 2986 30 225 2772 2997 1 36 282 3239 3601 16 180 1710 1922 total 2477 23445 32915 2 figure 1 flowchart proposed method raw ieeg data n channel fed ac ﬁnd channel contribute seizure ac engine executed one time only subject beginning index channel stored feature extraction frequency time domain done channel extracted feature fed classiﬁer using random forest algorithm discriminate interictal ictal early ictal epoch automatic channel selection intracranial eeg data wa recorded using various number channel 16 30 36 55 64 68 72 large number channel yield higher computational complexity requires data analyzed also deteriorate diversity ieeg data hence degrade performance seizure detection some channel may capture irrelevant information guyon elisseeff 2003 one leverage knowledge manually select channel genuinely contribute seizure however hard not impossible disclose set channel signiﬁcant subject required use expertise analyze every subject group subject proclaim list signiﬁcant channel regard subject group subject manifestly task propose novel approach automatic channel selection ac follows labeled data ﬁrst transformed obtain frequency information speciﬁcally fft applied onto raw ieeg data n channel fft value sliced extract data bin range hz applied magnitude transformed data n 30 minatrix 30 number bin range hz channel correlation involved ac stage confusing identify channel important based importance level correlation pair channel therefore correlation among channel disregarded stage individual channel becomes feature fed classiﬁers one set classiﬁers determine importance level feature channel several option classiﬁers using different ensemble algorithm gradient boosting adaboost random forest multiple classiﬁers used ﬁnal importance level channel sum importance value obtained classiﬁers measure feature importance paper implemented using ensemble library 2014 importance feature estimated often feature used split point individual decision tree ensemble classiﬁer 2014 important note only train dataset wa involved ac stage output channel selection algorithm set channel sorted based level contribution detection seizure paper selected value some experiment aiming maximising ﬁnal auc score selection however could automated setting threshold importance value channel feature extraction feature extraction frequency domain ieeg signal selected channel transformed fft transformed data ﬁltered discard high frequency noise low frequency artifact frequency range hz wa shown achieve best performance dataset hill 2014 eigenvalue used effective technique discriminate ictal epoch zhang parhi 2016 hill 2014 sardouie et 2015 order compute eigenvalue spectral power primarily normalized zero mean standard deviation one along channel estimating cross spectral matrix hill 2014 contrary hill feature extraction not use cross spectral coefﬁcients feature empirical observation show feature could worsen detection accuracy sample recording corresponding power spectrum ictal interictal segment illustrated fig 2 feature set frequency domain consists 3 spectral power 1 hz bin range hz applying magnitude fft transformation eigenvalue sorted descending order cross spectral matrix selected channel spectral power figure 2 sample 1 ieeg recording b c interictal e f ictal early state within 15 seizure onset g h ictal early state ieeg signal presented one column g recorded channel figure 3 sample 1 ieeg recording power spectrum b c interictal e f ictal early state g h ictal early state ieeg signal presented one column g recorded channel subplots ﬁgure associated subplots fig 2 feature extraction time domain raw ieeg signal ﬁrstly 400 hz similarly frequency domain ﬁltered ieeg data normalized zero mean unity standard deviation along channel prior computing covariance matrix eigenvalue illustrated fig 4 ieeg data 16 selected channel low correlation others interictal state correlation slightly increase seizure early state becomes remarkable beyond early state feature set time domain consists b c figure 4 covariance matrix interictal b ictal early state c ictal correlation channel low interictal period channel correlated seizure onset highly correlated ictal state coefﬁcients upper triangle correlation matrix ieeg signal selected channel eigenvalue correlation matrix sorted descending order classiﬁer random forest algorithm wa ﬁrst proposed breiman 2001 algorithm us large set decision tree acquire average result random forest ha shown good performance dataset high dimensional datasets biology medical ﬁelds scornet 2016 huynh et 2016 cabezas et 2016 paper not go deep mathematical property found breiman 2001 scornet 2016 rather parameter achieve highest performance given feature set random forest classiﬁer paper implemented using library 2014 parameter classiﬁer reused approach proposed hill 2014 3000 decision tree classiﬁer analysis 1 ieeg epoch categorizes 3 class output early ictal ictal within 15 onset ictal interictal regarding sensitivity speciﬁcity evaluation random forest classiﬁer adjusted classiﬁer binary classiﬁer detects whether 1 ieeg signal ictal interictal evaluation section compare efﬁcacy proposed method current method proposed hill 2014 dataset metric used test proposed approach area receiver operating characteristic curve auc sensitivity speciﬁcity onset detection delay ﬁrst fold half seizure per subject chosen training set rest validation note seizure only appears either training set validation set interictal data wa divided randomly two equal length set one training one validation second fold role training validation set ﬁrst fold swapped final result reported following average output two fold also test hidden dataset consisting hour unlabeled 4 table 3 comparison proposed method computational efﬁciency ac engine subject hill 2014 proposed method subject no electrode data duration min training training processing time improvement 16 2 16 22 16 16 68 16 55 6 72 64 30 50 36 19 244 16 average channel selection ac time feature extraction fa time ieeg data compare auc score computed leader board kaggle two method table 4 auc comparison proposed method subject hill 2014 proposed method subject auce auc auc auce auc auc 100 100 100 average paper aim detect whether given 1 ieeg segment represents seizure whether segment within ﬁrst 15 early respective seizure metric performance evaluation average two auc two detection kaggle 2014 given auc 1 2 auc auce 1 auc auc two class ictal including early seizure interictal auce auc two class early seizure table 5 comparison proposed method subject sensitivity sen speciﬁcity sep onset detection delay corresponding threshold thres binary classiﬁcation seizure state hill 2014 proposed method subject delay sen spe thres delay sen spe thres 1 1 4 3 2 2 1 100 1 100 10 6 2 average 5 including ictal state 15 onset interictal state table 3 summarizes gain processing time including time feature extraction classiﬁer training subject since chose ac engine subject number electrode le equal 16 would skip channel selection stage hence processing time proposed method comparable method subject overall gain computational efﬁciency patient 16 ieeg channel therefore automatic channel selection promising seizure detection application table 4 summarizes auc score using proposed method subject overall auc score two method comparable proposed method wa tested hidden dataset acquired auc score comparable score hill 2014 regarding sensitivity speciﬁcity evaluation random forest classiﬁer adjusted classiﬁer binary classiﬁer detects whether 1 ieeg signal ictal interictal table 5 describes comparison proposed method sensitivity speciﬁcity onset detection delay threshold classiﬁer output used separate whether 1 ieeg segment ictal interictal wa determined per subject value threshold wa selected achieve balance sensitivity speciﬁcity higher threshold value yield higher speciﬁcity lower sensitivity vice versa proposed method achieved comparable performance term sensitivity speciﬁcity however proposed method yield considerable improvement mean onset detection delay onset detection delay indicates time second classiﬁer detect seizure onset delay 1 ﬁrst 1 ictal ieeg segment seizure onset correctly detected since ieeg signal divided 1 epoch minimum onset detection delay could achieved 1 table 5 show proposed model ha shorter onset detection delay 900 min current best method discussion presented seizure detection method based novel approach automatic ieeg channel selection provides comparable performance method dataset considered although lead extra overhead computing time beginning impact overall processing time negligible channel selection need executed one time only subject advantage automatic channel selection hand remarkable firstly redundant unrelated ieeg signal eliminated help improve efﬁcacy seizure detection system secondly since amount data processed reduced processing time also reduced gain computational complexity becomes visible signiﬁcant subject large number channel instance reducing number channel analyzed 72 16 see table 3 processing time improved detection delay processing time number channel method proposed method proposed method optimized smaller triangle better figure 5 comparison proposed method two set term detection delay number processed channel processing time table 7 auc comparison proposed method wa optimized training data per subject hill 2014 proposed method subject auce auc auc auce auc auc 100 100 100 100 100 100 average spectral power correlation matrix eigenvalue ieeg channel frequency time domain shown important feature seizure detection using ieeg recording proposed approach ha mean seizure onset detection delay critical example electrical stimulator suppress seizure time order gain computational efﬁciency number selected channel optimized training 6 table 6 comparison proposed method computational efﬁciency ac engine wa optimized training data per subject hill 2014 proposed method subject no electrode data duration min training training processing time improvement 16 9 2 6 16 10 22 15 16 8 77 16 13 36 68 16 5 16 11 39 55 8 31 4 72 4 8 64 16 115 30 8 50 56 36 13 118 16 8 23 average channel selection ac time feature extraction fa time data per subject based auc range number channel 1 total number channel used ﬁnd corresponding auc chosen smallest auc not le 1 compared best auc using approach computational efﬁciency mean detection delay improved 400 min respectively compare see hill 2014 comparable performance maintained demonstrated table 6 7 overall auc tested hidden test dataset comparable fig 5 demonstrates advantage proposed method term detection delay number channel analyzed processing time conclusion detection seizure especially early state crucial patient not treated drug surgery precise seizure detection allows electrical stimulation timely interrupt alteration consciousness subsequent convulsion although high performing seizure detector available translating seizure detection method hardware implementation implantable seizure control device requires greater gain computational efﬁciency paper proposed automatic channel selection engine mechanism adequately determine informative ieeg recording prior feature extraction engine gave rise signiﬁcant computational efﬁciency improvement subject large number recording channel computational efﬁciency wa improved see fig 6 overall result proposed table 8 comparison proposed method wa optimized training data per subject sensitivity sen speciﬁcity sep onset detection delay corresponding threshold thres binary classiﬁcation seizure state hill 2014 proposed method subject delay sen spe thres delay sen spe thres 1 1 4 2 2 1 1 100 1 100 100 10 6 average 7 method comparable save processing time reduced mean detection delay 400 min critical factor application acknowledgement truong greatly acknowledges commonwealth scientiﬁc industrial research organisation csiro ﬁnancial support via phd scholarship pn reference reference breiman random forest machine learning 45 cabezas galleguillos predicting vascular plant richness heterogeneous wetland using spectral textural feature random forest algorithm ieee geoscience remote sensing letter 13 echauz georgoulas smart gardner firpi litt vachtsevanos monitoring signal analysis control epileptic seizure paradigm brain research mediterranean conference control automation fatichah iliyasu abuhasel suciati principal component neural network fuzzy membership function epileptic seizure detection international conference natural computation guyon elisseeff introduction variable feature selection journal machine learning research 3 hill seizure detection using fft temporal spectral correlation coefﬁcients eigenvalue random forest technical report github huynh gao kang wang zhang p lian shen estimating ct image mri data using structured random forest model ieee transaction medical imaging 35 kaggle upenn mayo clinic seizure detection challenge url kuhlmann burkitt cook fuller grayden seiderer mareels seizure detection using seizure probability estimation comparison feature used detect seizure annals biomedical engineering 37 litt echauz prediction epileptic seizure lancet neurology 1 osorio frei detection quantiﬁcation warning control epileptic seizure foundation scientiﬁc epileptology epilepsy behavior 16 parvez paul epileptic seizure detection exploiting temporal correlation electroencephalogram signal iet signal processing 9 saab gotman system detect onset epileptic seizure scalp eeg clinical neurophysiology 116 sardouie shamsollahi albera merlet denoising ictal eeg data using source separation method based prior ieee journal biomedical health informatics 19 ensemble method url scornet random forest kernel method ieee transaction information theory 62 shoeb application machine learning epileptic seizure onset detection treatment thesis massachusetts institute technology thodoroff p pineau lim learning robust feature using deep learning automatic seizure detection tieng kharatishvili chen reutens mouse eeg spike detection based adapted continuous wavelet transform journal neural engineering 13 wang sun tao li bao yan epileptic seizure detection based partial directed coherence analysis ieee journal biomedical health informatics 20 zabihi kiranyaz rad katsaggelos gabbouj ince analysis phase space via poincare section seizure detection ieee transaction neural system rehabilitation engineering 24 zeng song optimizing eeg classiﬁcation stationary matrix logistic regression interface ieee transaction neural network learning system pp zhang yang guan bayesian learning spatial filtering interface ieee transaction neural network learning system 24 zhang parhi seizure prediction using spectral power ratio spectral power ieee transaction biomedical circuit system 10 8