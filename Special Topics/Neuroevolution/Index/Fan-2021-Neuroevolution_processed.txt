24 jan 2022 neuroevolution machine learning potential combining high accuracy low cost atomistic simulation application heat transport zheyong 2 cunzhi yanzhou 2 keke haikuan 2 6 yue tapio 7 physical science technology bohai university jinzhou china group qtf centre excellence department applied physic aalto university aalto espoo finland mechanical engineering university hong kong pokfulam road hong kong sar china school molecular engineering university chicago chicago illinois 60637 united state advanced innovation center material genome engineering department physic university science technology beijing beijing 100083 china advanced innovation center material genome engineering corrosion protection center university science technology beijing beijing 100083 china centre mathematical modelling department mathematical science loughborough university loughborough leicestershire uk dated january 25 2022 develop nep framework generating neural network based potential trained using evolutionary strategy performing scale molecular dynamic md simulation descriptor atomic environment constructed based chebyshev legendre polynomial method implemented graphic processing unit within gpumd package attain computational speed 107 per second using one nvidia tesla furthermore heat current available nep pave way eﬃcient accurate md simulation heat transport material strong phonon anharmonicity spatial disorder usually not accurately treated either traditional empirical potential perturbative method introduction classical interatomic potential play crucial role atomistic simulation particular molecular ic md simulation various static ical material property eﬃciently computed ml potential force ﬁelds interatomic potential constructed based ml model demonstrated able achieve accuracy comparable ing data reducing computation time small fraction corresponding lations various ml model used construct ml potential including artiﬁcial neural network 6 gaussian regression 7 linear regression 8 any ml model many ﬁtting parameter need determined training model mechanical data large number ﬁtting parameter foundation superior interpolation pability ml potential compared conventional empirical potential only ten ﬁtting parameter however ﬁnding optimized set parameter nontrivial task conventional ing method neural network potential based dient descent could trapped local imum loss function ml model leading solution alternative training method ml model based evolutionary algorithm genetic algorithm genetic programming evolutionary programming evolutionary strategy approach combined neural network known lution ha long applied evolve neural work 9 ha greatly improved art evolutionary algorithm natural evolution strategy 10 variant called separable natural tion strategy 11 ha computational complexity linear number ﬁtting parameter well suited evolve neural network work develop framework called lution potential neps generating neural network based ml potential trained using separable ral evolution strategy 11 although evolutionary rithms le likely trapped local minimum population based method require evaluating loss function multiple time within one step also called one generation usually computationally demanding algorithm speed calculation realize eﬃcient ic processing unit gpu implementation lations within gpumd package gpu implementation speed training process make md simulation signiﬁcantly faster current implementation ml potential demonstrate eﬃciency accuracy nep paring gpumd some popular implementation ml potential including quip package 15 ments gaussian approximation potential gap 7 2 mlip package 16 implement moment sor potential mtp 17 package 18 implement deep potential dp 19 20 particular focus demonstrating bility nep heat transport simulation remainder paper organized follows sec ii sec ii b review formulation force virial heat current general potential 21 22 sec ii c present descriptor used nep mapping set relative coordinate set function required symmetry sec ii neural network connecting descriptor site energy atom discussed section ii e present detailed algorithm training nep using natural evolution strategy section ii f discus general strategy gpu mentation sec iii validate benchmark nep comparing performance some tations ml potential sec iv demonstrate applicability nep heat transport simulation selected case study section v summarizes cludes ii theory potential usually potential make eﬃcient gpu implementation potential one must ﬁrst derive explicit expression various quantity 13 start reviewing some formulation derived ref 21 general potential partial force general potential total potential energy u system written u x ui 1 site energy ui atom ui ui rij 2 paper deﬁne rij relative position atom atom j rij 3 cartesian component vector denoted xij yij zij therefore rij denotes tion relative position central atom atom usually ﬁnite cutoﬀdistance rc adopted only atom j distance rij smaller rc considered collection starting potential energy general force expression respect weak form ton third law ha derived 21 fi x fij 4 fij 5 fij understood force acting atom atom j possibly inﬂuenced atom partial derivative understood tor component note although fij respect weak form ton third law fij doe not respect strong form newton third law fij lations ref 21 only require weak form since obtained exchange index practical implementation only need calculate store due importance call partial force derive explicit expression tial force sec ii virial stress heat current thermal conductivity starting force expression one derive virial tensor play crucial role md simulation expression ha derived ref 21 ref 22 ha reformulated convenient form wi x rij 6 tensor product two tor using virial expression heat current derived ref 21 conveniently pressed ji wi vi 7 vi velocity atom virial eq 6 generally not symmetric tensor one must heat transport application use full 3 3 tensor instead six component only total virial system p wi hand symmetric sor six independent component only validity heat current expression ha extensively umented implemented used lammps package 26 ha shown 21 23 27 28 erroneous general potential total heat current j sum heat current j p ji homogeneous librium md hnemd method 29 lattice thermal 3 conductivity tensor κµν computed lowing expression v x ν κµνf ν e 8 fe driving force parameter nonequilibrium ensemble average heat current driving force parameter induce following ternal force atom 22 29 f ext fe wi 9 solid system spectral lattice thermal tivity κµν ω function angular frequency ω computed following relation 22 29 2 v z kµ eiωtdt x ν κµν ω f ν e 10 k x 0 vi 11 correlation function summary long partial force derived implemented one conveniently calculate virial heat current used realize constant stress ensemble detailed heat transport simulation coordinate descriptor vector ml potential site potential ui not rectly modelled function relative coordinate rij function tor vector whose component invariant respect spatial translation rotation version permutation atom specie 30 many descriptor proposed including behler symmetry function 31 smooth lap atomic position soap 30 bispectrum 7 coulomb matrix 32 moment tensor 17 atomic cluster expansion 33 embedded atom scriptor 34 gaussian moment 35 atomic permutationally invariant polynomial 36 library implementing various descriptor system descriptor use nep motivated behler symmetry function 31 optimized sion soap 40 central atom component system deﬁne set radial descriptor component n qi n x gn rij 12 set angular descriptor component n l qi nl x x gn rij gn rik pl co θijk 13 pl co θijk legendre polynomial order l θijk angle formed ij ik bond function gn rij radial function choose express chebyshev polynomial variable x 2 gn rij tn x 1 2 fc rij 14 variable x deﬁned value recurrence relation evaluating chebyshev nomials derivative used presented appendix empirically found beneﬁcial make gn rij positive deﬁnite eq 14 similar pression ha used atomic cluster expansion approach 33 function fc rij cutoﬀfunction deﬁned fc rij 1 2 1 co π rij rc 15 r fc rij 0 r rc following inition neural network potential 6 31 ﬁrst four radial function shown fig 1 0 1 0 1 fig radial function gn r function reduced distance 0 note radial function used dial angular component descriptor dial expansion radial component given order nr max n 0 1 nr max angular component radial expansion na max n 0 1 na max angular expansion 4 lmax l 1 lmax full descriptor vector ha dimension ndes max 1 max 1 lmax 16 note cutoﬀradii radial angular ponents not necessarily take ferent value denoted rr c ra c respectively radial component used represent relatively interaction coulomb van der waals interaction angular component mainly account interaction change factor gn rij gn rik eq 13 gn rij rik 1 apply addition rem spherical harmonic obtain descriptor qi similar soap descriptor ref 40 qi l x ci nlm 17 ci nlm x gn rij lm θij φij 18 θij φij polar azimuthal angle relative position rij spherical coordinate major remaining diﬀerence angular nents descriptor soap one ref 40 radial function latter also depends l diﬀerent radial expansion scheme wa adopted connection diﬀerent atom environment scriptors revealed recently 33 41 multicomponent system omitted atom specie discussion multicomponent system feasible method constructing descriptor multiply term eq 12 weighting factor zj multiply term eq 13 weighting factor zjzk 42 zj atomic number atom j although weighting factor 43 also used method ha adopted package 39 descriptor mented therein based deﬁnition gn rij eq 14 lead modiﬁcation cutoﬀfunction fc rij rij zj use following modiﬁed deﬁnition fc rij rij p zizj 19 ﬁrst change factor zj p zj make relative weight le important system diﬀerent atomic number add information central atom distinguish two tions environment diﬀerent central atom specie indistinguishable previous approach 42 43 descriptor site energy stated ml potential site energy taken function set descriptor ponents qi nl ui ui qi nl 20 scalar function diﬀerent ml model used construct function including neural network 6 gaussian sion 7 linear regression 8 nep choose feedforward neural network also called multilayer ceptron ml model neural network model previous work 6 31 descriptor vector taken input layer neural network site energy taken output layer one hidden layer neuron node simplicity assume single hidden layer ing presentation generalization hidden layer straightforward descriptor vector input layer coupled ﬁrst hidden layer facilitate presentation combine two label n l single one ν nl write descriptor vector atom qi ν 1 state hidden layer also represented vector xµ 1 nneu number neuron hidden layer hidden layer state vector obtained input vector combination linear nonlinear transforms xµ tanh ndes x w 1 µν qi ν 1 µ 21 w 1 µν connection weight neuron xµ qi ν b 1 µ bias neuron xµ choose hyperbolic tangent function nonlinear transform also called activation function den layer agreement previous work 19 31 output layer state site energy calculated linear combination state vector hidden layer ui nneu x w 2 µ xµ 2 22 w 2 µ connection weight neuron ui xµ b 2 bias neuron ui 5 explicit expression partial force present explicit expression tial force deﬁned sec ii x n x l nl nl 23 factor nl calculated based eq 21 22 factor calculated based descriptor expression radial component n rij rij rij 24 angular component nl 2 x rij gn rik rij rij pl co θijk 2 x gn rij gn rik co θijk θijk 1 rij rik rij co θijk 25 training machine learning potential deﬁning loss function purpose training determine set weight bias neural network minimizes loss function loss function quantiﬁes error calculated quantity energy force virial ml potential training set usually prepared using quantum mechanical calculation denote set parameter neural network vector z whose dimension total number eters npar neural network single hidden layer npar ndes 2 nneu 1 26 number usually thousand example studied work formally express loss function function neural network parameter l l z 27 express training process mization problem min l z 28 optimal set parameter note used boldface represent abstract vector italic boldface represent cartesian vector loss function consists weighted sum part formulation energy force virial conveniently calculated thus deﬁne loss tions written le z lf z lv z respectively addition consider loss function serve regularization term denoted z z corresponding regularization respectively total loss function deﬁned weighted sum individual loss function l z λele z z z z z 29 energy loss function deﬁned following root mean square error rmse le z 1 nstr nstr x nep n z tar n 30 nstr total number structure ing dataset u tar n target energy nth ture u nep n z corresponding energy lated using nep potential parameter similarly force loss function deﬁned ing rmse lf z 1 n x nep z tar 31 n total number atom training dataset f tar f nep z target force ith atom calculated nep potential parameter z respectively lastly virial loss function deﬁned following rmse lv z 1 nstr x x µν nep µν n z tar µν n 32 w tar µν n w nep µν n z target µν virial tensor component nth structure lated nep potential respectively regularization loss function construct based norm parameter vector z 1 npar npar x 33 z 1 npar npar x n 34 apply regularization neural network regularization help prevent encouraging weight parameter velop smaller absolute value case without ularization 6 value weight parameter eq 29 clearly depend unit relevant quantity using energy virial force ﬁnd λe λf λv 1 good choice weight parameter regularization term need tuned keep good balance encouraging small large separable natural evolution strategy training algorithm gradient descent based method standard one training neural work parameter use separable natural lution strategy algorithm 11 train neural network parameter principled approach evolutionary optimization following natural dient loss function update search distribution population solution considered blackbox optimizer suitable minimize complex loss function eq 29 workﬂow training algorithm follows initialization create initial search distribution solution space dimension npar mean vector standard deviation vector component random number evenly chosen ponents chosen constant loop ngen generation create population solution zk 1 npop based current note elementwise multiplication zk 35 npop population size rk set random number mean 0 variance note random number vector rk diﬀerent ferent individual solution population b evaluate loss function l zk individual solution zk population sort according loss function small large c update natural gradient npop x ukrk 36 npop x uk rk 37 uk set utility value used evolve population towards rection better individual solution plicit value uk see ref 44 update mean standard deviation search distribution exponential tion applied argument elementwise way ηm 38 2 39 ηm ηs understood learning rate respectively use suggested value 11 ηm 1 ηs 3 log npar p npar computer implementation implemented relevant calculation except generation training data gpumd package using compute uniﬁed device architecture cuda compiling gpumd one obtain three executables including nep gpumd phonon nep executable used train nep potential gpumd executable used run md simulation phonon executable used calculate some phonon property based harmonic lattice dynamic calculation done gpumd package without external dence moreover window linux operating system supported prerequisite using gpumd package include only gpu suitable cuda toolkit suitable compiler nep potential no complicated empirical potential 45 major ference diﬀerent number ting parameter therefore gpu implementation nep potential closely follows implementation tersoﬀpotential 13 importantly atom quantity closed form formulation make correspondence one atom one cuda thread eﬃcient parallelisation scheme system attain large degree parallelism well high arithmetic intensity vital ing high eﬃciency gpu computing small system not eﬃcient scheme due reduced degree parallelism system structure training dataset usually quite small order 100 atom combine individual structure single one implementation nep tial following strategy used gpuga package 46 empirical potential ﬁtting 7 iii performance evaluation section present case study ate performance nep implemented gpumd compared quip 15 package implement potential 7 30 mlip package 16 implement mtp potential 17 package 18 implement dp potential 19 20 good machine learning potential able account nearly phase given material demonstrated elementary silicon 47 ru 48 carbon 49 50 consider ﬁtting potential silicon addition consider ﬁtting speciﬁc potential silicene speciﬁc potential bulk pbte training datasets performed quantum mechanical density functional theory dft calculation prepare training data using vasp 51 bulk pbte quantum espresso 52 silicene potential silicon used training data ref input output nep executable within gpumd package openly available zenodo 53 training dataset silicon training dataset silicon ref 47 consists 2475 structure including lated atom providing reference energy various dimensional solid structure sp bonded structure liquid structure amorphous structure mond structure surface diamond structure vacancy some defective structure every structure ha energy not structure virial data detail dft calculation reader referred ref 47 training dataset silicene training set silicene consists 914 gular cell 60 atom obtained via active learning scheme implemented mlip package 16 considered state temperature ranging 100 k 900 k biaxial strain ranging 1 state active learning iteration wa terminated no conﬁgurations selected using criterion γselect 2 16 6 independent 10 p md simulation mtp potential static dft calculation performed obtain curate energy force virial data purpose used pbe functional 54 optimized conserving vanderbilt pseudopotential 55 kinetic ergy cutoﬀof 40 ry wavefunctions mesh threshold ry electronic consistent loop training dataset bulk pbte training set bulk pbte consists 325 triclinic cell 250 atom obtained 305 cell using simulation temperature ranging 300 k 900 also added 20 cell small dom atom displacement generated using hiphive package 56 sample phase space pbte static dft calculation performed tain accurate energy force data using pbe tional 54 energy cutoﬀof 400 ev projector augmented wave 57 58 1 1 1 mesh threshold ev electronic loop virial data not used pbte training set ha used train potential pbte 59 hyperparameters machine learning potential number hyperparameters list tunable ters used nep potential table mtp potential present relevant input appendix dp potential relevant hyperparameters used described appendix table tunable hyperparameters used nep tential three material rr c ra c cutoﬀ radius radial angular component descriptor nr max na max chebyshev polynomial expansion order radial angular component lmax legendre nomial expansion order angular component nneu number neuron hidden layer neural work regularization parameter npop population size natural evolution strategy rithm ngen maximum number generation evolved parameter general si silicene pbte rr c 5 8 ra c 5 4 nr max 15 12 12 na max 15 12 6 lmax 4 4 4 nneu 50 40 40 npop 50 50 50 ngen 2 105 2 105 2 105 general silicon silicene mainly covalent bonding ﬁnd not beneﬁcial use diﬀerent 8 102 103 104 105 generation 100 loss function total energy force virial fig evolution loss function ing process total energy force virial correspond eq 29 eq 33 eq 34 eq 30 eq 31 eq 32 respectively training set general silicon system 47 used rameters presented table rr c ra c accordingly nr max na max chosen however pbte ionic crystal relatively coulomb interaction ﬁnd beneﬁcial use larger rr c nr max radial component descriptor use smaller ra c na max angular component reduce computational cost given target accuracy material only use single hidden layer 40 50 neuron neural network ﬁcient based test note deep neural network potential 18 19 usually requires using deep neural network several hidden layer large number neuron relatively simple general atom environment descriptor wa used deep neural network potential 18 19 requires use deep neural network lish connection simple descriptor energy atom regularization parameter ﬁnd good default choice remaining two parameter npop ngen only relevant training process computation time training process proportional product dimension descriptor ndes ing set calculated according eq 16 80 65 41 general silicon silicence bulk pbte respectively therefore structure ral network training set denoted respectively number ﬁtting parameter npar neural network respectively 4101 2681 1721 according eq 26 figure 2 show evolution various loss tions respect generation case eral silicon increasing generation rmses energy force virial reduced converged though some oscillation beginning trast loss function regularization hence magnitude weight bias parameter neural network ﬁrst increase decrease indicating eﬀectiveness regularization regularization setting zero small value weight bias parameter neural network would increase wildly ily lead explicit example demonstrated appendix note training process stable pendent run diﬀerent set random number lead comparable result small variation strongly suggests natural evolution strategy used ﬁnd good minimum loss function set globally optimized neural network parameter evaluation accuracy table ii accuracy comparison nep mtp dp energy virial rmses unit force rmse unit material rmse gap mtp dp nep silicene energy force 65 50 65 56 virial 14 10 pbte energy force 50 52 53 50 figure 3 compare predicted energy force virial value nep quantum cal dft calculation general silicon training set 47 agreement nep dft ably good based data calculate rmses given panel c reference 47 not provide rmse value instead cumulative probability force component error dft calculation wa provided therefore compare quantity nep fig 3 seen nep slightly le accurate figure 3 also show dp force rmse 165 le accurate nep force rmse 107 case similarly calculated rmses silicene bulk pbte value listed table ii bee seen potential comparable accuracy given ml potential not always accurate another one accuracy potential determined 9 fig 3 energy b force c virial calculated nep potential compared training data quantum mechanical dft calculation solid line c represent identity function used guide eye cumulative probability function force component error nep solid line dashed line dp dotted line cumulative probability lute dft force component line shown reference many tunable hyperparameters hyperpameters aﬀect not only accuracy also computational eﬃciency important issue discus next evaluation computational eﬃciency computational speed fig 4 compare computational speed four ml potential md simulation tional speed measured product number atom number md step divided putation time unit per second measure speed used simulation cell 8 103 bulk silicon pbte 6 103 silicene atom run md simulation 100 step nvt ensemble outputting basic thermodynamic quantity every 10 step quip 15 mlip 16 18 package built library called lammps package 26 mtp potential mented cpu only used 72 intel 6240 cpu core two node 36 core allelized message passing interface mpi note potential achieves high 2000 18000 5000 100000 48000 870000 520000 4500000 13000000 11000000 silicon silicene pbte 104 106 108 speed per second gap 72 intel 6240 cpu core mtp 72 intel 6240 cpu core dp one nvidia tesla gpu nep one nvidia tesla gpu fig computational speed nep potential running nvidia tesla gpu compared dp potential running gpu mtp potential running 72 intel 6240 cpu core model compression nique 60 applied dp potential speed calculation racy general silicon ha low computational speed reference 47 used nmax 10 lmax 12 soap descriptor together 9 103 basis function gaussian process regression using smaller ues parameter increase computational speed reduce accuracy comparable racy mtp one order magnitude faster ha reported 17 nep potential implemented gpu only used nvidia tesla gpu card formance test note cpu gpu resource comparable price computational speed gpumd 107 per second only one order magnitude lower computational speed eﬃcient empirical potential tersoﬀpotential implemented gpumd achieve computational speed gpumd one gpu one need run quip least ten thousand cpu core run mlip least thousand cpu core even assuming ideal mpi scaling package 18 ha cpu gpu version used latter gpu used recent model compression technique 60 troduced dp potential speed tions fig 4 see nep implemented gpumd one order magnitude faster dp implemented using 10 putational resource memory consumption apart high computational speed mentation nep gpumd also memory eﬃcient major memory consumption nep potential follows three neighbor list diﬀerent cutoﬀradius use multiple level neighbor list save computation require byte partial force atom pair within cutoﬀradius require byte some intermediate result related descriptor require byte n number atom estimated upper bound ber neighbor atom ever given application assuming typical value 100 total amount memory listed le six gabytes system therefore using single gpu 32 gigabyte device memory one simulate system million atom using nep potential gpumd iv heat transport application md simulation ml potential applied study heat transport property number terials including gete mnge compound 64 diamond amorphous silicon multilayer graphene 68 monolayer silicene 69 70 layer alloy 71 72 73 74 75 59 pbte 59 snse 76 also work exclusively used boaltzmann transport equation bte approach calculate thermal conductivity based force constant determined ml potential section use silicene bulk pbte example demonstrate applicability nep heat transport calculation calculate lattice thermal conductivity using hnemd method related spectral decomposition method 29 implemented gpumd reviewed sec ii simulation cell silicene bulk pbte contain 6000 8000 atom respectively large enough eliminate eﬀects icene performed 10 independent run 50 p equilibration stage npt ensemble get pressure zero 1000 p production stage external driving force pbte performed 3 independent run 100 p equilibration stage nvt ensemble 2000 p production stage external driving force integration time step f silicene f pbte consider temperature 300 k silicene temperature range 300 700 k pbte 0 5 10 15 0 2 4 6 8 10 acoustic optical thz κ ω total nep 0 10 20 30 40 bte interval κ b fig 5 spectral lattice thermal conductivity icene 300 k calculated using nep potential solid line average 10 independent run dashed line resent error bound vertical dashed line separate acoustic optical phonon frequency b lattice mal conductivity silicene 300 k calculated using md simulation nep potential md simulation potential 69 md simulation two sion potential 83 area two horizontal line represents range value dicted calculation thermal transport silicene figure 5 show spectral lattice thermal ductivity silicene phonons also called ﬂexural phonons according spatial decomposition 24 material phonons only nonzero lattice thermal ductivity acoustic branch phonons nonzero lattice thermal conductivity acoustic optical branch total tice thermal conductivity mainly contributed acoustic phonons summing various component fig 5 obtain total lattice thermal conductivity value consistent calculated 69 using potential shown fig 5 b lattice thermal conductivity value also well within range previous dft calculation contrast lattice thermal conductivity value md simulation 83 using two version called potential 88 optimized silicene 89 well range underestimation lattice thermal 11 0 5 10 15 ν thz nep γ k γ 0 5 10 15 ν thz b γ k γ fig phonon dispersion silicene comparison nep dashed line dft solid line tions b comparison dashed line dashed line dft solid line calculation result ref conductivity potential partially understood examining phonon sion shown fig version weber potential signiﬁcantly underestimate cies hence group velocity phonons around γ point compared dft result hand phonon dispersion nep tential agree well dft result thermal transport bulk pbte similarly calculated thermal conductivity pbte 300 700 k result shown fig prediction nep agree well mental data 91 92 bte calculation force stants dft 90 potential 59 considering ings also produce comparable result however only scattering considered bte culations 90 obtained lattice thermal ity value two time large indicates importance scattering pbte some material ha gested perturbation theory adopted bte approach severely underestimate phonon scattering even scattering included 300 400 500 600 700 0 1 2 3 4 5 6 fig lattice thermal conductivity bulk pbte tion temperature hnemd simulation nep potential bte calculation tential considering terings 59 calculation considering phonon scattering only scattering 90 experiment 91 92 59 phonon anharmonicity fully taken account md simulation expect eﬃcient nep potential serve promising tool gating heat transport property material strong phonon anharmonicity thermal transport amorphous silicon nep potential also applied study heat transport material strong spatial disorder show considering amorphous silicon using general silicon nep potential ﬁtted ate structure follow md simulation col described ref nep potential much eﬃcient potential use simulation cell 64000 atom instead 64 atom used ref structural property process ating shown fig radial distribution function g r angular distribution function p θ liquid 2000 k amorphous 500 k state nep agree well dft gap result ensures sample constructed sonable structural property figure 9 show calculated phonon density state pdos function tral lattice thermal conductivity relation function 300 k zero pressure 12 fig 8 radial b angular distribution function liquid silicon 2000 k c radial angular distribution function 500 k dft gap result ref gap result ref vertical solid line represents bond angle diamond structure aged ﬁve sample although phonons large contribution pdos thermal conductivity still mainly contributed frequency phonons similar case crystalline silicene total lattice thermal conductivity sample calculated classical md simulation although far no universally applicable quantum correction method classical md simulation phonon thermal transport perfect crystal feasible one disordered material multiply factor classical tral thermal conductivity κµν ω obtain following spectral thermal conductivity κq µν ω κµν ω ex 2 40 x h kb reduced planck constant boltzmann constant tively spectral thermal tivity also shown fig see 300 k quantum eﬀects minor only reduce total thermal conductivity however note quantum eﬀects strong low temperature result agree well ous study using potential 66 dp potential 67 systematical study ing diﬀerent temperature strain stress cell size quenching rate beyond scope paper 0 5 10 15 0 0 5 10 15 0 b classical quantum fig 9 pdos b spectral thermal conductivity si 300 k zero pressure b solid line represents result classical md simulation dashed line represents result see text detail summary conclusion summary presented nep framework generating neural network based ml potential using separable natural evolutionary strategy algorithm descriptor based chebyshev legendre polynomial nep potential achieve accuracy comparable ml potential mtp dp gpu plementation attains high computational eﬃciency term computation time memory usage computation time nep potential order microsecond per atom per md step using single nvidia gpu one use amount source simulate system million atom combining hnemd related tral decomposition method work make possible eﬃciently accurately simulate heat transport various material based training data only expect nep approach ticularly useful modeling heat transport property material strong phonon anharmonicity 13 tial disorder usually not accurately treated either traditional empirical potential perturbative bte method acknowledgment zf acknowledges support national ral science foundation china nsfc no 11974059 zz yc grateful research computing cilities oﬀered hku yw hd knowledge support academy finland centre excellence program qtf project 312298 computational resource provided aalto project finland center science csc appendix chebyshev polynomial used nep chebyshev polynomial ﬁrst kind ﬁned term initial value x 1 x x recurrence relation n tn x x x derivative dtn x related chebyshev polynomial second kind x n 0 dtn x dx x chebyshev polynomial second kind ﬁned term initial value x 1 x recurrence relation n un x x x appendix b input training mtp gap potential appendix give input used training mtp gap potential input training mtp potential silicene mtp version 1 rbchebyshev 1 8 5 1352 295 input training mtp potential bulk pbte mtp version 2 rbchebyshev 8 718 201 input training gap potential silicene soap 0 input training gap potential bulk pbte 0 soap 14 appendix c hyperparameters used dp potential dp potential trained smooth edition 20 general silicon silicene bulk pbte using package 18 cutoﬀdistance 5 general silicon silicene 6 pbte number training step 4 106 eral silicon 106 silicene pbte common hyperparameters used material smoothing parameter 2 size ding net 25 50 100 size ﬁtting net 240 240 240 learning rate stochastic ent descent algorithm decrease exponentially weighting parameter energy force virial exists starting value 1000 1 respectively linearly changed 1 training process maximum number neighbor estimated default 1 used appendix eﬀects regularization use case silicene demonstrate fects regularization ﬁrst train nep tial 714 structure training set make prediction another 200 structure testing set testing set contains structure pressure temperature not covered training set therefore evaluating trained nep potential testing set involves interpolation lation serf good purpose detecting possible figure 10 show absolute neural network eters nep potential three level ization 0 no regularization proper regularization strong ularization see average magnitude parameter decrease increasing level tion quantitatively mean absolute value parameter 12 respectively three regularization level figure 10 b clearly show potential trained without regularization ha large error predicted force hand potential trained strong regularization also ha niﬁcant error predicted force contrast potential trained proper regularization ha est accuracy testing set showing capability interpolating even extrapolating some extent 1 org behler perspective machine ing potential atomistic simulation journal chemical physic 145 170901 2016 2 volker deringer miguel caro abor anyi machine learning interatomic tials emerging tool material science advanced material 31 1902765 2019 3 tim mueller alberto hernandez chuhong wang machine learning interatomic potential model journal chemical physic 152 050902 2020 4 mishin interatomic potential material science acta materialia 214 116980 2021 5 oliver unke stefan chmiela huziel sauceda michael gastegger igor poltavsky kristof utt alexandre tkatchenko robert uller machine learning force ﬁelds chemical review 0 null 0 6 org behler michele parrinello generalized network representation energy surface phys rev lett 98 146401 2007 7 albert ok mike payne risi kondor abor anyi gaussian approximation potential accuracy quantum mechanic without trons phys rev lett 104 136403 2010 8 thompson swiler trott foiles tucker spectral bor analysis method automated generation interatomic potential journal computational physic 285 2015 9 xin yao evolving artiﬁcial neural network proceeding ieee 87 1999 10 daan wierstra tom schaul tobias machers yi sun jan peter urgen schmidhuber natural evolution strategy journal machine learning research 15 2014 11 tom schaul tobias glasmachers urgen schmidhuber high dimension heavy tail natural evolution strategy proceeding annual conference genetic evolution gecco 11 association computing machinery new york ny usa 2011 pp 12 zheyong fan topi siro ari harju accelerated molecular dynamic force evaluation graphic cessing unit thermal conductivity calculation computer physic communication 184 1414 1425 2013 13 zheyong fan wei chen ville vierimaa ari harju eﬃcient molecular dynamic simulation potential graphic processing unit computer physic communication 218 10 16 2017 14 zheyong fan alex gabourie 2020 15 16 ivan novikov konstantin gubaev evgeny v podryabinkin alexander v shapeev mlip package moment tensor tentials mpi active learning 15 fig 10 absolute value 2681 neural network parameter nep potential silicene trained diﬀerent level regularization b corresponding dicted force versus dft reference value machine learning science technology 2 025002 2021 17 alexander shapeev moment sor potential class cally improvable interatomic potential multiscale modeling simulation 14 2016 18 han wang linfeng zhang jiequn han weinan e deep ing package potential ergy representation molecular dynamic computer physic communication 228 2018 19 linfeng zhang jiequn han han wang roberto car weinan e deep potential molecular dynamic scalable model accuracy quantum ic phys rev lett 120 143001 2018 20 linfeng zhang jiequn han han wang wissam saidi roberto car weinan e symmetry preserving potential energy model ﬁnite extended system 2018 21 zheyong fan luiz felipe pereira wang zheng davide donadio ari harju force heat current formula body potential molecular dynamic simulation application thermal conductivity calculation phys rev b 92 094301 2015 22 alexander gabourie zheyong fan tapio eric pop spectral decomposition thermal ductivity comparing velocity decomposition od homogeneous molecular dynamic simulation phys rev b 103 205421 2021 23 maxime laurent lewis heat conductivity graphene related material modal analysis phys rev b 92 195404 2015 24 zheyong fan luiz felipe pereira petri hirvonen mikko ervasti ken elder davide donadio tapio ari harju thermal conductivity composition material application graphene phys rev b 95 144309 2017 25 ke xu zheyong fan jicheng zhang ning wei tapio thermal port property black phosphorus extensive molecular dynamic simulation modelling simulation material science engineering 26 0 26 steve plimpton fast parallel algorithm molecular dynamic journal computational physic 117 1 19 1995 27 donatas surblys hiroki matsubara gota gawa taku ohara application atomic stress compute heat ﬂux via molecular namics system interaction phys rev e 99 051301 2019 28 paul boone hasan babaei pher wilmer heat flux body interaction correction lammps journal chemical theory computation 15 2019 29 zheyong fan haikuan dong ari harju tapio homogeneous nonequilibrium lar dynamic method heat transport tral decomposition potential phys rev b 99 064308 2019 30 albert ok risi kondor abor anyi representing chemical environment phys rev b 87 184115 2013 31 jorg behler try function constructing dimensional neural network potential journal chemical physic 134 074106 2011 32 matthias rupp alexandre tkatchenko robert uller anatole von lilienfeld fast accurate modeling molecular omization energy machine learning phys rev lett 108 058301 2012 33 ralf drautz atomic cluster expansion curate transferable interatomic potential phys rev b 99 014104 2019 34 yaolong zhang ce hu bin jiang embedded atom neural network potential eﬃcient accurate chine learning physically inspired representation journal physical chemistry letter 10 2019 35 zaverkin astner gaussian moment physically inspired molecular descriptor accurate scalable machine learning potential journal chemical theory computation 16 2020 16 36 van der oord dusson anyi ortner regularised atomic ordered polynomial construction interatomic potential machine learning science technology 1 015004 2020 37 alireza khorshidi andrew son amp modular approach chine learning atomistic simulation computer physic communication 207 2016 38 lauri himanen marc ager eiaki rooka filippo federici canova yashasvi ranawat david gao patrick rinke adam foster dscribe library tor machine learning material science computer physic communication 247 106949 2020 39 howard yanxon david zagaceta binh tang david matteson qiang zhu pyxtal ff python library automated force ﬁeld generation machine learning science technology 2 027001 2021 40 miguel caro optimizing atomic scriptors enhanced computational performance machine learning based interatomic potential phys rev b 100 024112 2019 41 michael willatt elix musil michele ceriotti representation machine learning journal chemical physic 150 154110 2019 42 gastegger schwiedrzik bittermann berzsenyi marquetand weighted symmetry function descriptor machine learning potential journal chemical physic 148 241709 2018 43 nongnuch artrith alexander urban gerbrand ceder eﬃcient accurate polation atomic energy composition many specie phys rev b 96 014112 2017 44 tobias glasmachers tom schaul sun yi daan wierstra urgen schmidhuber exponential natural evolution strategy proceeding annual conference genetic evolutionary computation gecco 10 association computing machinery new york ny usa 2010 45 tersoﬀ modeling chemistry teratomic potential multicomponent system phys rev b 39 1989 46 zheyong fan yanzhou wang xiaokun gu ping qian yanjing su tapio minimal tersoﬀpotential diamond silicon improved description elastic phonon transport property journal physic condensed matter 32 135901 2019 47 albert ok james kermode noam stein abor anyi machine learning interatomic potential silicon phys rev x 8 041048 2018 48 volker deringer miguel caro abor anyi force ﬁeld bulk nanostructured phosphorus nature communication 11 5461 2020 49 patrick rowe volker deringer piero gasparotto abor anyi angelos michaelides accurate transferable machine learning potential carbon journal chemical physic 153 034702 2020 50 heikki muhli xi chen albert ok cia abor anyi tapio miguel caro machine learning force ﬁelds based local parametrization dispersion tions application phase diagram phys rev b 104 054106 2021 51 kresse uller eﬃcient iterative scheme ab initio calculation using basis set phys rev b 54 1996 52 paolo giannozzi stefano baroni nicola bonini teo calandra roberto car carlo cavazzoni davide ceresoli guido l chiarotti matteo cococcioni maila dabo andrea dal corso stefano de gironcoli stefano fabris guido fratesi ralph gebauer uwe gerstmann christos gougoussis anton kokalj michele lazzeri layla nicola marzari francesco mauri riccardo mazzarello stefano paolini alfredo pasquarello lorenzo paulatto carlo sbraccia sandro scandolo gabriele sclauzero ari p seitsonen alexander smogunov paolo umari renata wentzcovitch quantum espresso modular software project quantum simulation material journal physic condensed matter 21 395502 2009 53 zheyong fan input output nep gpumd 2021 54 john perdew kieron burke matthias hof generalized gradient approximation made ple phys rev lett 77 1996 55 martin schlipf cois gygi optimization rithm generation oncv pseudopotentials computer physic communication 196 2015 56 fredrik eriksson erik fransson paul hart hiphive package extraction force constant machine learning advanced theory simulation 2 1800184 2019 57 ochl projector method phys rev b 50 1994 58 kresse joubert ultrasoft tentials projector method phys rev b 59 1999 59 zezhu zeng cunzhi zhang yi xia zheyong fan chris wolverton yue chen nonperturbative phonon scattering thermal transport phys rev b 103 224307 2021 60 denghui lu wanrun jiang yixiao chen linfeng zhang weile jia han wang mohan chen dp train dp compress model sion deep potential molecular dynamic 2021 61 gabriele sosso davide donadio sebastiano caravati org behler marco bernasconi thermal transport material atomistic simulation phys rev b 86 104301 2012 62 davide campi davide donadio gabriele sosso org behler marco bernasconi action thermal boundary resistance amorphous interface phase change compound gete journal applied physic 117 015304 2015 63 e bosoni campi donadio g c sosso j behler bernasconi atomistic lations thermal conductivity gete nanowires journal physic applied physic 53 054001 2019 64 claudia mangold shunda chen giuseppe nardo org behler pascal pochet konstantinos mentzidis yang han laurent chaput david lacroix davide donadio transferability neural work potential varying stoichiometry phonons 17 thermal conductivity mnxgey compound journal applied physic 127 244901 2020 65 yufeng huang jun kang william goddard wang density functional theory based ral network force ﬁelds energy decomposition phys rev b 99 064103 2019 66 qian peng li wei yang mal conductivity modeling using machine learning tials application crystalline amorphous silicon material today physic 10 100140 2019 67 li lee luo uniﬁed deep neural network potential capable predicting mal conductivity silicon diﬀerent phase material today physic 12 100181 2020 68 mingjian wen ellad tadmor hybrid ral network potential multilayer graphene phys rev b 100 195419 2019 69 cunzhi zhang qiang sun gaussian approximation potential studying thermal conductivity icene journal applied physic 126 105103 2019 70 pavel korotaev ivan novoselov aleksey yanilkin alexander shapeev accessing thermal conductivity complex compound machine learning interatomic tentials phys rev b 100 144308 2019 71 xiaokun gu zhao thermal ductivity alloy molecular dynamic simulation interatomic potential computational material science 165 2019 72 bohayra mortazavi evgeny v podryabinkin ivan novikov stephan roche timon rabczuk ing zhuang alexander v shapeev eﬃcient based interatomic potentialsfor ing thermal conductivity material journal physic material 3 2020 73 kohei shimamura yusuke takeshita shogo fukushima akihide koura fuyuki shimojo tional training requirement interatomic tential based artiﬁcial neural network ing low thermal conductivity silver chalcogenides journal chemical physic 153 234301 2020 74 kohei shimamura yusuke takeshita shogo fukushima akihide koura fuyuki shimojo estimating thermal conductivity ing ann potential chebyshev descriptor chemical physic letter 778 138748 2021 75 ruiyang li zeyu liu andrew rohskopf kiarash gordiz asegun henry eungkyu lee tengfei luo deep neural network interatomic tial studying thermal conductivity applied physic letter 117 152102 2020 76 huan liu xin qian hua bao changying zhao xiaokun gu phonon transport erties snse interatomic tial journal physic condensed matter 2021 77 emi minamitani masayoshi ogura satoshi abe simulating lattice thermal conductivity ducting material using neural network potential applied physic express 12 095001 2019 78 hasan babaei ruiqiang guo amirreza hashemi sangyeop lee atomic potential phonon transport perfect crystalline si crystalline si vacancy phys rev material 3 074603 2019 79 alejandro rodriguez yinqiao liu ming hu spatial density neural network force ﬁelds principle level accuracy application thermal transport phys rev b 102 035203 2020 80 janine george geoﬀroy hautier albert ok abor anyi volker deringer bining phonon accuracy high ity gaussian approximation potential model journal chemical physic 153 044104 2020 81 liu yang xin hua liu abor anyi cao chine learning interatomic potential developed ular simulation thermal property journal chemical physic 153 144501 2020 82 bohayra mortazavi evgeny podryabinkin ivan novikov timon rabczuk xiaoying zhuang alexander shapeev accelerating estimation thermal conductivity interatomic potential solution computer physic communication 258 107583 2021 83 haikuan dong zheyong fan libin shi ari harju tapio equivalence equilibrium nonequilibrium molecular dynamic method thermal conductivity calculation bulk nanowire silicon physical review b 97 094305 2018 84 xiaokun gu ronggui yang prediction phononic thermal conductivity silicene comparison graphene journal applied physic 117 025102 2015 85 kuang lindsay shi zheng tensile strain give rise strong size eﬀects mal conductivity silicene germanene stanene nanoscale 8 2016 86 han xie tao ouyang eric germaneau guangzhao qin ming hu hua bao large tunability lattice thermal conductivity monolayer silicene via cal strain phys rev b 93 075404 2016 87 bo peng hao zhang hezhu shao yuanfeng xu gang ni rongjun zhang heyuan zhu phonon transport property material ab initio calculation phys rev b 94 245420 2016 88 frank stillinger thomas weber computer simulation local order condensed phase silicon phys rev b 31 1985 89 xiaoliang zhang han xie ming hu hua bao shengying yue guangzhao qin gang su thermal conductivity silicene calculated ing optimized potential phys rev b 89 054310 2014 90 yi xia revisiting lattice thermal transport pbte crucial role quartic anharmonicity applied physic letter 113 073901 2018 91 fedorov machuev thermal conductivity pbte snte gete solid liquid phase sov phys solid state ussr 11 1116 1969 92 abou kenawy hillal mophysical property polycrystalline pb pbse pbte temperature range k international journal thermophysics 4 1983 93 volker deringer noam bernstein albert ok matthew cliﬀe rachel kerber lauren 18 bella clare grey stephen elliott abor anyi realistic atomistic structure amorphous con molecular dynamic journal physical chemistry letter 9 2018 94 wei lv asegun henry direct tion modal contribution thermal ductivity via modal analysis new journal physic 18 013028 2016 95 askilahti oksanen tulkki mcgaughey volz vibrational mean free path thermal conductivity amorphous silicon molecular dynamic simulation aip advance 6 121904 2016 96 zheyong fan petri hirvonen luiz felipe pereira mikko ervasti ken elder davide donadio ari harju tapio bimodal size scaling thermal transport polycrystalline graphene molecular dynamic lations nano letter 17 2017