review cite article kashinath k etal 2021 machine learning case study weather climate modelling 379 accepted 24 november 2020 one contribution 13 theme issue machine learning weather climate modelling subject area artificial intelligence computational physic atmospheric science fluid mechanic keywords neural network physical constraint turbulent flow machine learning weather climate modeling author correspondence karthik kashinath kkashinath machine learning case study weather climate modelling lawrence berkeley national lab berkeley ca usa berkeley ca usa pasadena ca usa california berkeley ca usa university stanford ca usa university west lafayette usa san diego la jolla ca usa university houston tx usa wegener institute bremerhaven germany university boston usa tech blacksburg va usa santa clara california usa kk bw machine learning ml provides novel powerful way accurately efﬁciently recognizing complex pattern emulating nonlinear dynamic predicting evolution weather climate process ml model however not necessarily obey fundamental governing law physical system generalize well scenario not trained survey systematic approach incorporating physic domain knowledge ml model distill approach broad category 10 case study show approach used successfully 2021 author published royal society right reserved downloaded 28 march 2024 2 phil trans 379 20200093 emulating downscaling forecasting weather climate process accomplishment study include greater physical consistency reduced training time improved data efﬁciency better generalization finally synthesize lesson learned identify scientiﬁc diagnostic computational resource challenge developing truly robust reliable ml model weather climate process article part theme issue machine learning weather climate modelling introduction machine learning ml deep learning dl making signiﬁcant inroad science provide powerful method analysing complex data extracting nonlinear relationship within massive datasets building predictive model even enabling novel scientiﬁc discovery nearly impossible traditional statistical method nutshell three key force contributed unprecedented success ml dl 3 access vast quantity data ii advance computational algorithm iii exponential increase computational horsepower accordance moore law numerical simulation including weather climate modelling application requiring extensive customized engineering encoding governing equation domain knowledge 6 key differentiator ml dl model learn complex task vast quantity data signiﬁcantly computationally efﬁcient sometimes billion time faster 7 characteristic ml dl enable breakthrough across many scientiﬁc application henceforth simplicity use ml refer ml dl subset ml ml ha many promising strength advantage physical modelling traditional statistical approach also several challenge making trustworthy robust wide range scientiﬁc application reliably adopted one foremost challenge ml doe not always obey underlying physical principle system applied 6 ml model capable learning underlying relationship exist data not consistently respect principle prediction especially used situation not trained not generalize well new scenario additionally ml requires copious data train model larger capacity generalize better 10 address pressing challenge researcher attempted develop novel effective strategy incorporate domain knowledge physical principle ml model ha resulted emergence ﬁeld machine learning piml also referred machine learning kgml karpatne et al 11 willard et al 12 broadly survey research work ﬁeld applies across science contrast article focus work pertains weather climate modelling machine learning objective approach application objective machine learning incorporating physical principle governing law domain knowledge ml model rapidly growing ﬁeld piml seek build physically consistent scientiﬁcally sound predictive model increase data efﬁciency train model fewer data point accelerate training process help model converge faster optimal solution improve generalizability model make reliable prediction unseen scenario including applicability system changing climate enhance transparency interpretability make model trustworthy downloaded 28 march 2024 3 phil trans 379 20200093 b ten key approach incorporate physic ml researcher weather climate science used many way incorporate physic domain knowledge ml model some approach draw idea applied mathematics dynamical system ﬂuid dynamic community way incorporate physic domain knowledge include direct approach enforcing conservation law indirect approach using domain expertise design model better suited physical process modelled method incorporate physic domain knowledge broadly categorized 10 approach described listed approximate descending order pervasiveness incorporating one element model strengthens ability achieve piml objective listed interpretability uncertainty quantiﬁcation uq listed last not way incorporate physic apply piml model loss regularization custom loss function also referred regularization help prevent ﬁtting solve problem training ml model use loss function optimization process typically deﬁned simply error mse square error rmse loss ground truth prediction one simplest widely used way incorporate physic via regularization loss function augmented additional term relative weight based loss adjustable approach sometimes referred imposing soft constraint contrasted imposing hard constraint using customized loss function piml model ha employed karpatne et al 13 modelling lake temperature beucler et al 14 penalize violation conservation law raissi et al 15 developing neural network nn solve nonlinear partial differential equation pde ﬂuid dynamic quantum mechanic system nonlinear wave dynamic zhu et al 16 surrogate modelling transient pdes turbulent ﬂows approach effective unconstrained ml model however imposed soft constraint not required strictly satisﬁed relative importance standard mse loss tunable no generalizability guarantee ii neural network architecture enforce physical constraint nn architecture powerful approach incorporating physic constraint strictly enforced including new scenario 19 modularity nns offer opportunity design novel neuron layer block encode enforce speciﬁc physical property beucler et al 14 designed conservation layer strictly enforce conservation law nn emulator atmospheric convection mohan et al 20 guaranteed continuity mass conservation nns turbulence encoding curl operator jiang et al 21 designed pde layer strictly enforce pde constraint turbulence daw et al 22 modiﬁed long memory lstm model architecture introduce intermediate variable strictly preserve monotonicity nn model lake temperature key advantage nn architecture used impose hard constraint guaranteed satisﬁed compared soft constraint described hence generalizable iii symmetry invariance equivariances embedding symmetry invariance equivariances ml model powerful way encode physical property also achieve substantially simpler model reduced data requirement higher prediction accuracy symmetry invariance equivariances represent geometric property dynamic physical system noether downloaded 28 march 2024 4 phil trans 379 20200093 theorem establish correspondence conserved quantity pdes group symmetry example rotational symmetry corresponds conservation angular momentum thomas et al 26 embedded equivariances via tensor ﬁeld network improve robustness generalization nns application physic chemistry ling et al 27 used invariant tensor basis embed galilean invariance nn learn model reynolds stress anisotropy tensor turbulent ﬂows showed improved prediction accuracy compared generic nn not embed invariance property cohen et al 28 developed spherical convolutional nns cnn using rotation equivariance operate data spherical domain global weather climate data demonstrated computational efﬁciency numerical accuracy effectiveness jiang et al 29 extended unstructured grid using parametric differential operator develop efﬁcient compact network high accuracy climate pattern segmentation wang et al 30 incorporated symmetry translation rotation uniform motion scaling showed improved prediction time evolution oceanic ﬂows chattopadhyay et al 31 used equivariant spatial transformer network predict geophysical turbulence showed equivariance preserving property improves prediction accuracy beucler et al 32 used scaling relationship leveraging equation improve generalizability model convective parameterization effect result variable similar distribution climate thus changing hard extrapolation problem interpolation problem due exponential dependence humidity temperature iv stochasticity stochastic method essential accurately representing inherently chaotic turbulent nature weather climate system uncertainty process often absent weather climate model even initial condition known perfectly stochasticity needed impossible represent process function variable without error although pdes describe physical climate system deterministic important reason computational representation equation stochastic representation better respect scaling symmetry underlying pdes improve forecasting skill reduce systematic model error 33 representing process ensemble prediction instead single prediction accurate initial condition uncertain error initial condition exceed error model generates ensemble natural way model distribution incorporate stochasticity uncertainty ml probabilistic model bayesian nns generative model 34 krasnopolsky et al 35 use ensemble nns learn stochastic convection parameterizations climate numerical weather prediction model data simulated cloud resolving model recent work gagne et al 36 develops stochastic parameterization using generative adversarial network gan class deep generative model groenke et al 37 develop novel unsupervised statistical downscaling model using normalizing ﬂows type generative model allows conditional unconditional sampling joint distribution spatial ﬁelds v stability stable model essential least two piml application weather climate modelling instability tend develop grow time embedding piml emulator weather climate model ii piml model used forecasting ha drift lead unphysical behaviour stable piml model achieved careful design ml model careful consideration physic choosing appropriate input downloaded 28 march 2024 5 phil trans 379 20200093 output model furthermore using tool stability theory spectral theory shed light cause mode instability researcher devoted tremendous effort developing stable numerical model simulate dynamical system 38 designing stable piml model infancy 39 though several relevant example erichson et al 40 encode lyapunov stability autoencoder model predicting ﬂuid ﬂow sea surface temperature show improved generalizability reduced prediction uncertainty nns preserve lyapunov stability lusch et al 41 used dl discover physically interpretable universal linear embeddings nonlinear dynamic data powerful approach wa extended mamakoukas et al 42 imposing stability constraint model improve prediction nonlinear system long horizon climate modelling brenowitz et al 43 used stability theory identify cause condition instability ml parameterizations moist convection coupled atmospheric ﬂuid dynamic development bridge dl application atmospheric dynamic ott et al 44 identiﬁed strong relationship ofﬂine validation error online performance choice optimizer prof unexpectedly critical used hyperparameter search ﬁnd nn architecture produce considerable improvement stability including some reduced error rasp 45 proposed coupled learning approach pretrained nn parameterization run parallel simulation kept sync earth system model esm constant nudging approach attempt curb instability bias previously experienced embedding nn parameterizations esm yuval et al 46 achieved stable ml parameterizations convection using random forest recent work yuval et al 47 achieved stability nns using novel structure careful calculation subgrid term condition conserve mass energy exactly forecasting chattopadhyay et al 31 achieved stable forecast geophysical turbulence using novel spatial transformer architecture custom loss vi property spectral method weather climate complex system kolmogorov dissipation scale millimetre planetary scale thousand kilometre time scale second decade longer many nonlinear interaction across scale lead emergent behaviour ha long recognized important requirement developing accurate weather climate model ability characterize accurately nature system hour day variation play key role determining month year evolution system 48 spectral method provide novel way incorporating property weather climate system ml common mean representing scale distribution turbulent ﬁeld spectrum covariance function spectrum covariance function related fourier transform inverse wu et al 18 captured scale distribution correlation across scale gan model turbulent convection enforcing covariance constraint constraint also help preserve spectral property pdes underlying data mohan et al 49 used wavelet transform inject feature compact representation wavelet coefﬁcients predicting turbulent ﬂow li et al 50 developed new neural operator fourier space allowing expressive efﬁcient architecture solved equation three order magnitude faster compared traditional pde solver tancik et al 51 show fourier feature help nns learn frequency function domain thus overcoming spectral bias recent novel approach computer vision used spectral method coupled deep nns fourier cnns 52 specnet 53 could implication piml model development downloaded 28 march 2024 6 phil trans 379 20200093 vii coherence atmospheric oceanic variability characterized strong coherence across scale 54 coherent structure ubiquitous atmospheric ocean ﬂows considered hidden skeleton organize rest ﬂow ordered pattern modulate mixing transport energetics 55 furthermore important implication extreme event 56 addition capturing nature described accurately representing physic atmosphere ocean requires piml model capture coherence exists simulating system using governing equation naturally capture coherent structure atmospheric blocking tropical cyclone el oscillation although some ml model cnn use ﬁlters learn coherent spatial pattern no guarantee ml model capture underlying coherent structure present data obtained physical system xie et al 57 developed tempogan gan augmented additional discriminator network preserve temporal coherence ﬂuid ﬂow li et al 58 developed graph nns capture interaction nn solution pdes de bezenac et al 59 use warping scheme based equation preserve spatial coherence conjunction cnn predict evolution sea surface temperature recent development computer vision pattern recognition leveraged coherence 60 could implication piml model development viii modelling framework building upon existing framework model allows integrating understood scientiﬁcally sound model structure learned component although many powerful method based theoretical reasoning used develop weather climate model often simplifying assumption parameter need determined empirically ml offer novel approach replacing approximation empirical parameter learned counterpart maintaining original structure model example simulation le approach resolve ﬂow model impact sg turbulence function resolved ﬂow dynamic smagorinsky model 61 widely used model atmospheric oceanic turbulence closure model relies viscosity assumption only valid sufﬁcient scale separation recent work show ml model learn sg stress data without invoking assumption accurate faster numerical solution pdes use discretizations approximate representation often ad hoc et al 64 use ml learn discretizations based actual solution known underlying equation signiﬁcantly accurate faster existing method several researcher used ml estimating correcting error model especially forecasting data assimilation pathak et al 65 watson 66 used ml coupled dynamical system model improved accuracy forecasting horizon chaotic system bonavita laloyaux 67 used ml extend current data assimilation capability operational forecasting system farchi et al 68 used ml correct model error data assimilation forecasting development global climate model property adjusted tuned various way best match known state earth climate system developer typically perform calibration adjusting uncertain even parameter related process not explicitly represented model grid resolution 69 key model property climate sensitivity depend frequently used tuning parameter mauritsen et al 69 explain model tuning process institute artisanal character adjustment parameter tuning iteration evaluation resulting candidate model done hand done modelling centre however least conceptually possible automate process ﬁnd optimal set parameter respect certain ml downloaded 28 march 2024 7 phil trans 379 20200093 could employed ﬁnd optimal set critical parameter weather climate model ha done rigorous statistical inference determine model coefﬁcients turbulence modelling 70 using inverse method statistical parameter estimation method weather climate modelling however uncertainty limitation choice model structure not improved ml 74 ix interpretability interpretable model provide transparency necessary make piml reliable trustworthy exists large body literature interpretable ml rudin 78 argues interpretability need deﬁned way some important technical challenge future interpretable ml model tied need speciﬁc domain much work remains done making piml model weather climate science truly interpretable however initial progress show great promise mcgovern et al 79 uphoff et al 80 showed way interpret visualize evaluate ml model meteorological application gagne et al 81 used feature importance feature optimization interpret cnn model predicting probability severe hailstorm found model synthesized information environment storm morphology consistent current understanding physic hailstorm tom et al 82 developed interpretable nns geosciences showed usefulness reliability improving understanding oscillation 83 brenowitz et al 43 developed interpretability framework specialized analysis relationship ofﬂine skill versus online coupled prognostic performance ml parameterizations convection x uncertainty quantification model uncertainty characterized quantiﬁed critical reliable climate change mitigation adaptation given large number assumption component parameter ml model uncertainty training data either noise data quality issue uq requirement increasing reliability prediction especially distributional shift scenario though no method employ several uq method ml could employed caldeira et al 84 compare three popular uq method ml application science bayesian nns concrete dropout deep ensemble bayesian nns parameter modelled full probability distribution resulting better calibrated conﬁdence estimate robustness adversarial example 85 however modelling full posterior distribution model parameter given data usually computationally intractable high computational cost circumvented dropout approximate posterior distribution obtained using variational inference 86 model uncertainty estimated using dropout predicting multiple time obtain spread different prediction deep ensemble ensemble nns used obtain uncertainty estimate comparable obtained bayesian nns 87 probabilistic ml model amenable efﬁcient uq shown zhu et al 16 using conditional generative model model uncertainty solving pdes yang et al 88 use adversarial uq nns construct probabilistic ml model system governed pdes use model characterize uncertainty due noisy input daw et al 22 use monte carlo dropout uq lake temperature modelling vandal et al 89 use bayesian dl downscale climate data quantiﬁed uncertainty gagne et al 36 demonstrate gans used explicit stochastic parameterizations model uncertainty subgrid process directly data schneider et al 90 propose blueprint using ml integrate observation simulation earth system modelling systematically learn quantiﬁes uncertainty downloaded 28 march 2024 8 phil trans 379 20200093 c application machine learning weather climate modelling piml becoming increasingly important least three major application weather climate modelling emulating complex physical process either poorly understood not sufﬁciently well represented existing model ii downscaling coarse data produce data iii forecasting dynamic atmosphere ocean promising application include pde solver discovery governing equation 101 machine learning case study emulation downscaling forecasting section introduce 10 case study representing three application area use key piml approach described address critical challenge weather climate modelling table 1 characterizes 10 case study piml task physical process modelled datasets used relevant piml approach used ml model type piml objective achieved physical process examined span range complexity fundamental turbulent ﬂows convection complex weather climate phenomenon cloud precipitation melting snowpack section contains four case study emulation contains three case study contains three case study forecasting case study emphasize signiﬁcance modelling challenge identify motivation using piml describe physic domain knowledge incorporated ml model explain uncertainty quantiﬁed highlight key result summarize implication study broader weather climate science community emulating complex physical process earth weather climate characterized wide range spatial temporal scale interaction across scale resolving scale weather climate system simulation prohibitively expensive practice simulating system often involves closure parameterizations model unresolved process physic convection cloud turbulence however parameterizations also account major source uncertainty simulation result partly due neglecting statistic nonlinear process effect resolved scale 91 piml offer novel way leveraging existing simulation datasets build model emulate part complex process used augment replace existing parameterizations weather climate model piml also offer novel way emulating chain coupled process example hydrological cycle even entire weather climate model altogether emulator offer way rapidly explore different scenario wide range parameter value test different potential value effective parameter estimating parametric uncertainty 90 constrained gans emulate turbulent convection review approach used constrained gans emulate turbulent convection important process parameterized weather climate model begin downloaded 28 march 2024 9 phil trans 379 20200093 table characteristic piml case study examined section piml piml case study modelling task physical approach piml objective reference process datasets ml model achieved wu etal 18 emulation convection direct numerical simulation dns custom loss stochasticity spectral gan physically consistent accelerated training manepalli etal 102 emulation mountain snowpack melting meteorological observational product custom loss stochasticity uq conditional gan physically consistent daw etal 22 emulation lake temperature dynamic observational lake characteristic data custom architecture uq lstm physically consistent data efficient interpretable beucler etal 14 emulation atmospheric convection cloud community atmosphere model custom loss custom architecture nn physically consistent generalizable singh etal 103 atmospheric wind weather research forecasting model custom loss stochasticity spectral gan physically consistent generalizable vandal etal 89 precipitation reanalysis product prism custom architecture stochasticity uq bayesian nn cnn physically consistent data efficient jiang etal 104 convection dns custom loss custom architecture coherence nn physically consistent generalizable scalable wang etal 105 forecasting convection dns custom loss custom architecture structure nn physically consistent generalizable interpretable wang etal 30 forecasting convection ocean current dns ocean reanalysis product custom architecture equivariant coherence residual network physically consistent data efficient generalizable chattopadhyay etal 31 forecasting geophysical turbulence dns custom loss custom architecture equivariant coherence spatial transformer network physically consistent data efficient stable downloaded 28 march 2024 10 phil trans 379 20200093 sample space random noise generator deconvolutional net discriminator real fake convolutional net training sample generated sample statistic generated sample statistic training sample measure distance inform b traditional gans constraint covariance â pg z â pdata â pdata â pg z â figure architecture constrained gan including architecture standard gan black modification red 18 online version colour brief introduction gans gans emulate behaviour complex system mimicking data distribution trained 107 gans formulated game two deep nns generator g discriminator figure 1 show schematic dl architecture standard setting g receives random noise vector z drawn simple distribution uniform gaussian input pass succession deconvolutional layer nonlinear transforms output sample g z role act classiﬁer deciding sample receives either real fake generated g training g ideally able produce fake sample implicitly drawn data distribution g seek emulate recent research ha shown gans used generate new solution governed system training simulation datasets capture several desirable physical statistical property turbulent ﬂows 108 gans however notoriously difﬁcult train instability training sensitivity challenge convergence generation noisy sample suffer mode collapse only generate sample single mode true multimodal data distribution several approach proposed incorporate domain knowledge alleviate some challenge improve performance gans physical problem using customized loss function modiﬁed architecture gagne et al 36 us gans temporal coherence stochastic emulation subgrid scale dynamic xie et al 57 incorporate temporal coherence gans generate realization turbulent ﬂows yang et al 111 encode governing physical law form stochastic differential equation architecture gans stinis et al 112 incorporate constraint enhance interpolation extrapolation capability gans physic incorporated study wu et al 18 incorporate statistical constraint novel regularizer emulator 18 precisely covariance structure moment training data distribution enforced introducing penalty term loss function introduced penalty term account difference covariance structure generated sample training data described covariance constraint help capture scale distribution correlation across scale preserve spectral property pde underlying data physical system investigated study convection rbc canonical turbulent ﬂow idealized model atmospheric convection detail simulation datasets used training 18 figure 2 show downloaded 28 march 2024 11 phil trans 379 20200093 training data standard 20 epoch standard 20 epoch standard 100 epoch constrained 20 epoch constrained 20 epoch standard 100 epoch 0 1 10 102 wave number energy spectrum training data b c figure comparison training data truth standard gan trained 20 epoch 100 epoch size 256 right turbulent kinetic energy spectrum line predicted theory constrained gan capture spectrum except highest wavenumbers finest scale flow figure reproduced 18 online version colour comparison training data truth standard gan trained 20 epoch 100 epoch constrained gan trained 20 epoch left turbulent kinetic energy ﬁelds right power spectral density psd turbulent kinetic energy metric incorporates information across spatial scale constrained gan outperforms unconstrained counterpart generating accurate turbulent kinetic energy ﬁelds energy spectrum psd show entire range scale accurately captured thus achieving physical consistency uncertainty quantiﬁed although uq wa not performed study stochastic nature gans allows several way estimating uncertainty gagne et al 36 provide insightful discussion gans used model uncertainty sg process furthermore discus approach uq using generated sample injecting noise intermediate layer g calculate distribution application statistical test calculate conﬁdence interval key implication first result show constrained gans emulate statistic training data better unconstrained counterpart indicating statistical constraint lead better convergence towards global minimum statistic training data captured second constrained gans achieve greater accuracy signiﬁcantly lower computational cost 80 reduction computational cost model training compared unconstrained model effect statistical constraint reduces space allowable solution forcing training procedure explore only reduced solution space moment generated sample similar training data growth simulation database turbulence weather climate work show gans preserve statistic emulate complex system well model stochasticity uncertainty data could promising alternative closure model parameterizations unresolved physic downloaded 28 march 2024 12 phil trans 379 20200093 ii conditional gans emulate numerical model review potential conditional gans cgan emulate model spatial distribution water content mountain snowpack snow water equivalent swe snowpack swe key indicative variable investigating changing water cycle impact nature society economy acquiring swe data via direct observation extremely difﬁcult mountainous region expensive furthermore based model uncertainty meteorological variable inﬂuence swe temperature wind velocity humidity net radiation precipitation known result swe prediction extremely large uncertainty hence alternative swe prediction characterize estimate uncertainty reliably attractive manepalli et al 102 formulate emulation problem translation task goal transform image domain x gridded meteorological variable domain swe grid based solution translation problem 113 setting training sample two domain x assumed paired furthermore g take noise vector additional input generate distribution realistic plausible swe map individual day sampling detail training datasets 102 physic incorporated domain knowledge incorporated cgan via designed loss function follows area higher elevation typically larger amount snow therefore swe cgan penalized large error area accordingly ii signiﬁcant portion data cover water body paciﬁc ocean no snowpack exist model penalized placing swe value area iii difference total swe cgan solution physic model output also penalized ensure total stored water mass properly estimated three custom loss weighted equally figure 3 show model architecture cgan histogram normalized pixel value ﬁgure show generated data distribution match real data distribution well psd plot ﬁgure show large scale captured well cgan small discrepancy small scale frequency ablation study wa performed custom loss removed systematically one time order understand relative importance accuracy convergence cgan author found custom loss higher elevation wa crucial rmse increased 40 loss wa removed extreme event tail distribution not captured uncertainty quantiﬁed injecting noise several layer g allows generation diverse realistic physically plausible swe grid furthermore sampling performed individual test point allowing creation swe distribution application statistical test conﬁdence interval one test location ﬁgure show resulting swe distribution formed sampling stochastic g blue centred around prediction numerical model livneh green large deviation average swe value snotel observation expected numerical model gridded 4 km resolution whereas snotel measured single small pressure sensor complete description uncertainty reliability predicted distribution would require reliability diagram discussed finally inference cgan ha speedup numerical model enabling previously intractable study probabilistic risk assessment sensitivity analysis key implication result indicate cgan model able effectively learn diverse mapping meteorological forcings swe output thus providing mean fast accurate swe modelling signiﬁcant impact variety application hydropower forecasting agriculture water supply management 114 massive speedup diverse sampling modelling cgans bring process emulation along method uq show promise investigating impact climate change using emulator downloaded 28 march 2024 13 phil trans 379 20200093 input meterorological forcings topographical data output generated swe map output generated swe map output generated swe map physic model swe map physic model swe map g generated cgan fake generated physic model real height error penalty total swe penalty physic informed penalty term hyperparameters minimize training water mask penalty water mask height multiplier error 0 20 40 60 80 100 120 140 160 normalized pixel value log count count power spectral density spatial frequency real data generated data real generated 70 60 50 40 30 20 10 0 100 80 60 40 20 0 106 105 104 103 102 10 1 histogram winter swe winter swe psd 13 april 2012 ebbetts pas cgan swe noise livneh swe normalized snotel swe cgan swe noise b c figure top architecture cgan bottom histogram density log scale normalized pixel value comparing cgan green physic model black normalized winter range swe b power spectral density cgan physic model c distribution swe blue formed sampling stochastic g compared sample g yellow livneh training data green observational data nearby snotel station red 13 april 2012 single sample time normalized swe pixel value large deviation average swe value pixel expected numerical model gridded 4 km resolution whereas snotel measured single small pressure sensor figure reproduced 102 online version colour iii neural network lake temperature modelling predicting spatial temporal characteristic lake temperature critical understanding ecological aquatic biogeochemical process impact climate change fresh water 115 accurate model lake temperature require modelling many complex process coupled expensive observation water temperature difﬁcult impossible broad spatial temporal scale hence ml model could offer faster potentially accurate solution essential review novel architecture pga nn proposed daw et al 22 model lake temperature integrate uq formulate problem lake temperature modelling sequential prediction problem pga ha three component autoencoder extract temporal feature lstm model perceptron predict new sequence temperature physic incorporated lstm predicts intermediate variable density since density only increase depth must monotonic lstm model constrained only predict positive density increment increasing depth detail implementation 22 downloaded 28 march 2024 14 phil trans 379 20200093 10 20 30 40 50 60 training fraction percentile 70 80 90 100 10 20 30 40 50 60 70 80 90 100 test rmse percentage 10 20 30 40 50 60 70 80 90 00 lstm line lstm 100 b figure 4 test rmse per sample varying training size b cumulative percentage observation within certain percentile sample comparative model figure reproduced 22 online version colour table testrmseandphysicalinconsistency thefractionoftimesthemontecarlosamplepredictionsatconsecutivedepths physically inconsistent violate relationship using 40 training data table reproduced daw etal 22 test rmse physical inconsistency per sample mean per sample mean lstm pgl pga uncertainty quantiﬁed uncertainty quantiﬁed using dropout testing phase produce monte carlo sample target variable every test technique called monte carlo dropout 86 baseline model used comparison standard lstm model lstm loss pgl penalizes density change 13 shown table 2 comparison performance proposed pga versus baseline standard lstm pgl standard architecture produce physically inconsistent solution even guided loss author argue randomness injected trained weight nn dropout sufﬁcient unlearn physical consistency introduced loss training contrast baseline proposed pga show smallest rmse per test sample always preserving physical consistency even performing monte carlo dropout furthermore training varying sample size show ha lowest rmse across value training fraction goal simulate realistic scenario lake little no observational data exists seen ﬁgure pga achieves rmse value comparable standard lstm order magnitude smaller amount training data show novel pga highly data efﬁcient ass uncertainty estimate using monte carlo dropout method cumulative percentage observation fall within certain percentile sample generated comparative model shown ﬁgure reliability diagram ideal model represented diagonal line x percentage point within percentile equal percentile value model would fewer downloaded 28 march 2024 15 phil trans 379 20200093 enforce n physical constaints within nn traditional perceptron input output p n output p hidden layer n constraint hd xm vn yp figure configuration nn augmented n conservation layer figure reproduced 14 point within certain percentile hence would lie diagonal pga tends slightly uncertainty estimate whereas baseline conﬁdent uncertainty estimate distribution ground truth point sometimes fall outside distribution monte carlo sample larger uncertainty estimate proposed architecture desirable especially unseen scenario key implication result show architecture powerful way enforce constraint achieve physical consistency data efﬁciency furthermore work show introducing intermediate variable physical interpretable help make piml model transparent finally monte carlo dropout shown provide simple yet effective mean constructing robust model uncertainty quantiﬁed iv enforcing conservation law neural network climate modelling conservation mass momentum energy critical climate change study climate system highly sensitive mass momentum energy imbalance conservation law often expressed pdes including nonlinear pdes equation conservation law also fundamental variety application ml physical system yet not exist general approach enforcing law ml model review novel systematic method developed beucler et al 14 strictly enforce conservation law physic incorporated beucler et al 14 augment standard nn n conservation layer enforce conservation law c machine precision network output unconstrained vector size p p size ﬁnal output vector required remaining component output vector calculated using n constraint imposed via n conservation layer figure 5 show architecture mse loss calculated entire output concatenates output original nn output conservation layer exact residual constraint full output vector used nn training process gradient loss function passed conservation layer optimization approach fundamentally different simply calculating part output step using conservation law constraint beucler et al 14 apply approach nn emulator convection climate modelling goal nn predict effect cloud process climate radiative convective tendency based input represent climate state downloaded 28 march 2024 16 phil trans 379 20200093 table error skill physical constraint penalty p violation conservation law different model unit format mean table reproduced beucler etal 14 validation metric mlr nnu nnl nna baseline mse 295 103 156 103 177 103 169 103 k p 28 2 101 458 5 102 5 7 1 cl change mse 747 1 105 633 7 103 496 8 103 567 8 103 k p 265 2 103 3 105 1 106 470 2 103 2 5 thermodynamic variable conservation law imposed conservation mass enthalpy terrestrial radiation solar radiation compare result three baseline model regression model mlr unconstrained nn nnu nn additional penalty loss function equal residual constraint nn soft constraint nnl detail training data procedure 14 test performed present day climate similar training data climate change scenario warming table 3 compare performance measured mse physical inconsistency deﬁned degree conservation law violated measured penalty α relative weight penalty p standard mse loss nnu ha low mse strongly violates conservation law nnl performs reasonably well lower penalty unconstrained counterpart architecturally constrained nn satisﬁes conservation law machine precision importantly table 3 show nnl nna perform better nnu climate change scenario suggesting physically constrained nns soft hard generalize better unseen scenario although nna ha higher mse nnl climate change scenario subsequent work author show nna achieve conservation without degrading performance 17 table 3 key implication work show enforcing strict constraint via designed nn architecture conservation physical quantity critical requirement weather climate modelling guarantee physical consistency improves generalizability subsequent work author extend approach general broader class analytic constraint including nonlinear constraint inequality constraint 17 b downscaling coarse data accurate reliable weather climate data essential understanding scientiﬁc phenomenon better wide range climate impact study planning making climate change especially important event highly localized phenomenon weather climate extreme urban area region high topographic complexity sharp gradient like mountain coastal region however fully resolving complex system conventional numerical weather climate model intractable observational datasets not contain reliable information ﬁne scale therefore pressing need efﬁcient accurate method enhance resolution weather climate data enhancing resolution weather climate data downscaling done using dynamical statistical approach dynamical downscaling technique use resolution regional model coarse data used boundary initial condition dynamically predicting effect climate process regional local scale interest dynamical downscaling technique generally reliable based computationally expensive contrast statistical downscaling cheap fast suffers poor generalizability some traditional statistical downscaling method also tend smooth feature 97 downloaded 28 march 2024 17 phil trans 379 20200093 sr process taking lr image producing enhanced image approximates true hr version 116 sr includes bilinear bicubic interpolation simple tend signiﬁcantly smooth scale feature sharp gradient sr approach offer novel way resolution enhancement learning complex mapping pair image 117 criterion successful sr include realistic feature hr perceptually physically rigorous quantitative validation hr image using physically relevant metric vandal et al 118 develop deepsd generalized stacked sr convolutional neural network srcnn framework statistical downscaling climate data outperforms several traditional statistical downscaling method stengel et al 97 develop adversarial dl approach sr show promising result enhancing resolution climate data factor sr problem since one lr image could mapped many hr image hence probabilistic ml model uq preferred groenke et al 37 develop novel unsupervised statistical downscaling model using normalizing ﬂows type generative ml model allows conditional unconditional sampling joint distribution high low resolution spatial ﬁelds holy grail sr sr spatial temporal resolution enhanced produce physically accurate hr data satisﬁes governing law system ha physically accurate realistic feature coherent space time gan weather data review sr method produce output ﬁelds using physical constraint encodes feature system singh et al 103 use modiﬁcation enhanced sr gan esrgan architecture esrgan conditional gan designed contains three loss adversarial loss content loss generated data true hr data perceptual loss 119 content loss mse loss computed using norm generated data true hr data perceptual loss motivated work image processing computer vision loss constructed previously trained auxiliary network identiﬁes critical feature image data intermediate layer network improve perceptual quality enhanced output physic incorporated esrgan modiﬁed replacing adversarial loss psd loss psd loss penalizes error energy spectrum generated image comparing spectrum ground truth data discussed capturing energy spectrum accurately implies range spatial scale characterized accurately furthermore psd differentiable function allows optimization using 103 author refer model furthermore direct optimization spectrum accelerates training stable larger batch size doe not require training discriminator sr performed 15 year wind velocity ﬁelds numerical simulation weather research forecasting wrf model southern california spatial resolution data km temporal resolution hourly sr enhances spatial resolution dimension see 103 detail dataset training procedure proposed sr method compared three baseline standard esrgan ii cnn architecture used vandal et al 118 iii upsampling using bicubic interpolation figure show schematic gan table 4 compare performance validation set metric comparison peak signal noise ratio psnr mse mean absolute error mae kl divergence empirical distribution generated image ground truth psnr mse mae averaged image validation set performs best metric psd plot ﬁgure show standard esrgan capture range scale accurately whereas bicubic interpolation drop signiﬁcantly downloaded 28 march 2024 18 phil trans 379 20200093 hr content loss sr lr adversarial loss 10 1 102 20 30 40 50 60 70 spatial frequency power spectrum db power spectral density sr model versus real real esrgan bicubic cnn b discriminator network generator network figure 6 schematic gan figure reproduced 97 b power spectral density psd plot sr method compared figure reproduced 103 online version colour overviewoffinalperformanceonthevalidationset psnr peaksignaltonoiseratio mse mae meanabsoluteerror andkl mse mae averaged image validation set table reproduced singh etal 103 model psnr mse mae kl esrgan bicubic intermediate high spatial frequency ﬁne scale smoothed esrgan learns data distribution scale adversarial training preserve physically relevant characteristic direct optimization spectrum help reproduce spectrum faithfully figure 7 compare image lr input ground truth hr generated sr output esrgan srcnn bicubic upsampling although esrgan performs poorly psnr mse mae generated image reveal esrgan produce sharper image realistic feature le prone artefact uncertainty quantiﬁed although uq wa not performed study discussed stochastic nature gans allows several way estimating uncertainty furthermore performance tail distribution extreme event generated sr image characterized using various statistical test including reliability diagram shown key implication work show novel dl sr model derived esrgan able efﬁciently effectively learn produce data feature realistic physically consistent approach show mean fast accurate sr signiﬁcant impact variety weather climate application ii bayesian deep learning uq downscaling precipitation uq essential development robust reliable piml model review work vandal et al 89 build upon model downscaling downloaded 28 march 2024 19 phil trans 379 20200093 lr hr esrgan bicubic figure comparison lr ground truth hr generated sr output esrgan srcnn bicubic upsampling lower panel corresponds area red box upper panel figure reproduced 103 online version colour precipitation 118 use bayesian deep learning bdl model systematically characterize estimate uncertainty physic incorporated like many weather climate phenomenon follow normal distribution distribution precipitation highly skewed fat tail day no precipitation rainy day large even extreme precipitation furthermore precipitation exhibit extreme variability well intermittence author use bdl model lognormal likelihood model highly skewed distribution precipitation deepsd adaptation sr model srcnn performs wise regression 118 deepsd us skip connection auxiliary variable elevation correct bias furthermore stacking multiple srcnns deepsd achieve resolution enhancement large formalize use bdl within deepsd architecture assuming normal predictive distribution conditional dc model gaussian lognormal likelihood dc model condition amount precipitation given occurrence precipitation also derive corresponding loss unbiased parameter estimate bdl model detail mathematical derivation implementation dl framework 89 precipitation data obtained prism dataset reanalysis product 4 km resolution coarsened lower resolution generate training data sr problem enhance spatial resolution 64 km 16 km across contiguous usa three bdl model used comparison bdl normal distribution ii dc model guassian distribution iii dc model lognormal distribution detail training procedure refer 89 model evaluated several metric rmse bias two extreme index heavy wet day rainfall greater 20 daily intensity index deﬁned annual total rainfall divided number day rainfall sdii table 5 show dc model perform better particular show lowest bias rmse error ha slightly higher error performs marginally better estimating sd ii index uncertainty quantiﬁed uq especially important problem recent development bdl provide way capture uncertainty noisy observation unknown model parameter vandal et al 89 use practical variational approach approximate posterior distribution deepsd using dropout monte carlo downloaded 28 march 2024 20 phil trans 379 20200093 200 175 150 125 100 75 50 25 0 0 10 20 30 observed precipitation gaussian b c predicted precipitation 200 175 150 125 100 75 50 25 0 predicted precipitation 200 175 150 125 100 75 50 25 0 predicted precipitation 40 50 60 70 0 10 20 30 observed precipitation 40 50 60 70 0 10 20 30 observed precipitation 40 50 60 70 figure uncertainty width based quantiles predictive distribution point observation versus expected value band correspond 50 80 90 predictive interval figure reproduced 89 sdii andyearlyprecipitation event greater 20 mm measure model ability capture precipitation extreme error sdii error measure difference observed index predicted index closer 0 better table reproduced vandal etal 89 bias rmse error sdii error gaussian sampling described 84 ﬁrst two moment derived used estimate wise probabilistic estimate calibration metric used uq frequency observation occurring within varying predicted probability range figure 8 show uncertainty increasingly intense precipitation day highest rainfall day model generally precipitation gaussian model often fail capture extreme model ha wider uncertainty interval able produce distribution extreme furthermore wide interval indicate model becomes le conﬁdent rare event higher intensity suggesting exists gaussian lognormal distribution ability model produce uncertainty extreme suggests bayesian deep nns model distribution well motivated domain knowledge key implication work show successful careful characterization uncertainty sr model using bdl uq method presented versatile used many piml application drawing domain expertise work also provides approach model extreme event iii meshfreeflownet deep continuous framework sr work ha focused enhancing only spatial resolution coarse data recent work ha made initial step toward addressing temporal coherence consecutive snapshot performing spatial sr temporally coherent manner 57 although far challenging enhancing spatial temporal resolution simultaneously powerful provide evolution complex system temporal scale relevance sr go beyond simple coherence inserting entirely new snapshot data spatial resolution given time step data review meshfreeflownet novel sr framework generate continuous solution complex system input 104 downloaded 28 march 2024 21 phil trans 379 20200093 backpropagation context generation network latent context grid pde constraint output equation loss prediction loss supervision query input learned model meshfreeflownet input ground truth point sample continuous decoding network mlp c x x x z z z p u w figure left schematic training pipeline meshfreeflownet model continuous task input grid fed context generation network creates latent context grid random set point corresponding domain sampled query latent context grid physical output value query location continuously decoded using continuous decoding network implemented multilayer perceptron right schematic continuous decoding module meshfreeflownet multilayer perceptron input coordinate query point along latent context vector decoded required physical channel interest since query point fall cell bounded eight neighbouring vertex query performed eighttimes 104 ground truth prediction meshfreeflownet input figure sample tuples input data data meshfreeflownet ground truth data four physical parameter rbc system p u w respectively temperature pressure x z component velocity video show spatial temporal resolution enhancement figure reproduced 104 online version colour meshfreeflownet allows output sampled resolution ii set pde constraint imposed iii training input arbitrarily sized domain owing fully convolutional encoder meshfreeflownet learns inherent statistical correlation pair solution manner reconstruct solution input although meshfreeflownet queried any location thus principle produce output any resolution ﬁdelity output limited quality hr training data physic incorporated meshfreeflownet consists two context generation network continuous decoding network context generation network learned localized representation ﬂow encodes local correlation across space time latent context grid thus learning preserve spatial temporal coherence characteristic training data random set point corresponding domain sampled query latent context grid physical output value query downloaded 28 march 2024 22 phil trans 379 20200093 location continuously decoded using continuous decoding network implemented multilayer perceptron mlp due differentiable nature mlp any partial derivative output physical quantity respect input coordinate effectively computed via backpropagation enabling easy way enforcing physical constraint equation loss whole framework trained weighted combination two loss norm difference predicted physical output ground truth physical output referred prediction loss ii norm residual governing pdes referred equation loss residual pde measure imbalance mass momentum energy conservation equation equation computed using predicted output physical quantity gradient combined loss backpropagated network training figure 9 show schematic framework nn architecture mathematical detail 104 ﬁgure 10 meshfreeflownet effectiveness tested turbulent rbc see 104 detail problem solver datasets figure 10 show sample tuples input data data meshfreeflownet ground truth resolution data four physical parameter rbc system p u w respectively temperature pressure x z component velocity data essentially indistinguishable true data video show spatial temporal resolution enhancement comprehensive set turbulent ﬂow metric used rigorously test physical validity accuracy prediction total kinetic energy etot velocity urms turbulence dissipation rate ε taylor microscale λ reynolds number reλ kolmogorov time τη length scale η turbulent integral scale l large eddy turnover time tl comparison performance meshfreeflownet framework two baseline classic trilinear interpolation ii shown table normalized mean absolute error nmae evaluation metric shown bracket nmae evaluated predicted versus ground truth data deﬁned 1 ssres sum square difference predicted physical output ground truth physical output ssres total sum square ssres larger sstot large negative γ weight equation loss hence γ 0 case only prediction loss γ γ optimal weight determined parameter optimization baseline fails reconstruct data resolve detail leading large error evaluation metric dl baseline ii directly map data space achieving better performance compared baseline meshfreeflownet outperforms baseline ii particular accurately recovers quantity interest kolmogorov time τη length scale η signiﬁcantly better any method generalizability wa tested examining performance across set nine metric rayleigh number larger smaller training dataset table 7 show score ﬂow regime two order magnitude rayleigh number ha trained decrease le 10 suggesting model generalizes well also generalizes well unseen physical initial condition not shown furthermore implementation meshfreeflownet show efﬁciently scale across large cluster hundred gpus hence could applied realistic problem require order magnitude computational resource see 104 detail scaling key implication meshfreeflownet sr framework presented ha many powerful feature coherence loss improved performance physically motivated metric ability arbitrary spatial temporal location arbitrarily large domain generalizability high scalability thus application realistic turbulent ﬂows atmosphere ocean downloaded 28 march 2024 23 phil trans 379 20200093 comparisonbetweentheperformanceof nmae inbracketsbelownmae evaluation metric evaluated predicted versus ground truth validation data γ refers coefficient equation loss total loss function table reproduced jiang etal 104 100 nmae model etot urms ε λ reλ τη η l tl avg baseline 096 599 baseline ii meshfreeflownet γ 0 meshfreeflownet γ γ downloaded 28 march 2024 24 phil trans 379 20200093 table meshfreeflownet model ha trained 10 datasets different boundary condition rayleigh number ra 2 90 105 pr 1 performance evaluation reported rayleigh number within range boundary condition training set ra 5 106 rayleigh number slightly range boundary condition training set ra 1 105 ra 1 107 respectively rayleigh number far range boundary condition training set ra 1 104 ra 1 108 respectively nmae inbracketsbelownmae data table reproduced jiang etal 104 100 nmae ra etot urms ε λ reλ τη η l tl avg 1 104 1 105 5 106 1 107 1 108 downloaded 28 march 2024 25 phil trans 379 20200093 c forecasting predicting evolution weather climate phenomenon learning highly nonlinear dynamic simulation observational data extremely challenging given computational efﬁciency ml technique limitation today numerical weather prediction climate model particular respect resolution complexity ml offer attractive alternative weather climate forecasting 120 ml model trained sample high resolution simulation observation evolved forward time ha shown however remains seen purely model capable forecasting large ensemble high resolution section survey piml approach predicting evolution turbulent ﬂows atmosphere ocean tfnet hybrid forecasting model simulating ﬂuid dynamic atmosphere ocean using ﬁrst principle requires signiﬁcant computational resource domain expertise hybrid approach combine physic method show great promise grand challenge widely used computational ﬂuid dynamic technique solves stokes rans equation model closure term eddy viscosity model described viii le resolve motion model effect sg turbulence hybrid coupling approach combine computational efﬁciency rans accurate resolving power le provide technique le expensive tractable pure le 124 review turbulentflownet tfnet proposed wang et al 105 applies scale separation build upon structure existing turbulence model physic incorporated tfnet us structure coupling approach replaces priori spectral ﬁlters trainable convolutional layer turbulent ﬂow decomposed three component mean ﬂow resolved ﬂuctuations unresolved subgrid ﬂuctuations approximated specialized preserve property ﬂow motivation design explicitly guide ml model learn nonlinear dynamic sg motion relevant task prediction furthermore loss penalizes absolute divergence used regularizer figure 11 show overall architecture tfnet detail architecture 105 tfnet tested rbc unconstrained constrained tfnet con tfnet ﬁgure 12 compared four purely ml model resnet convlstm gan two piml model sst 59 dhpm 15 besides rmse physically relevant metric turbulence kinetic energy divergence energy spectrum used evaluate performance model shown ﬁgure one large eddy turnover time approximately 10 prediction step tfnet capable generating accurate physically meaningful prediction preserve critical quantity relevance forecasting velocity ﬁeld 60 step ahead given history consistently outperforms baseline divergence constraint con tfnet improves performance tfnet also generalizes well new rayleigh number outside regime wa trained not shown furthermore tfnet ha signiﬁcantly smaller number parameter baseline hence compact efﬁcient piml model key implication work show efﬁcient effective way combine turbulence model dl accurately forecast complex temporal dynamic capturing key physical property condition motivates integration model ml crucial requirement however expertise identify suitable physical model structure built upon component model augmented downloaded 28 march 2024 26 phil trans 379 20200093 w e w e w e w e w w 64 64 32 128 128 256 256 512 512 w temporal filter spatial filter figure turbulent flow net tfnet consists three identical encoders learn transformation three componentsoftheflowatdifferentscales andoneshareddecoderthatlearnstheinteractionsamongthesethreecomponents predict velocity field next instant pair viewed figure reproduced 105 online version colour 0 500 600 1 1012 1013 1014 1015 1016 1017 1018 10 800 1000 1200 1400 1000 1500 2000 2500 10 20 30 predition step rmse mean absolute divergence energy spectrum predition step wave number 40 50 0 10 20 30 40 50 60 con gan resnet convlstm sst dhpm con gan resnet target convlstm sst dhpm con resnet target comparisonbetweenperformanceofmodels rmse turnover time approximately 10 prediction step figure reproduced 105 online version colour replaced ml training consistent modelling assumption model ii symmetric equivariant deep dynamic model discussed designing model equivariant transformation input guarantee model generalizes across transformation making robust distributional shift scenario model also compact data efﬁcient embedded symmetry equivariances review recent work wang et al 30 building equivariant deep dynamic model predicting evolution rbc ocean current physic incorporated wang et al 30 consider symmetry translation rotation uniform motion scaling develop mathematical framework tailor practical method incorporating symmetry deep nns key building equivariant network composition equivariant function equivariant show map layer nn equivariant whole network equivariant detail implemented ml model 30 ml model used resnet equivariant counterpart temporal prediction done autoregressively standard rmse rmse computed psd energy spectrum used measure performance model tested rbc downloaded 28 march 2024 27 phil trans 379 20200093 target resnet target 10 5 1 10 5 1 10 5 1 10 5 1 10 5 1 resnet equum target resnet equmag target resnet equrot target resnet equscal equum equmag equrot equscal figure comparison performance equivariant equ resnet model rbc velocity field left right equivariant model uniform motion magnitude rotation scale equivariance transformation testsareonfuturetimes comparisonbetweenperformanceofequivariant equ resnet model ocean current equ column equivariant model uniform motion magnitude rotation scale equivariance transformation no single equivariant model capture target accurately however equivariant model perform better baseline figure reproduced 30 online version colour reanalysis ocean current velocity data generated nemo ocean engine three different location atlantic paciﬁc indian ocean rbc test set random transformation relevant symmetry group applied sample mimic world data sample ha unknown reference frame ocean data test also performed different time range different domain training set representing distributional shift case equivariant model prediction accurate baseline see 30 quantitative comparison figure 13 show equivariant model perform signiﬁcantly better counterpart preserving spatial temporal coherence well ﬁne scale structure 30 author show quantitatively equivariant model robust data transformation distributional shift key implication work incorporates various symmetry nns develop novel equivariant model forecasting atmospheric oceanic ﬂows generalize well combining different symmetry single equivariant model extending dimensional ﬂows important implication developing compact tractable ml model realistic geophysical ﬂows iii deep spatial transformer autoregressive forecasting review work chattopadhyay et al 31 show equivariance preserving property modern spatial transformer incorporated within convolutional module predict evolution geophysical turbulence successfully 125 furthermore preserving equivariance using loss enables stable prediction multiple year providing promise development stable physical piml model weather climate forecasting chattopadhyay et al 31 consider fully turbulent ﬂow represented geostrophic equation qg baroclinically unstable jet complexity qg system based instantaneous attractor dimension upper layer stream function comparable instantaneous attractor dimension geopotential height 500 hpa downloaded 28 march 2024 28 phil trans 379 20200093 observed atmosphere 98 piml model developed accurately predict dynamic upper layer stream function without any information lower layer stream function even training thus important implication forecasting partial observation physic incorporated physic incorporated model implementing spatial transformer module embedded within encoding block style dl model transformer module preserve within feature map equivariance translation scale rotation generic warping local feature turbulent vortex incorporating equivariance property shown increase accuracy short term provide physical meaningful stable climate prediction additionally custom loss function used address instability drift furthermore spatial transformer memory efﬁcient easier implement fully differentiable layer inside any dl architecture thus providing attractive computational advantage dl architecture detail implemented training datasets training procedure 31 performance measured using correlation coefﬁcient prediction ground truth starting random initial condition unseen dataset figure show model custom loss outperforms persistence baseline without spatial transformer even scale 10 day longer time scale day model remains physical predicted doe not drift maintains stable physical climate time contrast model without custom loss transformer module not simulate physical climate show drifting jet low pressure anomaly dominate persistence performs well seasonal timescales chaotic system small error quickly accumulate predicted trajectory diverges away true trajectory dynamical system corroborates ﬁndings weyn et al 121 figure show averaged quantity dynamic zonally averaged ha obtained ﬁrst averaging 1000 day prediction obtain time average zonally averaged similar analysis ha done meridional averaging mean meridionally averaged resembles true mean system closely persistence case zonally averaged persistence model resemble truth quite well key implication incorporating property spatial transformer custom loss function work develops novel piml approach reliable forecasting realistic geophysical ﬂow ability predict stable physically meaningful climate long term achieve reliable forecast partial observation promising demonstrating capability realistic datasets reanalyses important implication forecasting geophysical phenomenon using piml uncertainty quantiﬁed forecasting although uq ha yet not employed piml model forecasting discussed ensemble ml technique provide opportunity characterizing estimating uncertainty 126 purely forecasting bihlo 127 show gans used monte carlo dropout develop ensemble weather prediction model fanfarillo et al 128 develop deep generative model probabilistic forecast adapting technique 84 piml model could provide new opportunity systematic uq forecasting synthesis outlook article review progress piml towards addressing some critical challenge weather climate modelling namely building better emulator complex physical process ii downscaling coarse data produce data iii forecasting dynamic atmosphere ocean using 10 approach described case study characterized table 1 illustrate ﬁeld signiﬁcant progress advancing piml downloaded 28 march 2024 29 phil trans 379 20200093 0 0 0 10 20 30 40 50 60 70 80 90 1 2 3 4 5 6 7 8 9 10 10 20 x 30 40 model model truth persistence 50 meridionally averaged day r r zonally averaged 1 0 0 0 0 b model rmse model model baseline baseline persistence figure 14 r correlation coefficient seasonal prediction three different network architecture custom loss model outperform persistence prediction 4 day andremain comparable persistence 90 day stable physical climate analysis repeated 10 different initial condition chosen test set separated least 1000 day mean symbol standard deviation shading reported figure top plot show r 90 day bottom plot zoom first 10 day b term averaged dynamical quantity predicted model compared persistence truth figure reproduced 31 online version colour key achievement aggregate 10 case study discussed article demonstrate piml achieve increased physical consistency higher accuracy faster training better convergence data efﬁciency improved generalization greater interpretability increased scalability complex physical system larger computational platform cumulative accomplishment reveal leading edge piml contribution weather climate modelling b lesson learned case study presented complemented study larger scientiﬁc community offer lesson help guide current future research believe following set guideline enable development robust reliable piml model downloaded 28 march 2024 30 phil trans 379 20200093 enforce standard testing accuracy physical consistency applicable model relevant domain characterize quantify source uncertainty model development prediction set realistic development objective identifying error not reduced discrepancy not addressed including limitation model structure training data train model data characteristic noise sparsity incompleteness representative downstream application promote training piml model embedded weather climate model quantify generalizability term performance degrades degree extrapolation unseen initial condition boundary condition scenario derive estimate stability convergence property evaluate model ﬁdelity rare event extreme tail distribution build interpretable model explain prediction perform ablation study detect bias identify limitation encourage reproducible research c go although piml ha progressed signiﬁcantly past year least four type grand challenge yet addressed scientiﬁc diagnostic computational resource pose challenge form following question scientiﬁcally incorporate lesson learned future model development diagnostically develop systematic test standardize evaluation model across benchmark datasets problem model project routine weather climate scientist however systematic diagnostics largely lacking ml application weather climate ﬁrst step towards weather forecasting weatherbench 129 computationally scale training testing deployment complex piml model large datasets efﬁciently perform well rapidly changing computational landscape 130 effectively collaborate across many diverse community physicist mathematician computer scientist statistician domain scientist many different domain collaboration fundamental rapid growth success piml addressing challenge anticipate development truly robust reliable piml model ultimately making invaluable scientiﬁc discovery indispensable weather climate modelling data accessibility data code supporting material publicly available via following link pde lstm http author contribution conceived idea designed structure manuscript wrote manuscript responded reviewer comment led majority research reviewed case study article rest author contributed research reviewed case study provided feedback section manuscript dedicates work colleague dear friend unfortunately wa killed road accident wa biking course preparation manuscript downloaded 28 march 2024 31 phil trans 379 20200093 competing interest declare no competing interest funding no funding ha received article reference royal society 2019 ai revolution scientiﬁc research london uk royal society hey trefethen 2020 fourth paradigm 10 year informatik spektrum 42 lecun bengio hinton 2015 deep learning nature 521 moore ge 1965 cramming component onto integrated circuit electronics 38 shalf j 2020 future computing beyond moore law phil trans soc 378 20190061 reichstein g stevens b jung denzler j carvalhais n prabhat 2019 deep learning process understanding earth system science nature 566 kasim mf et al 2020 building high accuracy emulator scientiﬁc simulation deep neural architecture search buchanan 2020 living promise nat phys 16 hutson 2020 model galaxy atom simple ai shortcut speed simulation billion time science 367 hestness j narang ardalani n diamos g jun h kianinejad h patwary mma yang zhou 2017 deep learning scaling predictable empirically 00409 karpatne atluri g faghmous jh steinbach banerjee ganguly shekhar samatova n kumar 2017 data science new paradigm scientiﬁc discovery data ieee trans knowl data eng 29 willard j jia x xu steinbach kumar 2020 integrating modeling machine learning survey karpatne watkins w read j kumar 2018 neural network pgnn application lake temperature modeling proc 2018 siam int conf data mining beucler rasp pritchard gentine 2019 achieving conservation energy neural network emulator climate modeling raissi perdikaris p karniadakis ge 2019 neural network deep learning framework solving forward inverse problem involving nonlinear partial differential equation comput phys 378 zhu zabaras n koutsourelakis p perdikaris 2019 deep learning surrogate modeling uncertainty quantiﬁcation without labeled data comput phys 394 beucler pritchard rasp ott j baldi p gentine 2019 enforcing analytic constraint emulating physical system wu jl kashinath k albert chirila xiao 2020 enforcing statistical constraint generative adversarial network modeling chaotic dynamical system comput phys 406 109209 p salzmann fua 2017 imposing hard constraint deep network promise limitation mohan lubber n livescu chertkov 2020 embedding hard physical constraint neural network turbulence jiang cm kashinath 2020 enforcing physical constraint cnns differentiable pde layer iclr 2020 workshop integration deep neural model differential equation daw thomas rq carey cc read j appling karpatne 2020 architecture pga neural network quantifying uncertainty lake temperature modeling proc 2020 siam int conf data mining pp downloaded 28 march 2024 32 phil trans 379 20200093 cohen weiler kicanaoglu b welling 2019 gauge equivariant convolutional network icosahedral cnn proc int conf machine learning maron h fetaya e segol n lipman 2019 universality invariant network proc int conf machine learning maron h h shamir n lipman 2019 invariant equivariant graph network int conf learning representation thomas n smidt kearnes yang l li l kohlhoff k riley 2018 tensor ﬁeld network neural network point cloud ling j kurzawski templeton j 2016 reynolds averaged turbulence modelling using deep neural network embedded invariance fluid mech 807 cohen geiger j welling 2018 spherical cnns int conf learning representation jiang c huang j kashinath k marcus p nießner 2019 spherical cnns unstructured grid int conf learning representation wang r walter r yu 2020 incorporating symmetry deep dynamic model improved generalization chattopadhyay mustafa hassanzadeh p kashinath 2020 deep spatial transformer autoregressive forecasting geophysical turbulence proc workshop climate informatics oxford uk 2020 beucler pritchard gentine p rasp 2020 towards model convection palmer tn 2019 living promise nat rev phys 1 ghahramani z 2015 probabilistic machine learning artiﬁcial intelligence nature 521 krasnopolsky vm belochitski aa 2013 using ensemble neural network learn stochastic convection parameterizations climate numerical weather prediction model data simulated cloud resolving model ad artif neural syst 2013 gagne dj christensen hm subramanian ac monahan ah 2020 machine learning stochastic parameterization generative adversarial network lorenz 96 model adv model earth syst 12 groenke b madaus l monteleoni 2020 climalign unsupervised statistical downscaling climate variable via normalizing ﬂows proc workshop climate informatics oxford uk 2020 tadmor 2012 review numerical method nonlinear partial differential equation bull math soc 49 miller j hardt 2019 stable recurrent model int conf learning representation erichson nb muehlebach mahoney mw 2019 autoencoders fluid flow prediction lusch b kutz jn brunton sl 2018 deep learning universal linear embeddings nonlinear dynamic nat commun 9 4950 mamakoukas g abraham murphey td 2020 learning stable koopman operator brenowitz nd beucler pritchard bretherton c 2020 interpreting stabilizing parametrizations convection 06549 ott j pritchard best n linstead e curcic baldi 2020 deep learning bridge scientiﬁc computing 10652 rasp 2020 coupled online learning way tackle instability bias neural network parameterizations general algorithm lorenz 96 case study geosci model dev 13 yuval j gorman 2020 stable parameterization subgrid process climate modeling range resolution nat commun 11 3295 downloaded 28 march 2024 33 phil trans 379 20200093 yuval j gorman pa hill cn 2020 use neural network stable accurate physically consistent parameterization subgrid atmospheric process good performance reduced precision slingo j bates k nikiforakis n piggott robert shaffrey l stevens vidale pl weller 2008 developing climate system model challenge achievement phil trans soc 367 mohan livescu chertkov 2020 neural network turbulence iclr 2020 workshop climate change ai li z kovachki n azizzadenesheli k liu b bhattacharya k stuart anandkumar 2020 fourier neural operator parametric partial differential equation tancik srinivasan pp mildenhall b raghavan n singhal u ramamoorthi r barron jt ng 2020 fourier feature let network learn function domain neurips 33 pratt h williams b coenen f zheng 2017 fcnn fourier convolutional neural network ecml pkdd 17 pp guan b zhang j sethares wa kijowski r liu 2019 specnet spectral domain convolutional neural network williams pd et al 2017 census atmospheric variability second decade geophys lett 44 11 211 haller 2015 lagrangian coherent structure annu rev fluid mech 47 rupe kumar n epifanov v kashinath k pavlyk schlimbach f patwary maidanov lee v prabhat crutchﬁeld jp 2019 disco unsupervised discovery coherent structure spatiotemporal system proceeding 2019 workshop machine learning high performance computing environment mlhpc denver co pp xie franz e chu thuerey 2018 tempogan temporally coherent volumetric gan ﬂuid ﬂow acm trans graph 37 li z kovachki n azizzadenesheli k liu b bhattacharya k stuart anandkumar 2020 neural operator graph kernel network partial differential equation de bezenac e pajot gallinari 2018 deep learning physical process incorporating prior scientiﬁc knowledge int conf learning representation xu k wen l li g bo l huang q 2019 spatiotemporal cnn video object segmentation proc ieee conf computer vision pattern recognition cvpr pp 1388 smagorinsky j 1963 general circulation experiment primitive equation basic experiment mon weather rev 91 1963 091 0099 gcewtp 2 cheng et al 2019 deep learning turbulence modeling simulation atmospheric boundary layer pal 2020 deep learning emulation process turbulent shear ﬂows geophys lett 47 hoyer hickey j brenner mp 2019 learning discretizations partial differential equation proc natl acad sci usa 116 15 349 pathak j wikner fussell r chandra hunt br girvan ott 2018 hybrid forecasting chaotic process using machine learning conjunction model chaos 28 041101 watson pag 2019 applying machine learning improve simulation chaotic dynamical system using empirical error correction adv model earth syst 11 bonavita laloyaux 2020 machine learning model error inference correction adv model earth syst 12 farchi laloyaux p bonavita bocquet 2020 using machine learning correct model error data assimilation forecast application downloaded 28 march 2024 34 phil trans 379 20200093 mauritsen et al 2012 tuning climate global model adv model earth syst 4 duraisamy k iaccarino g xiao 2019 turbulence modeling age data annu rev fluid mech 51 ollinaho p bechtold p leutbecher laine solonen haario h järvinen 2019 parameter variation prediction skill optimization ecmwf nonlin process geophys 71 tett sfb yamazaki k mineter mj cartis c eizenberg 2017 calibrating climate model using inverse method case study geosci model dev 10 bellprat kotlarski lüthi elía rd frigon laprise r schär 2016 objective calibration regional climate model application europe north america journal climate 29 duraisamy 2020 machine large eddy simulation model turbulence samek w montavon g vedaldi hansen lk müller kr 2019 explainable ai interpreting explaining visualizing deep learning new york ny springer nature molnar 2019 interpretable machine learning lapuschkin wäldchen binder montavon g samek w müller kr 2019 unmasking clever han predictor assessing machine really learn nat commun 10 1096 rudin 2019 stop explaining black box machine learning model high stake decision use interpretable model instead nat mach intell 1 mcgovern lagerquist r gagne dj jergensen ge elmore kl homeyer cr smith 2019 making black box transparent understanding physical implication machine learning bull meteorol soc 100 hilburn 2020 evaluation tuning interpretation neural network working image meteorological application bull meteorol soc 101 gagne dj haupt se nychka dw thompson 2019 interpretable deep learning spatial analysis severe hailstorm mon weather rev 147 tom ba barnes ea 2020 physically interpretable neural network geosciences application earth system variability adv model earth syst 12 tom ba kashinath 2020 testing reliability interpretable neural network geoscience using oscillation geosci model dev caldeira j nord b 2020 deeply uncertain comparing method uncertainty quantiﬁcation deep learning algorithm iclr 2020 workshop fundamental science era ai kendall gal 2017 uncertainty need bayesian deep learning computer vision advance neural information processing system vol 30 pp gal ghahramani z 2016 dropout bayesian approximation representing model uncertainty deep learning proc int conf machine learning lakshminarayanan b pritzel blundell 2017 simple scalable predictive uncertainty estimation using deep ensemble advance neural information processing system vol 30 pp yang perdikaris 2019 adversarial uncertainty quantiﬁcation neural network comput phys 394 vandal kodra e dy j ganguly nemani r ganguly ar 2018 quantifying uncertainty skewed data bayesian deep learning proc acm sigkdd int conf knowledge discovery data mining schneider lan stuart teixeira j 2017 earth system modeling blueprint model learn observation targeted simulation geophys lett 44 12 downloaded 28 march 2024 35 phil trans 379 20200093 rasp pritchard gentine 2018 deep learning represent subgrid process climate model proc natl acad sci usa 115 gentine p pritchard rasp reinaudi g yacalis 2018 could machine learning break convection parameterization deadlock geophys lett 45 gorman pa dwyer jg 2018 using machine learning parameterize moist convection potential modeling climate climate change extreme event adv model earth syst 10 chattopadhyay subel hassanzadeh 2020 using deep learning experimentation lorenz 96 system adv model earth syst bolton zanna 2019 application deep learning ocean data inference subgrid parameterization adv model earth syst 11 01472 j manzanas r gutiérrez jm 2020 conﬁguration intercomparison deep learning neural network model statistical downscaling geosci model dev 13 stengel k glaws hettinger king rn 2020 adversarial climatological wind solar data proc natl acad sci usa 117 16 815 scher messori 2019 weather climate forecasting neural network using general circulation model gcms different complexity study ground geosci model dev 12 chattopadhyay nabizadeh e hassanzadeh 2020 analog forecasting causing weather pattern using deep learning adv model earth syst 12 01958 pathak j mustafa kashinath k motheau e kurth day 2020 using machine learning augment computational fluid dynamic simulation http champion k lusch b kutz jn brunton sl 2019 discovery coordinate governing equation proc natl acad sci usa 116 22 451 manepalli albert rhoades feldman 2019 emulating numeric hydroclimate model cgans climate change ai workshop conf neural information processing system singh albert white b 2019 downscaling numerical weather model gans climate change ai workshop conf neural information processing system jiang cm esmaeilzadeh azizzadenesheli k kashinath k mustafa tchelepi ha marcus 2020 meshfreeflownet deep continuous framework sc 20 proc 2020 acm conf supercomputing appear wang r kashinath k mustafa albert yu 2020 towards deep learning turbulent ﬂow prediction proc acm sigkdd int conf knowledge discovery data mining kdd 20 brenowitz nd bretherton c 2018 prognostic validation neural network uniﬁed physic parameterization geophys lett 45 goodfellow j mirza xu b ozair courville bengio 2014 generative adversarial net advance neural information processing system pp king r hennigh mohan chertkov 2018 deep learning turbulence diagnostics workshop modeling spatiotemporal domain nip 2018 mescheder l geiger nowozin 2018 training method gans actually converge arjovsky bottou 2017 towards principled method training generative adversarial network downloaded 28 march 2024 36 phil trans 379 20200093 yang l zhang karniadakis ge 2020 generative adversarial network stochastic differential equation siam sci comput 42 stinis p hagge tartakovsky yeung 2019 enforcing constraint interpolation extrapolation generative adversarial network comput phys 397 108844 isola p zhu j zhou efros aa 2017 translation conditional adversarial network 2017 ieee conf computer vision pattern recognition cvpr pp rhoades jones ad ullrich 2018 assessing mountain natural reservoir multimetric framework earth future 6 maberly sc et al 2020 global lake thermal region shift climate change nat commun 11 1232 yang c c yang 2014 benchmark european conf computer vision pp ledig c et al 2017 single image using generative adversarial network proc ieee conf computer vision pattern recognition cvpr pp vandal kodra e ganguly micahelis nemani r ganguly ar 2017 quantifying uncertainty skewed data bayesian deep learning proc acm sigkdd int conf knowledge discovery data mining wang x yu k wu gu j liu dong c qiao change loy 2018 esrgan enhanced generative adversarial network proc european conf computer vision eccv workshop dueben pd bauer 2018 challenge design choice global weather climate model based machine learning geosci model dev 11 weyn ja durran dr caruana 2019 machine learn predict weather using deep learning predict gridded geopotential height historical weather data adv model earth syst 11 chattopadhyay hassanzadeh p subramanian palem 2020 prediction multiscale lorenz 96 chaotic system using machine learning method reservoir computing artiﬁcial neural network long memory network nonlinear process geophys 27 bocquet brajard j carrassi bertino 2020 bayesian inference chaotic dynamic merging data assimilation machine learning foundation data science 2 labourasse e sagaut 2002 reconstruction turbulent ﬂuctuations using hybrid le approach comput phys 182 jaderberg simonyan k zisserman 2015 spatial transformer network advance neural information processing system pp cao geddes ta yang jyh yang 2020 ensemble deep learning bioinformatics nat mach intell 2 bihlo 2019 generative adversarial network approach ensemble weather prediction fanfarillo roozitalab b hu w cervone 2020 probabilistic forecasting using deep generative model rasp dueben pd scher weyn ja mouatadid thuerey 2020 weatherbench benchmark dataset weather forecasting adv model earth syst 12 jouppi np yoon dh kurian g li patil n laudon j young c patterson 2020 supercomputer training deep neural network commun acm 63 downloaded 28 march 2024