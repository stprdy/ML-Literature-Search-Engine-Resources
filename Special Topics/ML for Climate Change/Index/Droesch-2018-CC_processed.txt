letter open access machine learning method crop yield prediction climate change impact assessment agriculture cite article andrew 2018 environ lett 13 114003 view article online update enhancement may also like impact large kernel size yield prediction case study corn yield prediction sedla corn belt anil suat terliksiz deniz turgay altilar sustaining crop yield water quality climate change intensively managed agricultural need adaptive conservation measure sundar niroula ximing cai gregory mcisaac ulitization durian wood durio zibethinus corn cob zea may biochar corn yield acid sulphate soil e setiawati w yusuf content wa downloaded ip address environ lett 13 2018 114003 letter machine learning method crop yield prediction climate change impact assessment agriculture andrew economic research service united state department agriculture washington dc 20024 united state america 1 preliminary publication not formally disseminated u department agriculture not construed represent any agency determination policy research wa supported intramural research program u department agriculture economic research service keywords agriculture machine learning climate change impact supplementary material article available online abstract crop yield critically dependent weather growing empirical literature model relationship order project climate change impact sector describe approach yield modeling us semiparametric variant deep neural network simultaneously account complex nonlinear relationship datasets well known parametric structure unobserved heterogeneity using data corn yield u midwest show approach outperforms classical statistical method nonparametric neural network predicting yield year withheld model training using scenario suite climate model show large negative impact climate change corn yield le severe impact projected using classical statistical method particular approach le pessimistic warmest region warmest scenario introduction anthropogenic climate change affect tural sector directly many others direct dependence weather porter et al 2013 nature magnitude impact depends evolution climate system well relationship crop yield weather paper focus prediction weather accurate model mapping weather crop yield important not only projecting impact agriculture also projecting impact climate change linked economic tal outcome turn mitigation tion policy substantial portion work modeling yield purpose climate change impact assessment relies deterministic biophysical crop model rosenzweig et al 2013 model based detailed representation plant siology remain important particularly sing response mechanism adaptation option ciscar et al 2018 however generally performed statistical model prediction larger spatial scale lobell burke 2010 lobell asseng 2017 particular large literature lowing schlenker robert 2009 ha used tical model demonstrate strong linkage extreme heat poor crop performance approach relied classical econometric method recent work ha sought fuse crop el statistical model variously including crop model output within statistical model robert et al 2017 using insight crop model parameterization statistical model robert et al 2012 urban et al 2015 parallel machine learning ml technique advanced considerably past several ade ml philosophically distinct much sical statistic largely goal largely focused prediction outcome opposed inference nature istic process generating outcome focus supervised open access received 31 may 2018 revised 24 august 2018 accepted publication 14 september 2018 published 26 october 2018 original content work may used term creative common attribution licence any distribution work must maintain attribution author title work journal citation doi 2018 author published iop publishing ltd unsupervised ml used discover structure unlabeled data develop novel approach augmenting parametric statistical model deep neural work term semiparametric neural work snn used crop yield modeling framework snn achieves better predictive performance anything else yet lished using prior knowledge important phenomenon functional form relating outcome snn substantially improves tical efﬁciency typical neural network menting parametric model neural network capture dynamic either absent fectly speciﬁed parametric model speciﬁcally nest regression taken yield climate modeling literature top layer network ﬁgure 1 ther variety complementary method cussed improves efﬁciency ultimately performance extant parametric approach neural network beyond application crop yield approach provides general framework improving predictive skill any neural network extant prior knowledge nature process captured model speciﬁcation informed theory expertize ﬁnd choice yield model affect severity climate change impact projection difference yield decline baseline figure schematic drawing semiparametric neural network neural network use form representation learning bengio et al 2013 left sensory data z aggregated progressively abstract derived variable v parameter line nonlinear transformation see equation 2 1 represents bias intercept linear regression right stylized agricultural example aggregation sensory data progressively abstract representation bottom semiparametric neural net ﬁxed effect α linear term pressure deﬁcit degree day 2 environ lett 13 2018 114003 snn ols projection greater 16 percentage point some severe projection also ols projection suggest yield increase some northerly area some le severe scenario projection largely absent snn tions finally conﬁdence interval mean tions much smaller snn equivalent ols regression implying greater precision any given weather scenario ﬁgure remainder paper describes model section 2 data section 3 result section 4 concludes discussion section 5 method detailed section 6 model parametric yield model absent stress plant growth strongly related accumulation time exposed speciﬁc level heat measured day gdd measure total amount time spent within particular temperature range main model used schlenker robert 2009 ols regression gdd along ﬁxed effect control similar following å b b x gdd 1 r rit r r range gdd bin x includes quadratic precipitation well quadratic time trend included account technological change model allows different temperature band different effect plant growth exposed large negative response temperature maize ﬁrst reported subsequent work ha ﬁed role vapor pressure deﬁcit vpd ing much negative response high temperature robert et al 2012 developed better statistical sentation interplay water supply demand urban et al 2015 documented decreasing resiliencetohighvpd overtime lobell developed purpose statistical inference critical temperature threshold model 1 leave room improvement viewed purely predictive tool implicit additive separability regressors iance effect heat exposure omission factor may affect mony interpretability thereby understanding underlying mechanism bias prediction degree incorrect practice any simple speciﬁcation complex phenomenon rather replacing model entirely however adapt ml tool augment neural net semiparametric neural net artiﬁcial neural proposed rosenblatt 1958 form tation learning bengio et al 2013 input form raw daily weather data high sion little direct correlation progressively formed abstract ultimately useful data aggregate related outcome interest ﬁgure 1 tantly aggregate not rather discovered algorithm process training network depth successive layer aggregation increasing abstraction give rise term deep learning lecun et al 2015 basic neural network deﬁned equation 2 g g g g g g g g v v v v v v z 2 l l l 1 1 1 1 2 2 2 2 3 3 3 term vl derived variable node lth layer parameter gl map data z come number layer number node per layer hyperparameter chosen modeler matrix g l 2 dimension equal number node lth layer next layer activation function responsible network nonlinearity map real line some subset use leaky rectiﬁed linear unit lrelu maas et al 2013 x x x x x 0 100 0 variant relu x x max 0 relu found substantially improve mance earlier alternative ﬁrst used nair hinton 2010 leaky relu wa found improve predictive performance application top layer equation 2 linear regression derived variable recognizing basic vation employed simply add linear term suggested prior knowledge ﬁxed effect represent unobserved heterogeneity term x α respectively model becomes b g g g g g g g x v v v v v v z 3 l l l 1 1 1 2 2 2 2 3 3 3 indexing individual time allows u nest equation 1 within equation 2 ating parametric structure known known allowing substantial ﬂexibility functional form granular data either not known known speciﬁed imperfectly 3 environ lett 13 2018 114003 method use training semiparametric neural network detailed method section implemented panelnnet r data focus state illinois indiana iowa kentucky michigan minnesota missouri ohio wisconsin chosen geographically contiguous capture large tion corn production u corn yield 1979 2016 taken u national agricultural statistic service na quickstats database na 2017 addition extract data quickstats proportion county irrigated formed average county reported area irrigation past three usda census ture 2002 2007 2012 historical weather data taken gridded surface meteorological dataset metdata zoglou 2013 variable observed daily include minimum maximum air temperature relative humidity precipitation incoming shortwave radiation sunlight average wind speed view variable used presented table note variable included parametrically also included nonparametrically tion quadratic term time total tion allows parametric main effect also allowing variable form nonlinear nation input data could useful effect variable depend partially level variable training model convert nonparametric covariates matrix principal component retaining prise 95 variance data future weather simulation data taken multivariate adaptive climate analog maca set abatzoglou brown 2012 statically downscaled set projection suite climate model comprising coupled model comparison project taylor et al 2012 individual model used analysis include yukimoto et al 2012 dunne et al 2012 volodin et al 2010 voldoire et al 2013 ji et al 2014 dufresne et al 2013 xin et al 2012 chylek et al 2011 watanabe et al 2011 collins et al 2011 model maca dataset selected inclusion reported variable used table single group produced one model older version dropped unless substantially qualitatively different sentaiton earth system model simulates emission scenario representing modest climate change mitigation emission respectively metdata maca vided 4 resolution aggregate data table variable used yield model phenomenon term type description precipitation 245 nonparametric daily precipitation air temperature 490 nonparametric daily minimum maximum air temperature relative humidity 490 nonparametric daily minimum maximum relative humidity wind speed 245 nonparametric daily average wind speed taken euclidean norm northward eastward wind reported metdada maca shortwave radiation 245 nonparametric daily total solar radiation growing 42 cumulative time temperature band additional bin capture proportion time spent term enter parametric linear nonparametric neural network portion yield model total precipitation 2 parametric total precipitation growing season square 2 nonparametric county centroid time 1 2 year enters quadratic time trend parametric linear portion model nonparametric term base neural network soil 39 nonparametric percentage organic matter particle density k saturation able water capacity erodibility factor electrical conductivity cation exchange capacity ph exchangeable slope gradient length loss tolerance factor elevation aspect albedo dry minimum bedrock depth water table depth minimum annual ponding frequency available water storage irrigated capability class dominant class percentage root zone available water storage depth proportion irrigated 1 nonparametric proportion county farm land irrigated production county 1 201 parametric indicator variable 201 county iowa illinois estimated ﬁxed effect via within transformation top later network 2 4 environ lett 13 2018 114003 average weighted proportion 4 km gridcell farmed taken na cropland data layer johnson et al 2009 exclude observation outside growing season using weather march october addition weather data use soil data taken soil survey geographic ssurgo database soil survey staff 2017 dataset comprises 39 sures soil physical chemical property complete description modeling approach method section make use strap aggregation bagging breiman 1996 reduce variance prediction estimate sample prediction error model 1 3 ﬁt 96 bootstrap sample unique year dataset error assessed average year not bootstrap sample result predictive skill begin comparing accuracy various approach predicting yield year not used train model table accuracy parametric model snn wa substantially improved bagging bagged snn performed best neural wa trained identically snn lacked parametric substantially worse either ols regression snn bagging improves model ols regression certain year may served statistical leverage point yield model may overﬁt data distinct year data determine whether heat anomalously hot year fact cause year anomalously low yield bootstrap sample omit year estimate different relationship averaging estimate reduce inﬂuence outlier snn ols regression stantially neural net simply reﬂective general fact metric model efﬁcient nonparametric model degree correctly speciﬁed snn accurate ols not wildly model 1 useful imperfect approximation true lying process spatial distribution dictive mapped online supplementary material variable importance desirable determine variable group variable contribute predictive skill importance measure developed context random forest breiman 2001 applied bagged estimator statistic measure decline accuracy variable set variable sample randomly permuted random mutation destroys correlation outcome variable interact rendering uninformative compute measure set variable average mse difference across ﬁve random permutation plotted ﬁgure daily weather variable measured important measure particularly daily cipitation minimum relative humidity warmest part year later consistent ﬁndings anderson et al 2015 lobell et al 2013 show one main mechanism high temperature affect yield inﬂuence water demand parametric portion model important nonparametric part model ﬁgure 2 right incorporation parametric time trend also gdd nonparametric component le important parametric sentation gdd though nonetheless responsible improvement predictive skill baseline ols regression however predictive power temperature variable lends support ﬁndings 2013 note room improvement additive ability approximation implicit baseline metric speciﬁcation soil variable proportion land irrigated geographic coordinate low tance value possible variable would important model trained larger le homogeneous moderate localize effect daily weather variable trality oftimetrendstopredictiveskill explains poor performanceofthe neuralnet projection projection period rcps climate model reported ﬁgure plotted conﬁdence interval derived table error estimate bagged predictor year prediction wa formed average prediction bootstrap sample not containing year averaged prediction wa compared known value unbagged predictor error sample prediction wa averaged model bagged mseoob parametric no semiparametric neural net no parametric yes neural net yes semiparametric neural net yes 5 environ lett 13 2018 114003 figure variable importance measure variable left variable whole set variable right red blue green bar indicate variable enter nonparametrically parametrically figure yield projection averaged study region climate model line segment length reﬂects 95 conﬁdence interval mean projection based projected interannual yield variability conﬁdence interval reﬂecting uncertainty estimated average projection yield given weather presented ﬁgure dotted line reﬂects detrended historical average yield 6 environ lett 13 2018 114003 averaging pointwise standard error smoothing spline applied underlying time series projected yield reﬂect projected interannual bility projection make no assumption technological change inasmuch value time trend ﬁxed year 2016 purpose prediction projection only reﬂect change response weather assuming technology response weather model adaptation carbon fertilization omission factor likely bias statistical projection downwards degree factor increase expected yield though note recent research raise uncertainty magnitude existence fertilization effect obermeier little difference model scenario yield decline le snn jects substantially impact scenario yield decline across model including model notably bagged ols speciﬁcation nearly always le pessimistic standard ols model likely pessimism ols relative bagged ols derives relatively small number severe year historical period affecting model estimate serving outlier manner diluted bootstrap aggregation process figure 4 model difference average snn ols projection suite variable summarizing climate projection relative optimism snn strongly associated change proportion year well change mean max minimum highly correlated table variable le correlated difference suggesting major difference two model representation effect extreme heat spatial distribution projection canadian earth system roughly middle projected severity yield impact suite presented ﬁgure ols speciﬁcations generally pessimistic project increase northernmost region study area snn projection not share feature though le pessimistic overall feature replicated varying degree scenario model see provides corresponding map model given ols speciﬁcation simply measure heat exposure total precipitation suggests change besides increasing heat likely inhibit yield figure difference snn ols projection plotted change period climate 7 environ lett 13 2018 114003 discussion average yield impact projected neural net response future weather scenario simulated global climate somewhat le severe projected using parametric model theless estimate still among severe estimate corn compared study compiled ipcc assessment report porter et al 2013 worth emphasizing difference yield projection statistical approach considered not large difference yield projection climate model emission scenario ﬁnd timing heat moisture important predicting corn yield along simple accumulation heat seen projection south study area lack positive response increasing warmth north study area ﬁnd gdds useful imperfect proxy role heat predicting crop yield indeed work ha cated important role vpd soil moisture robert et al 2012 lobell et al 2013 anderson et al 2015 urban et al 2015 explaining building upon baseline parametric speciﬁcation plexity underlying response mechanism argument explicit use gcms assessing mate change impact agriculture explicitly capture multiple climate variable deep learning ha led substantial throughs predictive application artiﬁcial ligence classical statistical method remain central scientiﬁc application seek elucidate mechanism governing cause effect describe semiparametric approach fuse two work better either alone term predictive mance approach suitable any prediction problem knowledge function mapping input outcome longitudinal ture data ultimately ﬁnd combining ml knowledge empirical study improves predictive skill altering conclusion climate change impact agriculture substantial scope reﬁne extend work along four major avenue 1 better representation knowledge parameterization parametric component model 2 extension wider geographic area require explicit treatment difference seasonality duction space 3 bringing nonparametric neural network part model closer research frontier ml artiﬁcial intelligence 4 ﬁnding way integrate element nistic crop model heretofore ging model statistically fertilization method panelnnet r package see footnote 2 wa used train snn used analysis key feature package described training semiparametric neural network no closed form solution parameter set minimizes loss function neural network training done gradient descent cated fact neural net many common build train network parameter data neural network not generally unique solution regularization essential arriving useful predicts well section describes basic way accomplished context semiparametric neural net training algorithm seek parameter set minimizes loss function figure spatial distribution difference yield projection semiparametric neural network parametric model single member climate model ensemble ols regression tends optimistic snn northern section study region pessimistic southern region see supplementary ﬁgures output gcms 8 environ lett 13 2018 114003 lq q ˆ r 4 2 q b º g g g vec l 1 2 λ tunable hyperparameter chosen make model predict well larger value λ lead inﬂexible ﬁts value approaching zero generally cause overﬁtting large network loss minimized gradient descent iterative process computing gradient loss function respect parameter updating parameter based dient recalculating derived regressors ing some stopping criterion met computing gradient involves iterative application chain rule l l l l g g g g g g g g g g ˆ ˆ r r r r v v v v v v v 2 2 2 2 stub 2 stub 2 1 1 1 2 2 2 2 1 stub 2 3 3 3 3 1 2 stub 3 4 4 4 4 2 3 stub 4 1 2 3 e indicates elementwise matrix product computing gradient parameter ted simply taking step size δ gradient g g g r new old challenge training neural network valence saddle point plateau loss face response number approach developed dynamically alter rate parameter updated order speed movement along plateau away saddlepoints use rmsprop g g g g g new old old new new 2 2 g gradient past gradient wide plateau loss step size divided small number increasing see ruder 2016 view gradient descent algorithm rather computing gradient step full dataset typically advantageous small randomized subset nique termed minibatch gradient descent one set minibatches comprising whole dataset termed one speed computation introducing noise thereby helping mizer avoid small local minimum loss surface another technique used improve training neural network dropout srivastava et al 2014 technique randomly drop some proportion parameter layer iteration network update computed only weight remain prevents tion parameter strong correlation derived variable mately reduces capacity convey information subsequent layer ols trick gradient descent method generally perform well inexact top level neural network linear model however derived regressors typical context mixture derived regressors parametric term semiparametric context ordinary least square provides solution parameter vector minimizes lized loss function given set derived regressors ridge regression provides equivalent solution penalized case begin noting loss function equation 4 recast q q q ˆ ˆ ˆ c argmin 2 given λ implies budget deviation zero within element q mth iteration top level network b g x v gradient descent inexact parameter b g º doe not satisfy l min w w 5 dm dm dm dm º x v w dm indicates within formation model l l penalty corresponding budget left accounting lower level parameter generate calculate implicit l top level neural network minimizing l min mt 2 l w w w 1 replacing ψm sum squared parameter top level network remains unchanged top level penalized loss function reach minimum subject constraint term ols trick employ speed convergence overall network yield modeling algorithm central challenge training neural network choosing appropriate hyperparameters main parameter constitute model predicts well complicated fact optimal learning rate batch vary course training thus employ combination bayesian meter optimization bho early stopping 9 environ lett 13 2018 114003 form ensemble model trained improve performance bootstrap bagging man 1996 involves ﬁtting model several bootstrap sample data forming ﬁnal prediction mean prediction model ging improves performance averaging reduces variance expected predictive mance model assessed using sample not selected bootstrap sample test bag sample performance bagged predictor assessed averaging prediction ing observed outcome bho seek build function relating test set formance hyperparameters select parameter optimize function random draw tribution hyperparameters ﬁt model several time using draw order create joint tribution hyperparameters mance use joint distribution ﬁt model f u improvement 6 φ matrix hyperparameters row indexing hyperparameter combination attempted improvement vector corresponding ments error measured relative starting point training run model random forest breiman 2001 several initial experiment use ical optimizer ﬁnd f f f argmax next ﬁt snn hyperparameters φnew generating new test error improvement repeated many time test error cease improving early stopping involves assessing mance every iteration exiting gradient cent test error cease improving therefore ratcheting not improve test error rejected update improve test error serve starting point sequent run combine three technique performing bho early stopping within bootstrap ple speciﬁcally begin ﬁtting procedure bootstrap sample selecting set meter likely generate parameter set q overﬁt error zero typically implies large error bho commences starting point using random draw distribution following hyperparameters regularization drawn distribution 25 parametric term penalty modiﬁer drawn distribution zero one coefﬁcient λ multiplied ing coefﬁcients associated parametric term top level model value near zero correspond ols regression parametric term value 1 correspond ridge regression term doe not directly affect meter relating derived variable outcome starting learning plying gradient performing update drawn distribution 10 10 6 1 iteration loss decrease multiply learning rate factor drawn distribution 1 learning rate slowing iteration loss increase divide learning rate gravity power learning rate slowing rate drawn distribution 3 number sample perform one iteration drawn distribution 10 500 dropout probability given node retained one iteration dropout probability input variable equal dropout probability hidden unit power dropout probability hidden unit probability input variable retained drawn distribution 1 draw hyperparameters used guide training model updating every run ols trick applied optimize parameter test set error measured test error reach new minimum associated parameter set q saved new starting point test error fails improve 5 check ing exit new draw φ concatenating new row used training model 6 given optimal set hyperparameters change course training only recent 100 row f improvement used train model 6 finally iterate bho random hyperparameter search order ensure hyperparameter space extensively explored also focusing hyperparameter value likely improve performance speciﬁcally random draw hyperparameters performed every 10 environ lett 13 2018 114003 third run followed two run using meter selected maximize 6 procedure done 96 strap sample yielding model tuned mally predict withheld sample year ﬁnal predictor formed averaging prediction member model ensemble code conducting well code underpinning rest analysis described available data availability data used study publicly available gridded surface meteorological data published northwest knowledge consortium able html yield irrigation data available usda national agricultural statistical service available run downscaled using maca also available northwest knowledge consortium soil data ssurgo publicly availableat code used perform analysis available orcid id andrew http reference abatzoglou j 2013 development gridded surface meteorological data ecological application modelling int climatol 33 abatzoglou j brown j 2012 comparison statistical downscaling method suited wildﬁre application int climatol 32 anderson c j babcock b peng gassman p w campbell 2015 placing bound extreme temperature response maize environ lett 10 124001 bengio courville vincent p 2013 representation learning review new perspective ieee trans pattern anal mach intell 35 breiman l 1996 bagging predictor mach learn 24 breiman l 2001 random forest mach learn 45 chylek p li j dubey wang lesins g 2011 observed model simulated century arctic temperature variability canadian earth system model atmos chem phys discus 11 ciscar k lobell b 2018 synthesis review comparison climate change impact agriculture environ lett 13 collins w et al 2011 development evaluation geosci model dev 4 dufresne et al 2013 climate change projection using earth system model clim dyn 40 dunne j p et al 2012 gfdlʼs global coupled earth system model physical formulation baseline simulation characteristic clim 25 ji et al 2014 description basic evaluation beijing normal university earth system model version 1 geosci model dev 7 johnson et al 2010 2009 cropland data layer photogramm eng remote sen 76 lecun bengio hinton g 2015 deep learning nature 521 lobell b asseng 2017 comparing estimate climate change impact statistical crop model environ lett 12 015001 lobell b burke b 2010 use statistical model predict crop yield response climate change agric forest meteorol 150 lobell b hammer g l mclean g messina c robert j schlenker w 2013 critical role extreme heat maize production united state nat clim change 3 497 lobell b robert j schlenker w braun n little b b rejesus r hammer g l 2014 greater sensitivity drought accompanies maize yield increase u midwest science 344 maas l hannun ng 2013 rectiﬁer nonlinearities improve neural network acoustic model proc icml vol 30 nair v hinton g e 2010 rectiﬁed linear unit improve restricted boltzmann machine proc international conf machine learning pp na u 2017 quick stats database washington dc http obermeier w lehnert l w ivanov luterbacher j bendix j 2018 reduced summer aboveground productivity temperate grassland future climate regime earth future 6 2013 weather really additive agricultural production implication climate change impact future discussion paper porter j r et al 2013 food security food production system climatechange 2014 impact adaptation vulnerability part global sectoral aspect ed c b field et al new york cambridge university press pp robert j braun n sinclair r lobell b schlenker w 2017 comparing combining crop model statistical model some implication climate change environ lett 12 095010 robert j schlenker w eyer j 2012 agronomic weather measure econometric model crop yield implication climate change agric econ 95 rosenblatt f 1958 perceptron probabilistic model information storage organization brain psychol rev 65 386 rosenzweig c et al 2013 agricultural model intercomparison improvement project agmip protocol pilot study agric forest meteorol 170 ruder sebastian 2016 overview gradient descent optimization algorithm schlenker w robert j 2009 nonlinear temperature effect indicate severe damage u crop yield climate change proc natl acad sci 106 soil survey staff 2017 natural resource conservation service united state department agriculture soil survey geographic ssurgo database accessed 1 january 2017 srivastavan hinton ge krizhevskya sutskeveri salakhutdinovr asimple way topreventneural network fromoverﬁtting taylor k e stouffer r j meehl g 2012 overview experiment design bull meteorol soc 93 11 environ lett 13 2018 114003 urban w shefﬁeld j lobell b 2015 impact future climate carbon dioxide change average variability u maize yield two emission scenario environ lett 10 045003 voldoire et al 2013 1 global climate model description basic evaluation clim dyn 40 volodin e dianskii n gusev 2010 simulating climate 0 coupled model atmospheric oceanic general circulation atmos ocean phys 46 wager athey 2018 estimation inference heterogeneous treatment effect using random forest stat assoc 113 wager hastie efron b 2014 conﬁdence interval random forest jackknife inﬁnitesimal jackknife mach learn 15 watanabe et al 2011 2010 model description basic result experiment geosci model dev 4 845 xin x wu zhang j 2012 introduction simulation conducted bcc climate system model adv clim change 8 yukimoto et al 2012 new global climate model meteorological research institute model description basic performance meteorol soc japan ii 90 12 environ lett 13 2018 114003